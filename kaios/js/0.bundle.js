!function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}(function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))switch(typeof e[t]){case"function":break;case"object":e[t]=function(t){var n=t.slice(1),r=e[t[0]];return function(e,t,i){r.apply(this,[e,t,i].concat(n))}}(e[t]);break;default:e[t]=e[e[t]]}return e}([function(e,exports,t){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(i,o){try{var a=t[i](o),s=a.value}catch(u){return void n(u)}return a.done?void e(s):Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)})}return r("next")})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(u){i=!0,o=u}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t(54);var u=t(9),c=t(11),l=t(8),f=(r(l),t(10)),d=t(33),p=r(d),h=t(18),v=r(h),m=t(20),g=r(m),y=t(31),b=n(y),w=t(1),_=t(16),S=r(_),E=t(35),k=r(E),A=t(7),C=r(A),T=t(30),O=t(69),I=r(O),P=t(70),R=r(P),M=t(17),L=r(M),U=t(32),N=r(U),D=t(12),x=r(D),j=t(19),B=r(j),F=t(34),z=r(F),H=t(75),K=r(H);t(74);var q=t(61),V=r(q),G=t(62),Y=r(G),W=t(63),Q=r(W),J=t(64),X=r(J),Z=t(65),ee=r(Z);t(84),t(83),t(85),t(79),t(86),new(function(){function e(){var t=this;o(this,e),this.reboot=function(e){if(e&&"device-info-change"===e.detail&&(T.serviceWorkerManager.swForceUpdate=!0),"hidden"!==document.visibilityState){if(!t.remoteFirstViewIsReady)return void(t.isRebootPending=!0);performance.mark("KAISTORE_END"),t.isRebooting=!0,t.isRebootPending=!1,t.hideDialog(),t.resetState(),t.showLoading().then(function(){w.utils.updateLoadingProgress(0,!0)}),S.default.resetStore(),performance.mark("GET_DEVICE_INFO_START"),C.default.getDeviceInfos(!0).then(function(e){performance.mark("GET_DEVICE_INFO_END"),window.deviceInfos=e,L.default.init(),t.startService();var n=document.querySelector("iframe"),r=w.utils.reloadIframe(n.src);r&&(n.src=r,t.configureMessageSender(r))})}},this.restart=function(){"hidden"!==document.visibilityState&&(t.resetState(),L.default.init(),t.startService())},this.onNetworkChange=function(e){clearTimeout(t.networkSetTimeout);var n=e.detail.online;t.currentOnline!==n&&(t.networkSetTimeout=setTimeout(function(){t.currentOnline=n,t.restart()},500))},this.mountDataStoreChange=i(regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.storeUpdate.dataStore){e.next=5;break}return e.next=3,navigator.getDataStores("store-upgraded");case 3:n=e.sent,t.storeUpdate.dataStore=n[0];case 5:t.storeUpdate.dataStore.addEventListener("change",function(e){t.storeUpdate.dataStore.get(e.id).then(function(e){e&&e.storeUpgraded&&(console.warn("[store-upgraded]["+t.instanceId+"] store window close!"),window.close())})});case 6:case"end":return e.stop()}},e,t)})),this.getIsStoreUpdatableFlag=function(e){return k.default.doNotShowUpdateDailogWhenBoot?void(k.default.doNotShowUpdateDailogWhenBoot=!1):void asyncStorage.getItem(f.STORAGE_KEY.isStoreUpdatable,function(n){t.storeUpdate.isUpdatable=!!n,t.storeUpdate.isUpdatable?t.handleExitOrSelfUpdate():e&&t.checkSelfUpdate()})},this.notifyStoreUpdatable=function(){var e=new c.NotifyStoreUpdatableCommand({detail:t.storeUpdate});u.MessageSender.send(e)},this.handleSelfUpdated=i(regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.storeUpdate.dataStore){e.next=5;break}return e.next=3,navigator.getDataStores("store-upgraded");case 3:n=e.sent,t.storeUpdate.dataStore=n[0];case 5:t.storeUpdate.dataStore.clear(),t.storeUpdate.dataStore.add({storeUpgraded:!0});case 7:case"end":return e.stop()}},e,t)})),this.selfUpdate=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t.storeUpdate.isUpdating=!0,t.hideDialog(),t.showLeavingPage(!0),asyncStorage.setItem(f.STORAGE_KEY.isStoreUpdatable,!1),b.updateKaiStoreApp(function(){console.warn("Store update success")},function(){console.warn("Store update fail"),e?window.close():(t.storeUpdate.isUpdating=!1,t.focusIframe())})},this.handleShowDialogEvent=function(e){var n=e.detail.options;t.showDialog(n)},this.handlePanelVisibilityChange=function(e,n){var r=g.default.mountComponent,i=g.default.unmountComponent,o=document.querySelector("#"+n);if(e)r(n,o);else{var a=i(n);a?a.focus():(t.focusIframe(),t.softkey.classList.add("hidden"))}},window.app=this,performance.mark("KAISTORE_START"),performance.mark("KAISTORE_END"),this.isRebooting=!1,this.needRefetchToken=!1,this.runtimeParamsChanged=!1,this.remoteFirstViewIsReady=!1,this.isRebootPending=!1,this.instanceId=(0,w.generateInstanceID)(),this.currentOnline=B.default.online,this.networkSetTimeout=null,this.storeUpdate={isUpdating:!1,isUpdatable:!1,dataStore:null},this.activityTask=null,performance.mark("INIT_MESSENGER_START"),this.startMessengers(),performance.mark("INIT_LISTENERS_START"),this.startEventListener(),X.default.start(),this.softkey=document.querySelector("#softkeyPanel"),Q.default.onVisibilityChange=this.handlePanelVisibilityChange,ee.default.onVisibilityChange=this.handlePanelVisibilityChange,ee.default.selfUpdate=this.selfUpdate,S.default.setExitLock(!1),this.boot(),console.warn("store instance ID: "+this.instanceId)}return s(e,[{key:"getDeviceInfo",value:function(){performance.mark("GET_DEVICE_INFO_START");var e=[C.default.getDeviceInfos(),w.utils.getIMEI()];return Promise.all(e).then(function(e){var t=a(e,2),n=t[0],r=t[1];window.deviceInfos=n,L.default.init(),window.IMEI=r,performance.mark("GET_DEVICE_INFO_END"),w.utils.updateLoadingProgress(25)})}},{key:"resetState",value:function(){this.remoteFirstViewIsReady=!1}},{key:"boot",value:function(){var e=this;Promise.all([C.default.prepareStoreAppInfo(),this.getDeviceInfo()]).then(function(){return N.default.cacheCleanUp(!0)}).then(function(t){var n=t.runtimeParamsChanged,r=t.cacheExpired;e.runtimeParamsChanged=n,e.needRefetchToken=n||r,asyncStorage.getItem(f.STORAGE_KEY.serverTimeOffset,function(e){window.serverTimeOffset=e}),e.prepareIframe().then(function(){e.startService()})}).then(function(){e.getIsStoreUpdatableFlag(!1)}),K.default.start()}},{key:"prepareIframe",value:function(){var e=this;return this.activityTask=k.default.remoteTask,z.default.fetchConfig().then(function(t){var n=w.utils.getStorePath(e.activityTask,C.default.storeVersion,t),r=window.deviceInfos.get("apps.serviceCenter.remoteUrl"),i=document.querySelector("#root"),o=document.querySelector("iframe");o||(o=document.createElement("iframe"),i.insertBefore(o,i.firstChild)),o.className="hidden",o.src=""+r+n,e.configureMessageSender(r)})}},{key:"showLoading",value:function(){return new Promise(function(e){var t=document.getElementById("ssr"),n=document.querySelector("iframe"),r=navigator.largeTextEnabled?"add":"remove";t&&(t.classList.remove("hidden"),t.classList[r]("large-text")),n&&n.classList.add("hidden"),requestAnimationFrame(function(){return e()})})}},{key:"showLeavingPage",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments[1];this.leaving||(this.leaving=new Y.default),this.leaving.setVisibility(e,this.storeUpdate.isUpdating),e?(this.leaving.focus(),this.softkey.classList.add("hidden")):g.default.isElementHidden("updatePanel")||this.softkey.classList.remove("hidden"),t&&t()}},{key:"checkNetworkConnection",value:function(){var e=this;return!!B.default.online||(w.utils.showToastMsg("no-internet"),p.default.shownRebootPanel||this.showLoading().then(function(){e.handleNoNetwork(),console.error("no network")}),!1)}},{key:"startService",value:function(){var e=this;if(this.checkNetworkConnection()!==!1){performance.mark("INIT_ACCOUNT_START"),v.default.initAccount(),performance.mark("GET_TOKEN_START");var t=this.needRefetchToken;v.default.ready(function(){v.default.getToken(t).then(function(){performance.mark("GET_TOKEN_END"),w.utils.updateLoadingProgress(55),e.updateFakePercentage(55,69,400),e.startRemoteServices()}).catch(function(){w.utils.showToastMsg("connection-error")})})}}},{key:"startRemoteServices",value:function(){var e=this.runtimeParamsChanged;S.default.start(),this.startServiceWorker(e),this.runtimeParamsChanged=!1,v.default.isAccountReady?this.handleAccountIsReady(this.isRebooting):window.addEventListener("account-ready",this.handleAccountIsReady.bind(this))}},{key:"handleAccountIsReady",value:function(e){var t=this;v.default.checkAccountId().then(function(){var n=e?window.clientRebootTime:window.timeOriginInEpoch,r=e?"background_launch":"cold_launch";L.default.postStoreOpenEvent(n,r),window.removeEventListener("account-ready",t.handleAccountIsReady)})}},{key:"updateFakePercentage",value:function(e,t,n){S.default.progressTimer=setInterval(function(){e+=2,e>t?S.default.resetProgressTimer():w.utils.updateLoadingProgress(e)},n)}},{key:"stop",value:function(){this.stopEventListener()}},{key:"startMessengers",value:function(){u.MessageSender.start(),u.MessageListener.start(R.default),performance.mark("INIT_MESSENGER_END")}},{key:"configureMessageSender",value:function(e){var t=new URL(e),n=t.origin;u.MessageSender.validMessageOrigins=[n],u.MessageSender.targetOrigin=n}},{key:"startEventListener",value:function(){B.default.addEventListeners(),window.addEventListener("keydown",this.keydownHandler.bind(this)),window.addEventListener("networkstatuschange",this.onNetworkChange),window.addEventListener("reboot-needed",this.reboot),window.addEventListener("self-updated",this.handleSelfUpdated),window.addEventListener("remote:requestExit",this.handleExitOrSelfUpdate.bind(this)),window.addEventListener("remote:firstViewCompleted",this.handleFirstViewCompleted.bind(this)),window.addEventListener("dialog:show",this.handleShowDialogEvent),window.addEventListener("hawkrequester:offsetchange",this.handleHawkOffsetChange.bind(this)),window.addEventListener("visibilitychange",this.handleVisibilityChange.bind(this)),window.addEventListener("appstore:updatable",this.handleAppUpdatable.bind(this)),I.default.on("fota-dialog",this.showFotaDialog.bind(this)),this.mountDataStoreChange(),k.default.start()}},{key:"keydownHandler",value:function(e){switch(e.key){case"BrowserBack":case"Backspace":case"Escape":this.handleExitOrSelfUpdate()}}},{key:"isInlineActivity",value:function(){if(!this.activityTask)return!1;var e=["inline-open-page","inline-open-by-name"],t=this.activityTask.name;return e.includes(t)}},{key:"handleExitOrSelfUpdate",value:function(){var e=this,t=this.storeUpdate.isUpdatable;this.showLeavingPage(!0),t?C.default.canAutoSelfUpdate().then(function(t){t?e.selfUpdate():e.showSelfUpdateDialog()}):this.isInlineActivity()||this.remoteFirstViewIsReady&&this.isBackgroundStoreSupported()||(S.default.setExitLock(!1),window.close()),k.default.postResult()}},{key:"isBackgroundStoreSupported",value:function(){if(!window.deviceInfos)return!1;var e=window.deviceInfos.get("deviceinfo.os").split(" ")[0];return w.utils.isBackgroundStoreSupported(e)}},{key:"startCheckFota",value:function(){performance.mark("CHECK_FOTA_START"),this.storeUpdate.isUpdatable||I.default.start()}},{key:"startServiceWorker",value:function(e){performance.mark("SERVICE_WORKER_START");var t={deviceInfos:window.deviceInfos};e||T.serviceWorkerManager.swForceUpdate?(T.serviceWorkerManager.prepareIndexedDB(),T.serviceWorkerManager.forceUpdate(t)):T.serviceWorkerManager.start(t)}},{key:"handleFirstViewCompleted",value:function(e){var t=this,n=e.detail.isInlineActivity;return performance.mark("fullyLoaded"),this.remoteFirstViewIsReady=!0,this.isRebootPending?void this.reboot():(k.default.processRemoteQueue(),L.default.postStoreOpenEvent(w.utils.remoteCompleteTime),void(n||(x.default.isUpdated&&g.default.toggleRebootPanel({visible:!0}),C.default.updateDeviceInfos(),this.storeUpdate.isUpdatable?(this.notifyStoreUpdatable(),this.startCheckFota()):this.checkSelfUpdate().then(function(){t.startCheckFota()}))))}},{key:"handleHawkOffsetChange",value:function(e){var t=e.detail.current;window.serverTimeOffset=t,asyncStorage.setItem(f.STORAGE_KEY.serverTimeOffset,t)}},{key:"handleVisibilityChange",value:function(){var e=this;if("hidden"===document.visibilityState){var t=navigator.mozPower.screenEnabled;if(t||g.default.toggleRebootPanel({visible:!1}),C.default.hasScreenOffed=!t,k.default.doNotShowUpdateDailogWhenBoot=!1,this.isBackgroundStoreSupported()&&"true"!==localStorage.forceRestart){if(!this.isDialogDisplayed&&(this.focusIframe(),t)){var n=new c.NotifyStoreCloseCommand;u.MessageSender.send(n)}}else S.default.setExitLock(!1),window.close()}else window.clientRebootTime=Date.now(),w.utils.clearPerformanceLogs(),performance.mark("KAISTORE_START"),v.default.refreshAccountToken(),T.serviceWorkerManager.checkAndDoForceUpdate(),this.getIsStoreUpdatableFlag(!0),N.default.cacheCleanUp().then(function(t){var n=t.runtimeParamsChanged,r=t.cacheExpired;return e.needRefetchToken=n||r,C.default.hasLargeTextChanged||Object.values(t).some(function(e){return e===!0})?(C.default.hasLargeTextChanged=!1,void e.reboot()):void(C.default.hasScreenOffed||(L.default.postStoreOpenEvent(Date.now(),"background_launch"),e.remoteFirstViewIsReady&&L.default.postStoreOpenEvent(Date.now())))}),k.default.processActivityQueue(),S.default.checkUpdateForInstalledApps()}},{key:"handleAppUpdatable",value:function(e){var t=e.detail.application;this.showForceUpdateDialog(t)}},{key:"showForceUpdateDialog",value:function(e){var t=this,n=new ManifestHelper(e.manifest).name,r={translated:!0,header:navigator.mozL10n.get("force-update-found",{appName:n}),type:"confirm",cancel:"skip",ok:"update",content:navigator.mozL10n.get("force-update-found-content",{appName:n}),onOk:function(){S.default.forceIntsall(e),t.hideDialog()},onCancel:function(){t.hideDialog()}};this.showDialog(r)}},{key:"showFotaDialog",value:function(){var e=this,t={header:"fota-update-found",type:"confirm",cancel:"skip",ok:"update",content:"fota-found-content",onOk:function(){new MozActivity({name:"launch-fota",data:{param:"startFromStore"}}),e.hideDialog()},onCancel:function(){e.hideDialog()}};this.showDialog(t)}},{key:"showSelfUpdateDialog",value:function(){var e={header:"self-update-available",type:"alert",ok:"ok",content:"self-update-content",hideCancel:!0,onOk:this.selfUpdate};this.showDialog(e)}},{key:"checkSelfUpdate",value:function(){var e=this;return performance.mark("SELF_UPDATE_START"),b.checkKaiStoreUpdate().then(function(t){e.storeUpdate.isUpdatable=!!t}).catch(function(t){e.storeUpdate.isUpdatable=!1,console.warn(t)}).then(function(){performance.mark("SELF_UPDATE_END"),asyncStorage.setItem(f.STORAGE_KEY.isStoreUpdatable,e.storeUpdate.isUpdatable),e.notifyStoreUpdatable(),e.isLeavingDisplayed&&e.handleExitOrSelfUpdate()})}},{key:"stopEventListener",value:function(){}},{key:"showDialog",value:function(e){var t=this;this.dialog||(this.dialog=new V.default),this.softkey.classList.remove("hidden"),this.dialog.prepareDialog(e),this.dialog.show(),this.dialog.on("closed",function(){t.isDialogDisplayed&&t.hideDialog(),g.default.nextComponentRef?g.default.nextComponentRef.element.focus():(t.focusIframe(),t.softkey.classList.add("hidden"))})}},{key:"hideDialog",value:function(e){this.dialog&&(this.dialog.hide(),e&&e())}},{key:"focusIframe",value:function(){var e=this;this.storeUpdate.isUpdating||requestAnimationFrame(function(){e.showLeavingPage(!1,function(){g.default.focusIframe()})})}},{key:"handleNoNetwork",value:function(){var e=document.querySelector("#ssr .loading-bar"),t=document.querySelector("#ssr .content>p");e.style="",t.dataset.l10nId=C.default.isWiFiCertified?"no-internet-with-tips":"no-internet-with-tips-wlan"}},{key:"isDialogDisplayed",get:function(){return!g.default.isElementHidden("dailog")}},{key:"isLeavingDisplayed",get:function(){return!g.default.isElementHidden("leaving")}}]),e}())},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.generateInstanceID=exports.fetchWithTimeout=exports.showRebootDialog=exports.getIsRebootAPISupported=exports.isVersionHigher=exports.sendIACMessageToSystem=exports.utils=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=t(9),a=t(11),s=t(10),u=t(7),c=n(u),l=t(19),f=n(l),d=t(12),p=n(d),h=function(){function e(){var t=this;r(this,e),this.rebootRequest=function(){var e=new CustomEvent("reboot-needed",{detail:"device-info-change"});window.dispatchEvent(e)},this.getCommsInfo=function(){var e={simMCC:null,simMNC:null,currentMCC:null,currentMNC:null},t=navigator.mozMobileConnections[0].iccId;if(null!==t){var n=navigator.mozIccManager.getIccById(t),r=n.iccInfo,i=navigator.mozMobileConnections[0].voice.network;r&&(e.simMCC=r.mcc,e.simMNC=r.mnc),i&&(e.currentMCC=i.mcc,e.currentMNC=i.mnc)}if(navigator.mozMobileConnections.length>1){var o=navigator.mozMobileConnections[1].iccId;if(e.simMCC2=null,e.simMNC2=null,e.currentMCC2=null,e.currentMNC2=null,null!==o){var a=navigator.mozIccManager.getIccById(o).iccInfo,s=navigator.mozMobileConnections[1].voice.network;a&&(e.simMCC2=a.mcc,e.simMNC2=a.mnc),s&&(e.currentMCC2=s.mcc,e.currentMNC2=s.mnc)}}return e},this.getIMEI=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Promise(function(t){asyncStorage.getItem(s.STORAGE_KEY.imei,function(n){if(n)t(n[e]);else{for(var r=navigator.mozMobileConnections,i=r.length,o=[],a=0;a<i;a++)o.push(r[a].getDeviceIdentities());Promise.all(o).then(function(n){var r=n.map(function(e){return e.imei});asyncStorage.setItem(s.STORAGE_KEY.imei,r),t(r[e])})}})})},this.mozAppToObject=function(e){var t={};for(var n in e)t[n]=e[n];return t},this.getStorePath=function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=new URLSearchParams,o="Tiny-Store-UI",a="";if(i.append("waitForToken",!0),e)if("launch-store"===e.name){var s=e.data,u=s.action,c=s.detail;switch(u){case"open-appspanel":var l=c.categoryCode;l&&i.append("categoryCode",l)}}else if("silent-launch"!==e.name){a="/app";var f=["inline-open-page","inline-open-by-name"],d=f.includes(e.name),p=e.data,h=p.url,v=p.name,m=p.autoDownload,g=p.pixel,y="push-app"===e.name||m;if(h)switch(e.name){case"open-deeplink":var b=new URL(h),w=b.searchParams,_=w.get("apps"),S=w.get("postResult");S&&i.append("postResult",S),_?i.append("manifest",encodeURIComponent(_)):a="";break;default:i.append("manifest",encodeURIComponent(h))}v&&i.append("name",v),g&&i.append("pixel",g),i.append("disposition",d?"inline":"window"),i.append("autoDownload",y)}return n&&i.append("version",n),r&&(i.append("experimentType",o),i.append("remoteVersion",r.version)),navigator.largeTextEnabled&&i.append("largeText","true"),t._debug&&i.append("debug",t._debug),a+"?"+i.toString()},this.updateLoadingProgress=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(f.default.online){var n=document.querySelector("#ssr .loading-bar"),r=document.querySelector("#ssr .content>p"),i=parseInt(n.style.width.replace("%",""),10),o=e+"%";Number.isNaN(i)&&(i=0),(t||e>i)&&(n.style.width=o,r.setAttribute("data-l10n-args",JSON.stringify({percentage:o})),r.setAttribute("data-l10n-id","loading-progress-content"))}},this.reloadIframe=function(e){var n=c.default.storeVersion,r=t.getStorePath(null,n),i=window.deviceInfos.get("apps.serviceCenter.remoteUrl"),s=""+i+r;if(e===s){var u=new a.RequestReloadCommand;return o.MessageSender.send(u),null}return s},this.isBackgroundStoreSupported=function(e){var t={major:2,minor:5,build:2},n=e.replace(/[^0-9^.]/g,"").split("."),r=parseInt(n[0],10),i=parseInt(n[1],10),o=parseInt(n[2],10);return r>t.major||(r===t.major&&i>t.minor||r===t.major&&i===t.minor&&o>=t.build)},this._debug=!1,this._cacheCommsInfo=JSON.stringify(this.trimCommInfo),this.startListeners()}return i(e,[{key:"startListeners",value:function(){this.addConnectionsListeners()}},{key:"addConnectionsListeners",value:function(){var e=this,t=window.navigator.mozMobileConnections;t&&Array.from(t).forEach(function(t){t.addEventListener("voicechange",function(){e.checkParameters()})})}},{key:"checkParameters",value:function(){var e=JSON.stringify(this.trimCommInfo);this._cacheCommsInfo!==e&&this.rebootRequest()}},{key:"getAllDeviceInfo",value:function(){var e=this,t={};return t.connection=this.getCommsInfo(),c.default.getDeviceInfos().then(function(n){var r={};n.forEach(function(e,t){r[t]=e}),t.settings=r,t.bookmarkSupported=c.default.isBookmarkSupported(n.get("apps.serviceCenterUrl"));var i=n.get("ril.data.defaultServiceId");return t.connection.defaultServiceId=i,t.connection.type=c.default.connectionType(i),e.getIMEI()}).then(function(e){return t.connection.imei=e,t})}},{key:"showToastMsg",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"hidden"===document.visibilityState||p.default.isKaiPayRunning||window.Toaster.showToast({messageL10nId:e,messageL10nArgs:t})}},{key:"performanceMeasure",value:function(e){var t=performance.getEntriesByName(e+"_START"),n=performance.getEntriesByName(e+"_END");t.length&&n.length?performance.measure(e,e+"_START",e+"_END"):this.dump("[Measure Failed] "+e)}},{key:"performanceLogs",value:function(){var e=this,t=["SSR","KAISTORE","FETCH_CONFIG","GET_DEVICE_INFO","INIT_ACCOUNT","INIT_MESSENGER","INIT_LISTENERS","SELF_UPDATE","GET_TOKEN","CHECK_PRELOAD_UPDATE","GET_INSTALLED_APPS","SERVICE_WORKER","CHECK_PARAM","CHECK_FOTA"],n=["/?waitForToken=true","/combo?","/products?purchased=true"],r=null,i=0;t.forEach(function(t){return e.performanceMeasure(t)}),r=performance.getEntriesByType("measure"),n.forEach(function(t){var n=e.findEntity(t);n&&r.push(n)}),this.dump("******** [Client] Performance Testing ********");var o=window.clientRebootTime?window.clientRebootTime:window.timeOriginInEpoch;this.dump("Client's timeOrigin: "+window.timeOriginInEpoch),r.sort(function(e,t){return e.startTime-t.startTime}).forEach(function(t,n){var r=0,o=0;0===n&&(e.dump("[First Performance Mark]["+t.name+"] delta with timeOrigin: "+t.startTime),i=t.startTime),r=(t.startTime-i).toFixed(2),o=t.duration.toFixed(2),e.dump("["+t.name+"] start: "+r+" ms, duration: "+o)}),this.dump("******** [Client] End ********"),this.dump("First View Render Time: "+(this.remoteCompleteTime-o));var a=performance.timing,s=a.loadEventEnd-a.navigationStart,u=a.domComplete-a.domLoading;this.dump("[pageLoadTime: "+s+"] loadEventEnd: "+a.loadEventEnd+", navigationStart: "+a.navigationStart+", "),this.dump("[renderTime: "+u+"] domComplete: "+a.domComplete+", domLoading: "+a.domLoading)}},{key:"findEntity",value:function(e){return performance.getEntriesByType("resource").find(function(t){return t.name.includes(e)})}},{key:"dump",value:function(){var e;this._debug&&(e=console).warn.apply(e,arguments)}},{key:"clearPerformanceLogs",value:function(){performance.clearMarks(),performance.clearMeasures(),performance.clearResourceTimings()}},{key:"stringToBlob",value:function(e){if("string"!=typeof e)return console.warn("Only support for transform type of data is string."),e;for(var t=[],n=0;n<e.length;n++)t.push(e.charCodeAt(n));return new Blob([new Uint8Array(t)],{type:"text/plain"})}},{key:"trimCommInfo",get:function(){var e=this.getCommsInfo();return delete e.currentMCC,delete e.currentMNC,e}}]),e}();exports.utils=new h,exports.sendIACMessageToSystem=function(e){navigator.mozApps.getSelf().onsuccess=function(t){t.target.result.connect("storecomms").then(function(t){t.forEach(function(t){t.postMessage(e)})},function(e){console.warn("IAC connection rejected.",e)})}},exports.isVersionHigher=function(e,t){var n=e.split(".").map(function(e){return parseInt(e,10)}),r=t.split(".").map(function(e){return parseInt(e,10)}),i=Math.abs(n.length-r.length);i>0&&(n.length>r.length?r=r.concat(Array(i).fill(0)):n=n.concat(Array(i).fill(0)));for(var o=0;o<n.length;o++){var a=n[o],s=r[o];if(s>a)return!0;if(a>s)return!1}return null},exports.getIsRebootAPISupported=function(){return new Promise(function(e){var t=navigator.mozApps.mgmt.getAll();t.onsuccess=function(t){var n=t.target.result,r=n.find(function(e){return"app://system.gaiamobile.org/manifest.webapp"===e.manifestURL});e(!(!r||!r.manifest.activities["reboot-device"]))},t.onerror=function(t){console.warn("getIsRebootAPISupported failed.",t),e(!1)}})},exports.showRebootDialog=function(){navigator.mozApps.getSelf().onsuccess=function(e){var t=e.target.result.manifest.locales,n=t[navigator.language]||t["en-US"],r=n.name;new MozActivity({name:"reboot-device",data:{appName:r}})}},exports.fetchWithTimeout=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e3,r="[Timeout] It takes more than "+n+"ms to fetch data from "+e+".";return Promise.race([fetch(e,t),new Promise(function(e,t){return setTimeout(function(){return t(new Error(r))},n)})])},exports.generateInstanceID=function(){return Math.random().toString(36).substr(2,9)}},function(e,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.commandList={INSTALL_APP:"install_app",UNINSTALL_APP:"uninstall_app",PIN_BOOKMARK:"add_bookmark",UNPIN_BOOKMARK:"remove_bookmark",REQUEST_DEVICE_INFO:"request_device_info",REQUEST_TOKEN:"request_token",SHOW_NOTIFICATION:"show_notification",REQUEST_PAYMENT_PROFILE:"request_payment_profile",REQUEST_INSTALLED_APPS:"request_installed_apps",REQUEST_BOOKMARKS:"request_bookmarks",REQUEST_HAS_FEATURE:"request_has_feature",REQUEST_SETTING:"request_setting",UPDATE_SETTING:"update_setting",MOZAPP_UPDATE:"mozapp_update",BOOKMARK_UPDATE:"bookmark_update",TASK_QUEUE_UPDATE:"task_queue_update",SHOW_TOAST:"show_toast",CANCEL_DOWNLOAD:"cancel_download",LAUNCH_APP:"launch_app",UPDATE_APP:"update_app",REQUEST_PAYMENT:"request_payment",CHECK_APP_UPDATE:"check_app_update",NOTIFY_STORE_UPDATABLE:"notify_store_updatable",ACCOUNT_EVENT:"account_event",OPEN_ACCOUNT:"open_account",GET_ACCOUNT_VERSION:"get_account_version",CHANGE_THEME_COLOR:"change_theme_color",REQUEST_RELOAD:"request_reload",CHECK_REBOOT:"check_reboot",REQUEST_EXIT:"request_exit",REMOTE_UI_IS_READY:"remote_ui_is_ready",CHECK_IF_STORAGE_ENOUGH:"check_if_storage_enough",SYNC_LOADING_PROGRESS:"sync_loading_progress",SEND_HTTP_REQUEST:"send_http_request",GET_ITEM_FROM_CACHE:"get_item_from_cache",SET_ITEM_TO_CACHE:"set_item_to_cache",REQUEST_DEFAULT_PAYMENT_METHOD:"request_default_payment_method",LAUNCH_ACTIVITY:"launch_activity",NOTIFY_STORE_CLOSE:"notify_store_close",IFRAME_HAS_FOCUS:"iframe_has_focus"}},function(e,exports){"use strict";function t(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(exports,"__esModule",{value:!0});var n,r=(exports.mozAppsEvents={INSTALL:"install",UNINSTALL:"uninstall",UPDATE:"update"},exports.mozAppEvent={ON_DOWNLOAD_APPLIED:"ondownloadapplied",ON_DOWNLOAD_ERROR:"ondownloaderror",ON_PROGRESS:"onprogress",ON_DOWNLOAD_AVAILABLE:"ondownloadavailable",ON_DOWNLOAD_SUCCESS:"ondownloadsuccess"},exports.accountEvent={ON_ACCOUNT_API_MISSING:"missing",ON_LOGIN:"login",ON_LOGOUT:"logout",ON_READY:"ready",ON_ERROR:"error"},exports.tokenType={RESTRICTED:0,ACCOUNT:1},exports.validFeature={HAS_WIFI:"device.capability.wifi",IS_WIFI_CERTIFIED:"device.capability.wifi.wifi_certified"},exports.validSettingKey={AUTO_DOWNLOAD:"app.update.auto-download",RICH_CONTENT:"store.richcontent.mode"}),i=(exports.validSettingData=(n={},t(n,r.AUTO_DOWNLOAD,{default:"data-enable",values:["auto-update-off","data-enable","wifi-only"]}),t(n,r.RICH_CONTENT,{default:"wifi-only",values:["do-not-show","data-enable","wifi-only"]}),n),exports.validStorageSections={INSTALL:"install",UPDATE:"update"},exports.kaistoreApps={FIH_HMD:"mpEy1f2paIZOdwYMzzr6",STORE:"daR-aFQOTlGk8DJePIQA"});exports.internalApps=Object.assign({PAYMENT:"UgW01f5JflryQMM4H7SF",EVENT_LOGGER:"qli0T1E695LxmxEqZer4"},i),exports.preloadedApps={GVA:"OSlAbgrhLArfT7grf4_N"}},function(e,exports){"use strict";function t(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=n.length,i=0;i<e;i++)t+=n.charAt(Math.floor(Math.random()*r));return t}function n(e){return Object.assign({id:t(5)+(new Date).getTime()+r(JSON.stringify(e))},e)}function r(e){return e.split("").reduce(function(e,t){return e=(e<<5)-e+t.charCodeAt(0),e&e},0)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.generateID=t,exports.generateDefault=n,exports.hashCode=r},function(e,exports,t){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Command=void 0;var n=t(6),r=new n.ObjectModel({id:String,action:String});exports.Command=r},function(e,exports){"use strict";function t(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function n(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function r(e,t){return C(e)?new o(e,t):new i(e)}function i(e){return D(e,i)}function o(e){return D(e,o,Object,x,function(t){return re(t,e)},!0)}function a(e){var t=oe(Array,a,e,function(e){return Array.isArray(e)?e.map(function(e){return te(e,t.definition)}):e},function(e){return[].concat(n(e))},{copyWithin:[],fill:[0,0],pop:[],push:[0],reverse:[],shift:[],sort:[],splice:[2],unshift:[0]},{set:function(e,n,r){return ae(t,e,n,r,function(e,t){return e[n]=t},!0)},deleteProperty:function(e,n){return ae(t,e,n,void 0,function(e){return delete e[n]})}});return t}function s(e){var t=oe(Set,s,e,function(e){return T(e)?new Set([].concat(n(e)).map(function(e){return te(e,t.definition)})):e},function(e){return new Set(e)},{add:[0,0],delete:[],clear:[]});return t}function u(e,t){var r=function(e){return 0===e?i.definition.key:i.definition.value},i=oe(Map,u,{key:e,value:t},function(e){return T(e)?new Map([].concat(n(e)).map(function(e){return e.map(function(e,t){return te(e,r(t))})})):e},function(e){return new Map(e)},{set:[0,1,r],delete:[],clear:[]});return i}function c(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return D({arguments:t},c,Function,null,function(e){return{getPrototypeOf:function(){return e.prototype},get:function(e,t){return t===U?e:e[t]},apply:function(t,n,r){for(var i=e.definition,o=i.arguments.find(function(e){return S(ie.remaining,e)}),a=o?Math.max(r.length,i.arguments.length-1):i.arguments.length,s=0;s<a;s++){var u=o&&s>=i.arguments.length-1?o.definition:i.arguments[s];r[s]=Y(r[s],u,"arguments["+s+"]",e.errors,[],!0)}Q(r,e,"arguments");var c=void 0;return e.errors.length||(c=Reflect.apply(t,n,r),"return"in i&&(c=Y(c,i.return,"return value",e.errors,[],!0))),F(e),c}}})}Object.defineProperty(exports,"__esModule",{value:!0});var l,f,d,p,h=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(u){i=!0,o=u}finally{try{!r&&s.return&&s.return();}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g=Object.prototype,y=function(e){return g.toString.call(e).match(/\s([a-zA-Z]+)/)[1]},b=Object.getPrototypeOf,w=Object.setPrototypeOf,_=function(e,t){return g.hasOwnProperty.call(e,t)},S=function(e,t){return t instanceof e},E=function(e){return"function"==typeof e},k=function(e){return e&&"object"===("undefined"==typeof e?"undefined":m(e))},A=function(e){return"string"==typeof e},C=function(e){return k(e)&&b(e)===g},T=function(e){return e&&E(e[Symbol.iterator])},O=function(e,t){return new Proxy(e,t)},I=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};for(var r in n)if(C(n[r])){var i={};e(i,t[r]),e(i,n[r]),t[r]=i}else t[r]=n[r];return t},P=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Object.defineProperty(e,t,{value:n,enumerable:r,writable:!0,configurable:!0})},R=function(e,t,n){e.prototype=Object.assign(Object.create(t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n),w(e,t)},M=Symbol(),L=Symbol(),U=Symbol(),N=Symbol(),D=function(e,t,r,i,o,a){var s=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.default,n=arguments[1];return a&&!S(e,this)?new e(t):(i&&(t=i(t,e,this)),n===L||G(e,t)?o&&n!==N?O(t,o(e)):t:void 0)};return r&&R(s,r),w(s,t.prototype),s.constructor=t,s.definition=e,s.assertions=[].concat(n(s.assertions)),P(s,"errors",[]),delete s.name,s},x=function(e,t,n){return S(t,e)?e:(k(e)||E(e)||void 0===e||B(t.errors,Object,e),I(n,t.default),t.parentClass&&I(e,new t.parentClass(e)),I(n,e),n)},j=function(e,t,r){var i;return R(e,t,r),(i=e.assertions).push.apply(i,n(t.assertions)),e},B=function(e,t,n,r,i){e.push({expected:t,received:n,path:r,message:i})},F=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.errorCollector,n=e.errors.length;if(n>0){var r=e.errors.map(function(e){return e.message||(e.message="expecting "+(e.path?e.path+" to be ":"")+K(e.expected)+", got "+(null!=e.received?y(e.received)+" ":"")+J(e.received)),e});e.errors.length=0,t.call(e,r)}return n},z=function(e){return e&&b(e)&&S(r,b(e).constructor)},H=function e(t){if(C(t)){t={};for(var n in t)t[n]=e(t[n])}else{if(!Array.isArray(t))return[t];if(1===t.length)return[t[0],void 0,null]}return t},K=function(e,t){var n=H(e).map(function(e){return J(e,t)});return n.length>1?n.join(" or "):n[0]},q=function(e){return e.length?"("+e.map(function(e){return e.name||e.description||e})+")":""},V=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(t.length>0){var r;e=(r=[]).concat.apply(r,[e].concat(n([].concat(t)))).filter(function(e,t,n){return n.indexOf(e)===t})}return e},G=function(e,t){return e[M](t,null,e.errors,[],!0),!F(e)},Y=function e(t,n,i,o,a,s){var u=a.indexOf(n);if(u!==-1&&a.indexOf(n,u+1)!==-1)return t;if(Array.isArray(n)&&1===n.length&&null!=t&&(n=n[0]),S(r,n))s&&(t=te(t,n)),n[M](t,i,o,a.concat(n));else if(C(n))for(var c in n){var l=t?t[c]:void 0;e(l,n[c],X(i,c),o,a,s)}else{var f=H(n);if(f.some(function(e){return W(t,e,i,a)}))return s?te(t,n):t;B(o,n,t,i)}return t},W=function(e,t,n,i,o){if(t===ie)return!0;if(null==e)return e===t;if(C(t)||S(r,t)){var a=[];return Y(e,t,n,a,i,o),!a.length}return S(RegExp,t)?t.test(e):t===Number||t===Date?e.constructor===t&&!isNaN(e):e===t||E(t)&&S(t,e)||e.constructor===t},Q=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.errors,i=!0,o=!1,a=void 0;try{for(var s,u=function(){var i=s.value,o=void 0;try{o=i.call(t,e)}catch(a){o=a}if(o!==!0){B(r,i,e,n,(E(i.description)?i.description:function(e,t){return'assertion "'+i.description+'" returned '+J(e)+" "+("for "+(n?n+" =":"value")+" "+J(t))}).call(t,o,e,n))}},c=t.assertions[Symbol.iterator]();!(i=(s=c.next()).done);i=!0)u()}catch(l){o=!0,a=l}finally{try{!i&&c.return&&c.return()}finally{if(o)throw a}}},J=function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(i.length>15||i.includes(t))return"...";if(null===t||void 0===t)return String(t);if(A(t))return'"'+t+'"';if(S(r,t))return t.toString(i);if(i.unshift(t),E(t))return t.name||t.toString();if(S(Map,t)||S(Set,t))return e([].concat(n(t)));if(Array.isArray(t))return"["+t.map(function(t){return e(t,i)}).join(", ")+"]";if(t.toString&&t.toString!==g.toString)return t.toString();if(k(t)){var o=Object.keys(t),a="\t".repeat(i.length);return"{"+o.map(function(r){return"\n"+(a+r)+": "+e(t[r],[].concat(n(i)))}).join(", ")+" "+(o.length?"\n"+a.slice(1):"")+"}"}return String(t)},X=function(e,t){return e?e+"."+t:t},Z=function(e,t,n,r,i,o,a){var s=X(n,i),u=e.conventionForPrivate(i),c=e.conventionForConstant(i),l=_(r,i),f=l&&Object.getOwnPropertyDescriptor(r,i);i in t&&(u&&!o||c&&void 0!==r[i])&&ee("modify "+(u?"private":"constant")+" property "+i,e),a(),_(t,i)&&Y(r[i],t[i],s,e.errors,[]),Q(r,e,s);var d=e.errors.length;return d&&(l?Object.defineProperty(r,i,f):delete r[i],F(e)),!d},ee=function(e,t){t.errors.push({message:"cannot "+e})},te=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!e||C(t)||S(i,t)||z(e))return e;var n=H(t),o=[],a=!0,s=!1,u=void 0;try{for(var c,l=n[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var f=c.value;S(r,f)&&!S(i,f)&&f.test(e)&&o.push(f)}}catch(d){s=!0,u=d}finally{try{!a&&l.return&&l.return()}finally{if(s)throw u}}return 1===o.length?new o[0](e,L):(o.length>1&&console.warn("Ambiguous model for value "+J(e)+", could be "+o.join(" or ")),e)},ne=function(e,t,n,r,i){return C(n)?O(e,re(t,n,r,i)):te(e,n)},re=function(e,t,n,r){var i=function(e){return O(e,{apply:function(e,t,n){r=!0;var i=Reflect.apply(e,t,n);return r=!1,i}})};return{get:function(o,a){if(a===U)return o;if(!A(a))return Reflect.get(o,a);var s=X(n,a),u=_(t,a),c=t[a];if(!r&&u&&e.conventionForPrivate(a))return ee("access to private property "+s,e),void F(e);var l=o[a];return u&&l&&_(o,a)&&!C(c)&&!z(l)&&Reflect.set(o,a,l=te(l,c)),E(l)&&"constructor"!==a&&!r?i(l):(C(c)&&!l&&(o[a]=l={}),ne(l,e,c,s,r))},set:function(i,o,a){return Z(e,t,n,i,o,r,function(){return Reflect.set(i,o,te(a,t[o]))})},deleteProperty:function(i,o){return Z(e,t,n,i,o,r,function(){return Reflect.deleteProperty(i,o)})},defineProperty:function(i,o,a){return Z(e,t,n,i,o,r,function(){return Reflect.defineProperty(i,o,a)})},has:function(n,r){return Reflect.has(n,r)&&Reflect.has(t,r)&&!e.conventionForPrivate(r)},ownKeys:function(n){return Reflect.ownKeys(n).filter(function(n){return Reflect.has(t,n)&&!e.conventionForPrivate(n)})},getOwnPropertyDescriptor:function(n,r){var i=void 0;return e.conventionForPrivate(r)||(i=Object.getOwnPropertyDescriptor(t,r),void 0!==i&&(i.value=n[r])),i}}};Object.assign(r.prototype,(l={name:"Model",assertions:[],conventionForConstant:function(e){return e.toUpperCase()===e},conventionForPrivate:function(e){return"_"===e[0]},toString:function(e){return _(this,"name")?this.name:K(this.definition,e)+q(this.assertions)},as:function(e){return P(this,"name",e),this},defaultTo:function(e){return this.default=e,this}},t(l,M,function(e,t,n,r){Y(e,this.definition,t,n,r),Q(e,this,t,n)}),t(l,"test",function(e,t){for(var n=this,r=this;!_(r,"errorCollector");)r=b(r);var i=r.errorCollector,o=void 0;return r.errorCollector=function(e){o=!0,t&&t.call(n,e)},new this(e),r.errorCollector=i,!o}),t(l,"errorCollector",function(e){var t=new TypeError(e.map(function(e){return e.message}).join("\n"));throw t.stack=t.stack.replace(/\n.*object-model(.|\n)*object-model.*/,""),t}),t(l,"assert",function(e){return P(e,"description",arguments.length>1&&void 0!==arguments[1]?arguments[1]:J(e)),this.assertions=this.assertions.concat(e),this}),l)),r.CHECK_ONCE=N,R(i,r,{extend:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var o=j(new i(V(this.definition,t)),this),a=!0,s=!1,u=void 0;try{for(var c,l=t[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var f,d=c.value;S(i,d)&&(f=o.assertions).push.apply(f,n(d.assertions))}}catch(p){s=!0,u=p}finally{try{!a&&l.return&&l.return()}finally{if(s)throw u}}return o}}),R(o,r,t({defaultTo:function(e){var t=this.definition;for(var n in e)_(t,n)&&(e[n]=Y(e[n],t[n],n,this.errors,[],!0));return F(this),this.default=e,this},toString:function(e){return J(this.definition,e)},extend:function(){for(var e=v({},this.definition),t=v({},this.prototype),i=v({},this.default),a=[],s=arguments.length,u=Array(s),c=0;c<s;c++)u[c]=arguments[c];var l=!0,f=!1,d=void 0;try{for(var p,h=u[Symbol.iterator]();!(l=(p=h.next()).done);l=!0){var m=p.value;S(r,m)&&(I(e,m.definition),I(i,m.default),a.push.apply(a,n(m.assertions))),E(m)&&I(t,m.prototype),k(m)&&I(e,m)}}catch(g){f=!0,d=g}finally{try{!l&&h.return&&h.return()}finally{if(f)throw d}}var y=j(new o(e),this,t).defaultTo(i);return y.assertions=[].concat(n(this.assertions),a),b(this)!==o.prototype&&(y.parentClass=this),y}},M,function(e,t,n,r,i){k(e)?Y(e[U]||e,this.definition,t,n,r,i):B(n,this,e,t),Q(e,this,t,n)}));var ie=O(i(),{apply:function(e,t,n){var r=h(n,1),i=r[0],o=Object.create(ie);return o.definition=i,o}});ie.definition=ie,ie.toString=function(){return"Any"},ie.remaining=function(e){this.definition=e},R(ie.remaining,ie,{toString:function(){return"..."+K(this.definition)}}),ie[Symbol.iterator]=regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new ie.remaining(this.definition);case 2:case"end":return e.stop()}},e,this)});var oe=function(e,t,n,r,i,o,a){return D(n,t,e,r,function(t){return Object.assign({getPrototypeOf:function(){return t.prototype},get:function(n,r){if(r===U)return n;var a=n[r];return E(a)?O(a,{apply:function(a,s,u){if(_(o,r)){for(var c=h(o[r],3),l=c[0],f=c[1],d=void 0===f?u.length-1:f,p=c[2],v=l;v<=d;v++){var m=p?p(v):t.definition;u[v]=Y(u[v],m,e.name+"."+r+" arguments["+v+"]",t.errors,[],!0)}if(t.assertions.length>0){var g=i(n);a.apply(g,u),Q(g,t,"after "+r+" mutation")}F(t)}return a.apply(n,u)}}):a}},a)})};R(a,r,(f={toString:function(e){return"Array of "+K(this.definition,e)}},t(f,M,function(e,t,n,r){var i=this;Array.isArray(e)?(e[U]||e).forEach(function(e,o){return Y(e,i.definition,(t||"Array")+"["+o+"]",n,r)}):B(n,this,e,t),Q(e,this,t,n)}),t(f,"extend",function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return j(new a(V(this.definition,t)),this)}),f));var ae=function(e,t,r,i,o,a){var s="Array["+r+"]";+r>=0&&(a||r in t)&&(i=Y(i,e.definition,s,e.errors,[],!0));var u=[].concat(n(t));o(u),Q(u,e,s);var c=!F(e);return c&&o(t,i),c};R(s,r,(d={toString:function(e){return"Set of "+K(this.definition,e)}},t(d,M,function(e,t,n,r){if(S(Set,e)){var i=!0,o=!1,a=void 0;try{for(var s,u=e.values()[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){Y(s.value,this.definition,(t||"Set")+" value",n,r)}}catch(c){o=!0,a=c}finally{try{!i&&u.return&&u.return()}finally{if(o)throw a}}}else B(n,this,e,t);Q(e,this,t,n)}),t(d,"extend",function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return j(new s(V(this.definition,t)),this)}),d)),R(u,r,(p={toString:function(e){return"Map of "+K(this.definition.key,e)+" : "+K(this.definition.value,e)}},t(p,M,function(e,t,n,r){if(S(Map,e)){t=t||"Map";var i=!0,o=!1,a=void 0;try{for(var s,u=e[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=h(s.value,2),l=c[0],f=c[1];Y(l,this.definition.key,t+" key",n,r),Y(f,this.definition.value,t+"["+J(l)+"]",n,r)}}catch(d){o=!0,a=d}finally{try{!i&&u.return&&u.return()}finally{if(o)throw a}}}else B(n,this,e,t);Q(e,this,t,n)}),t(p,"extend",function(e,t){return j(new u(V(this.definition.key,e),V(this.definition.value,t)),this)}),p)),R(c,r,t({toString:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t="Function("+this.definition.arguments.map(function(t){return K(t,[].concat(n(e)))}).join(", ")+")";return"return"in this.definition&&(t+=" => "+K(this.definition.return,e)),t},return:function(e){return this.definition.return=e,this},extend:function(e,t){var r=this.definition.arguments,i=e.map(function(t,n){return V(n in r?r[n]:[],e[n])}),o=V(this.definition.return,t);return j((new(Function.prototype.bind.apply(c,[null].concat(n(i))))).return(o),this)}},M,function(e,t,n){E(e)||B(n,"Function",e,t)}));var se={list:"list-style-type: none; padding: 0; margin: 0;",listItem:"padding: 0 0 0 1em;",model:"color: #3e999f;",instance:"color: #718c00; font-style: italic",function:"color: #4271AE",string:"color: #C41A16",number:"color: #1C00CF",boolean:"color: #AA0D91",property:"color: #8959a8",private:"color: #C19ED8",constant:"color: #8959a8; font-weight: bold",privateConstant:"color: #C19ED8; font-weight: bold",null:"color: #8e908c",undeclared:"color: #C0C0C0;",proto:"color: #B871BD; font-style: italic"},ue=function(e){if(void 0===e||null===e)return null;var t=b(e);return t&&t.constructor&&S(r,t.constructor)?t.constructor:null},ce=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return["span",{style:e}].concat(n)},le=function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null===t||void 0===t?ce(se.null,""+t):"boolean"==typeof t?ce(se.boolean,t):"number"==typeof t?ce(se.number,t):"string"==typeof t?ce(se.string,'"'+t+'"'):Array.isArray(t)&&i.isModelDefinition?ce.apply(void 0,[""].concat(n(t.flatMap(function(t){return[e(t,i)," or "]}).slice(0,-1)))):C(t)?fe(t,ue(t),i):E(t)&&!S(r,t)&&i.isModelDefinition?ce(se.function,t.name||t.toString()):["object",{object:t,config:i}]},fe=function(e,t,r){return ce("","{",["ol",{style:se.list}].concat(n(Object.keys(e).map(function(t){return["li",{style:se.listItem},ce(se.property,t),": ",le(e[t],r)]}))),"}")},de=function(e){var t={isModelDefinition:!0},r=e.definition,o=function(e,t){return e.flatMap(function(e){return[t(e),", "]}).slice(0,-1)},l=[];if(S(i,e)&&(l=[le(r,t)]),S(a,e)&&(l=["Array of ",le(r,t)]),S(s,e)&&(l=["Set of ",le(r,t)]),S(u,e)&&(l=["Map of ",le(r.key,t)," : ",le(r.value,t)]),S(c,e)&&(l=["Function("].concat(n(o(r.arguments,function(e){return le(e,t)})),[")"]),"return"in r&&l.push(" => ",le(r.return,t))),e.assertions.length>0){var f;(f=l).push.apply(f,["\n(assertions: "].concat(n(o(e.assertions,function(e){return["object",{object:e}]})),[")"]))}return ce.apply(void 0,[se.model].concat(n(l)))},pe={header:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e===ie?ce(se.model,"Any"):S(ie.remaining,e)?ce(se.model,"...",le(e.definition,{isModelDefinition:!0})):S(o,e)?ce(se.model,e.name):S(r,e)?de(e):t.isModelDefinition&&C(e)?le(e,t):null},hasBody:function(e){return S(o,e)},body:function(e){return ce("","{",["ol",{style:se.list}].concat(n(Object.keys(e.definition).map(function(t){var n=e.conventionForPrivate(t),r=e.conventionForConstant(t),i=e.default&&_(e.default,t),o=se.property;return n?o=r?se.privateConstant:se.private:r&&(o=se.constant),["li",{style:se.listItem},ce(o,t),": ",le(e.definition[t],{isModelDefinition:!0}),i?ce(se.proto," = ",le(e.default[t])):""]}))),"}")}},he={header:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t.isInstanceProperty&&C(e))return le(e,t);var n=ue(e);if(S(r,n)){var i=S(o,n)?[n.name]:[["object",{object:e[U]}]," ("+n.name+")"];return ce.apply(void 0,[se.instance].concat(i))}return null},hasBody:function(e){return e&&S(o,ue(e))},body:function(e){var t=ue(e),r=e[U]||e;return ce("","{",["ol",{style:se.list}].concat(n(Object.keys(r).map(function(e){var n=t.conventionForPrivate(e),i=t.conventionForConstant(e),o=e in t.definition,a=se.property;return o?n?a=i?se.privateConstant:se.private:i&&(a=se.constant):a=se.undeclared,["li",{style:se.listItem},ce(a,e),": ",le(r[e],{isInstanceProperty:!0})]})),[["li",{style:se.listItem},ce(se.proto,"__proto__",": ",["object",{object:b(e)}])]]),"}")}};"undefined"!=typeof window&&(window.devtoolsFormatters=(window.devtoolsFormatters||[]).concat(pe,he)),exports.Any=ie,exports.ArrayModel=a,exports.BasicModel=i,exports.FunctionModel=c,exports.MapModel=u,exports.Model=r,exports.ObjectModel=o,exports.SetModel=s},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=t(3),a=t(10),s=t(72),u=n(s),c=function(){function e(){var t=this;r(this,e),this.rebootRequest=function(){var e=new CustomEvent("reboot-needed",{detail:"device-info-change"});window.dispatchEvent(e)},this.getMozSettings=function(e){return new Promise(function(t){var n=[];for(var r in e){var i=e[r];n.push(u.default.getSetting(r,i,!0))}Promise.all(n).then(function(e){t(e)})})},this.connectionType=function(e){return navigator.mozWifiManager&&"connected"===navigator.mozWifiManager.connection.status?"wifi":(window.navigator.mozMobileConnection||window.navigator.mozMobileConnections)[e].data.type},this.isBookmarkSupported=function(e){var t=e,n=t.split("/"),r=n[3];return!!(r&&r.indexOf("v3.0")>=0)},this.getTimeZoneOffset=function(){var e=new Date,t=-e.getTimezoneOffset();return 0!==t&&(t/=60),t},this.getTimeStamp=function(){var e=new Date,t=-e.getTimezoneOffset(),n=t>=0?"+":"-";return e.getFullYear()+"-"+(e.getMonth()+1).toString().padStart(2,"0")+"-"+e.getDate().toString().padStart(2,"0")+"T"+e.getHours().toString().padStart(2,"0")+":"+e.getMinutes().toString().padStart(2,"0")+":"+e.getSeconds().toString().padStart(2,"0")+n+Math.abs(t/60).toString().padStart(2,"0")+":"+Math.abs(t%60).toString().padStart(2,"0")},this.onLargeTextChange=function(){t.hasLargeTextChanged=!0,t.rebootRequest()},this.settingsQuery={cached:{"deviceinfo.hardware":"unknown","deviceinfo.os":"unknown","deviceinfo.product_model":"unknown","deviceinfo.software":"unknown","deviceinfo.cu":"4044O-2BAQUS1-R","deviceinfo.platform_build_id":"","deviceinfo.build_number":"","deviceinfo.platform_version":"","apps.serviceCenterUrl":"https://api.kaiostech.com/v3.0","apps.serviceCenter.microServiceUrl":"https://api.kaiostech.com/kc_ksfe/v1.0","apps.searchBaseUrl":"https://search.kaiostech.com","apps.graphqlBaseUrl":"https://api.store.kaiostech.com","apps.graphql.key":"vTPQIDW1Qc5PjgLDBdGDN8334Yil3fre334oToEn","apps.analyticsEventBaseUrl":"https://analytics.kaiostech.com/v1","apps.serviceCenter.remoteUrl":"https://kaios-plus.kaiostech.com","identity.kaiaccounts.api.uri":"https://api.kaiostech.com","store.coreUpdate.enable":!1},runtime:{"apps.serviceCenter.settingsEnabled":!1,"ril.data.defaultServiceId":""}},this.isWiFiCertified=!1,this.infoPromise=null,this.storeVersion=null,this.storeName=null,this.storeManifestURL=null,this.hasScreenOffed=!1,this.hasLargeTextChanged=!1,this.startListeners(),this.checkWiFiCertification()}return i(e,[{key:"startListeners",value:function(){var e=this;window.addEventListener("languagechange",this.rebootRequest.bind(this)),window.addEventListener("largetextenabledchanged",this.onLargeTextChange),navigator.mozSettings.onsettingchange=function(t){var n=e.settingsQuery,r=n.cached,i=n.runtime,o=t.settingName;Object.keys(r).indexOf(o)!==-1?(asyncStorage.setItem(a.STORAGE_KEY.deviceInfos,null),e.rebootRequest()):Object.keys(i).indexOf(o)!==-1&&e.rebootRequest()}}},{key:"updateDeviceInfos",value:function(){var e=new Map;this.getMozSettings(this.settingsQuery.cached).then(function(t){t.forEach(function(t){var n=Object.keys(t)[0];e.set(n,t[n])}),asyncStorage.setItem(a.STORAGE_KEY.deviceInfos,e)})}},{key:"getDeviceInfos",value:function(){var e=this;return(arguments.length>0&&void 0!==arguments[0]&&arguments[0]||null===this.infoPromise)&&(this.infoPromise=new Promise(function(t){asyncStorage.getItem(a.STORAGE_KEY.deviceInfos,function(n){if(n)console.warn("Most of deviceInfos are from asyncStorage"),e.getMozSettings(e.settingsQuery.runtime).then(function(e){e.forEach(function(e){var t=Object.keys(e)[0];n.set(t,e[t])}),t(n)});else{var r=new Map;console.warn("All deviceInfos are from mozSettings"),e.getMozSettings(e.settingsQuery.cached).then(function(n){n.forEach(function(e){var t=Object.keys(e)[0];r.set(t,e[t])}),asyncStorage.setItem(a.STORAGE_KEY.deviceInfos,r),e.getMozSettings(e.settingsQuery.runtime).then(function(e){e.forEach(function(e){var t=Object.keys(e)[0];r.set(t,e[t])}),t(r)})})}})})),this.infoPromise}},{key:"canAutoSelfUpdate",value:function(){var e=this,t=o.validSettingKey.AUTO_DOWNLOAD,n=o.validSettingData[t].default,r=window.deviceInfos.get("ril.data.defaultServiceId");return new Promise(function(i){u.default.getSetting(t,n,!0).then(function(n){var o=n[t],a=!1;switch(o){case"wifi-only":a="wifi"===e.connectionType(r);break;case"data-enable":a=!0;break;case"auto-update-off":}i(a)})})}},{key:"checkWiFiCertification",value:function(){var e=this;navigator.hasFeature(a.FEAT_KEY_WIFI_CERTIFIED).then(function(t){e.isWiFiCertified=t||void 0===t})}},{key:"prepareStoreAppInfo",value:function(){var e=this;return this.storeName&&this.storeVersion?Promise.resolve({name:storeName,version:storeVersion}):navigator.mozApps.getSelf().then(function(t){var n=t.manifest&&t.manifest.name?t.manifest.name:null,r=t.manifest&&t.manifest.version?t.manifest.version:null;return e.storeName=n,e.storeVersion=r,e.storeManifestURL=t.manifestURL,{name:n,version:r}})}}]),e}(),l=new c;exports.default=l},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var i=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(u){i=!0,o=u}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=t(38),s=n(a),u=t(7),c=n(u),l=function(){function e(){r(this,e),this._kid=null,this._macKey=null,this.apiURI=null}return o(e,[{key:"_getDefaultConnectionType",value:function(e){this._hasValidDeviceInfos({deviceInfos:e,validateKeys:["ril.data.defaultServiceId"]});var t=e.get("ril.data.defaultServiceId");return navigator.mozWifiManager&&"connected"===navigator.mozWifiManager.connection.status?"wifi":(window.navigator.mozMobileConnection||window.navigator.mozMobileConnections)[t].data.type}},{key:"_getTimeZoneOffset",value:function(){var e=new Date,t=e.getTimezoneOffset();return 0===t?t:-(t/60)}},{key:"_getTimeStamp",value:function(){var e=new Date,t=-e.getTimezoneOffset(),n=t>=0?"+":"-";return e.getFullYear()+"-"+(this._formatedTime(e.getMonth()+1)+"-")+(this._formatedTime(e.getDate())+"T")+(this._formatedTime(e.getHours())+":")+(this._formatedTime(e.getMinutes())+":")+(this._formatedTime(e.getSeconds())+":")+(""+n)+(this._formatedTime(Math.abs(t/60))+":")+(""+this._formatedTime(Math.abs(t%60)))}},{key:"_formatedTime",value:function(e){return e.toString().padStart(2,"0")}},{key:"_hasValidDeviceInfos",value:function(e){var t=e.deviceInfos,n=e.validateKeys;if(!(t instanceof Map&&t.size))return console.error("ArgumentError: Expected deviceInfos Map to not be empty"),!1;if("undefined"==typeof n||0===n.length)return!0;var r=[];return n.forEach(function(e){t.has(e)||r.push(e)}),!(r.length>0)||(console.error("ArgumentError: Expected Map to have keys ["+r.toString()+"]"),!1)}},{key:"getRequester",value:function(e){var t=e.serverTimeOffset,n=e.setDeviceInfo,r=void 0===n||n,i=e.deviceInfos;if(!this.isTokenSet)return null;r&&this._hasValidDeviceInfos({deviceInfos:i,validateKeys:["deviceinfo.platform_build_id","deviceinfo.build_number"]});var o=new s.default;if(o.setHawkCredentials(this._kid,this._macKey),t&&(o.serverTimeOffset=t),r===!0){var a=i.get("deviceinfo.platform_build_id"),u=i.get("deviceinfo.build_number");o.setDeviceInfo({ct:this._getDefaultConnectionType(i),utc:this._getTimeStamp(),utcOff:this._getTimeZoneOffset(),buildID:a,buildNumber:u,client_version:c.default.storeVersion,client_name:c.default.storeName})}return o}},{key:"generateURL",value:function(e){var t=e.apiName,n=e.params,r=e.deviceInfos,o=this.apiURI;return null===o&&this._hasValidDeviceInfos({deviceInfos:r,validateKeys:["apps.serviceCenterUrl"]})&&(o=r.get("apps.serviceCenterUrl")+"/"),""+o+t+Object.entries(n).reduce(function(e,t){var n=i(t,2),r=n[0],o=n[1];return e.concat("&",r,"=",o)},"").replace("&","?")}},{key:"setToken",value:function(e,t){this._kid=e,this._macKey=t}},{key:"isTokenSet",get:function(){return null!==this._kid&&null!==this._macKey}}]),e}();exports.default=new l},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.postMessageResponse=exports.MessageSender=exports.MessageListener=void 0;var r=t(58),i=n(r),o=t(59),a=n(o),s=t(57);exports.MessageListener=i.default,exports.MessageSender=a.default,exports.postMessageResponse=s.response},function(e,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.STORAGE_KEY={deviceInfos:"cached-device-info",imei:"cached-imei",activationPing:"cached-activation-ping",serverTimeOffset:"hawk-request-server-time-offset",parameters:"parameters",isStoreUpdatable:"is-store-updatable",experimentConfig:"cached-experiment-config",simInfo:"cached-sim-Info",l10nMapping:"l10nMapping",subscriptionRecord:"subscriptionRecord"},exports.PUSH_TEXT=["install","dismiss","new-app-recommended","open-url","update-available","store-update-and-launch","ok","app-push-launch-action","app-push-launch-content"],exports.TRIGGER_TYPE={MOZ_APP_LAUNCH:"mozApp.launch()",FTU_REGISTER:"ftu-register",QUICK_LAUNCH:"quick-launch"},exports.FEAT_KEY_WIFI_CERTIFIED="device.capability.wifi.wifi_certified"},function(e,exports,t){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var n=t(46);Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return n[e]}})});var r=t(48);Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return r[e]}})});var i=t(53);Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return i[e]}})});var o=t(50);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return o[e]}})});var a=t(51);Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return a[e]}})});var s=t(52);Object.keys(s).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return s[e]}})});var u=t(47);Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return u[e]}})});var c=t(49);Object.keys(c).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return c[e]}})});var l=t(45);Object.keys(l).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return l[e]}})})},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=t(1),a=t(20),s=n(a),u=function(){function e(){r(this,e),this.isKaiPayRunning=!1,this.isUpdated=!1}return i(e,[{key:"_emit",value:function(e,t){var n=new CustomEvent(e,t);window.dispatchEvent(n)}},{key:"request",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"profile",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(n.type=t,"payment"!==t||n.detail?n.detail&&(n.detail.connectKeyword="kaipay-to-kaistore"):console.error("No detail.id & detail.name in options object."),"payment"===t){if(this.isUpdated)return s.default.toggleRebootPanel({visible:!0,isInPaymentProcess:!0}),Promise.reject("reboot is required");this.isKaiPayRunning=!0,this._emit("account:state-changed",{detail:{lockedBy:"payment-helper"}})}return new Promise(function(t,r){var i=new Kaipay({data:n});i.onsuccess=function(n){e.isKaiPayRunning=!1,e._emit("account:state-changed",{detail:{lockedBy:null}}),t(n.target.result)},i.onerror=function(t){e.isKaiPayRunning=!1,e._emit("account:state-changed",{detail:{lockedBy:null}}),r(t.target.error)}})}},{key:"checkIfKaiPayUpdated",value:function(e){var t=this,n=e.manifest.version;if((0,o.isVersionHigher)("3.0.0",n)!==!1){var r=new Kaipay({data:{type:"get-loaded-version"}});return new Promise(function(e){r.onsuccess=function(r){var i=r.target.result.version;(0,o.isVersionHigher)(i,n)&&(t.isUpdated=!0),e("onsuccess")},r.onerror=function(r){var i=r.target.error.name;("NO_PROVIDER"===i||i.startsWith("activity handler is not set"))&&(0,o.isVersionHigher)("2.3.6",n)&&(t.isUpdated=!0),e("onerror")}})}}}]),e}();exports.default=new u},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=t(21),c=n(u),l=function(e){function t(){var e,n,o,a;r(this,t);for(var s=arguments.length,u=Array(s),c=0;c<s;c++)u[c]=arguments[c];return n=o=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),o.name="SoftKeyStore",a=n,i(o,a)}return o(t,e),s(t,[{key:"start",value:function(){this.currentKeys={},this.currentTheme=null,this.registeredDOMMap=new Map}},{key:"register",value:function(e,t,n){var r=this.registeredDOMMap.get(t),i=this;r?r.updateKeys(e):(r={start:function(){t.addEventListener("focus",this,!0),this.theme=n,this.updateKeys(e);},stop:function(){t.removeEventListener("focus",this,!0)},handleEvent:function(){this.check()},check:function(){if(document.activeElement===t||t.contains(document.activeElement)){var e=i.recount();i.store(e,this.theme)}},updateKeys:function(e){this.keys=e,this.check()}},this.registeredDOMMap.set(t,r),r.start())}},{key:"generateKeysInfo",value:function(e){var t=[];for(var n in e){var r={};switch(n){case"left":r.code="SoftLeft";break;case"center":r.code="Enter";break;case"right":r.code="SoftRight"}r.options={name:e[n]},t.push(r)}return t}},{key:"registerSoftkeys",value:function(e){var t=this,n=this.generateKeysInfo(e);n.length&&navigator.softkeyManager&&(n.forEach(function(e){if(e.options.name){var n="";n="object"===a(e.options.name)?e.options.name.text||n:e.options.name,e.options.name=t.toL10n(n)}}),navigator.softkeyManager.registerKeys(n))}},{key:"toL10n",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"complete"===navigator.mozL10n.readyState&&e?navigator.mozL10n.get(e)||e:e}},{key:"store",value:function(e,t){this.currentKeys=e,this.currentTheme=t,this.registerSoftkeys(e),this.emit("change")}},{key:"recount",value:function(){for(var e={},t=document.activeElement;t!==document.body;){var n=this.registeredDOMMap.get(t);if(n){var r=n.keys;for(var i in r)i in e||(e[i]=r[i])}t=t.parentNode}return e}},{key:"unregister",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.currentKeys={};var n=this.registeredDOMMap.get(e);n&&(n.stop(),this.registeredDOMMap.delete(e),t&&this.store(this.recount()))}}]),t}(c.default),f=new l;f.start(),exports.default=f},function(e,exports,t){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MozApp=exports.Bookmark=exports.NormalApp=exports.BookmarkApp=void 0;var n=t(6),r=new n.ObjectModel({category:Number,default_locale:String,description:String,icons:Object,id:String,installed:Boolean,locales:Object,manifest_url:String,name:String,paid:Boolean,version:String}).defaultTo({default_locale:"en-US"}),i=new n.ObjectModel({message:[String],name:String}).defaultTo({message:""}),o=r.extend({type:["bookmark"],url:String}).defaultTo({type:"bookmark"}),a=r.extend({type:["certified","hosted","privileged"],downloading:Boolean,installed:Boolean,paid:Boolean,progress:Number,updatable:Boolean}),s=new n.ObjectModel({url:String,icon:String,name:String}).defaultTo({type:"bookmark"}),u=new n.ObjectModel({downloadError:[i],downloadSize:Number,downloading:[Boolean],installState:String,manifest:[Object],manifestURL:String,progress:[Number],removable:Boolean,updateManifest:[Object]});exports.BookmarkApp=o,exports.NormalApp=a,exports.Bookmark=s,exports.MozApp=u},function(e,exports){"use strict";function t(e){return JSON.parse(JSON.stringify(e))}function n(e){return e.split("").reduce(function(e,t){return e=(e<<5)-e+t.charCodeAt(0),e&e},0)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.simpleObject=t,exports.hashCode=n},function(e,exports,t){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=t(36),d=r(f),p=t(3),h=t(9),v=t(11),m=t(1),g=t(35),y=r(g),b=t(31),w=n(b),_=t(12),S=r(_),E=["OSlAbgrhLArfT7grf4_N"],k=31457280,A=function(e){function t(){o(this,t);var e=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.resetProgressTimer=function(){e.progressTimer&&clearInterval(e.progressTimer),e.progressTimer=null},e.launchAppByManifestURL=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};console.warn("[AppStore] launchAppByManifestURL:",t,", getInstalledApps():",c(e.getInstalledApps())),"undefined"!=typeof e.getInstalledApps()?e.getInstalledApps().then(function(r){var i=r.get(t);i?(i.launch(),e.pushDataForDelayLaunch=null):(console.error("Can't launch. App not found for manifestURL: "+t),y.default.showDetailPageFromPush(n))}):e.pushDataForDelayLaunch=n},e.uninstallAppByManifestURL=function(t){e.getInstalledApps().then(function(e){var n=e.get(t);return n?void w.uninstall(n):void console.error("Can't uninstall. App not found for manifestURL: "+t)})},e.installAppByManifestURL=function(e,t){return w.installAppByManifestURL(e,t)},e.handleInstallEvent=function(t){var n=t.application;e.handleInstall(n)},e.handleInstall=function(t){var n=w.getRemoteManifestURL(t);e.mozApps.installing[n]=t,e._handlePendingCancelDownload(n,t);var r={manifestURL:n,mozAppsEvent:p.mozAppsEvents.INSTALL,mozApp:t};if("installed"===t.installState){var i=new v.MozAppUpdateCommand({detail:r});return h.MessageSender.send(i),void e.handleDownloadSuccess(t)}t.ondownloadapplied=function(){delete e.mozApps.installing[n],r.mozAppEvent=p.mozAppEvent.ON_DOWNLOAD_APPLIED;var i=new v.MozAppUpdateCommand({detail:r});h.MessageSender.send(i),e.handleDownloadSuccess(t)},t.ondownloaderror=function(){delete e.mozApps.installing[n],r.mozAppEvent=p.mozAppEvent.ON_DOWNLOAD_ERROR;var t=new v.MozAppUpdateCommand({detail:r});h.MessageSender.send(t)},t.onprogress=function(){r.mozAppEvent=p.mozAppEvent.ON_PROGRESS;var e=new v.MozAppUpdateCommand({detail:r});h.MessageSender.send(e)}},e.handleUninstallEvent=function(t){var n=t.application,r=w.getRemoteManifestURL(n);e.mozApps.installed.delete(r);var i=new v.MozAppUpdateCommand({detail:{manifestURL:r,mozAppsEvent:p.mozAppsEvents.UNINSTALL,mozApp:n}});h.MessageSender.send(i);var o={manifestURL:n.manifestURL};e.saveAppStatus("remove",o)},e.handleUpdateEvent=function(t){var n=t.application;if(n){var r=e._getAppID(n.manifestURL);r===p.internalApps.PAYMENT&&(S.default.isUpdated=!0),e.isKaiStore(r)&&window.dispatchEvent(new CustomEvent("self-updated"))}},e.setExitLock=function(e){(0,m.sendIACMessageToSystem)({isUpdatingSystemApp:e})},e.checkSpace=function(e){var t=function(){new MozActivity({name:"configure",data:{target:"device",section:"applicationStorage"}})},n=e===p.validStorageSections.UPDATE?"storage-full-dialog-content":"storage-full-download-dialog-content",r=new CustomEvent("dialog:show",{detail:{options:{header:"storage-full-dialog-header",type:"confirm",ok:"storage-full-dialog-btn",content:n,onOk:t}}});return new Promise(function(e,t){navigator.getDeviceStorage("apps").freeSpace().then(function(t){e(t>=k),t<k&&window.dispatchEvent(r)}).catch(function(e){console.warn("fail to get free space",e),t(e)})})},e._getAppID=function(e){return/[^\/]*$/.exec(e)[0]},e.init=function(){e.remoteApps=[],e.internalApps=[],e.preloadedApps=[],e._bookmarks=[],e.mozApps={installed:new Map,installing:{},pendingCancelDownload:{}},e.rebootNeeded=!1,e.progressTimer=null,e.pushDataForDelayLaunch=null},e.init(),e.bookmarksListener(),e}return s(t,e),l(t,[{key:"getInstalledApps",value:function(){return this.mozApps.installed.size>0?Promise.resolve(this.mozApps.installed):this.getInstalledAppsPromise}},{key:"start",value:function(){var e=this;performance.mark("GET_INSTALLED_APPS_START"),this.getInstalledAppsPromise=w.getInstalledApps().then(function(t){var n=t.map(function(t){var n=w.getRemoteManifestURL(t);return t.downloading&&e.handleInstall(t),[n,t]});return e.mozApps.installed=new Map(n),e.mozApps.installed}),this.getInstalledAppsPromise.then(function(){if(e.syncInstalledApps(e.mozApps.installed),performance.mark("GET_INSTALLED_APPS_END"),e.checkPreloadedAppUpdate(),e.pushDataForDelayLaunch){var t=e.pushDataForDelayLaunch,n=t.manifestURL;e.launchAppByManifestURL(n,t)}}),this.startEventListeners()}},{key:"startEventListeners",value:function(){navigator.mozApps.mgmt.addEventListener("install",this.handleInstallEvent),navigator.mozApps.mgmt.addEventListener("uninstall",this.handleUninstallEvent),navigator.mozApps.mgmt.addEventListener("update",this.handleUpdateEvent)}},{key:"removeEventListeners",value:function(){navigator.mozApps.mgmt.removeEventListener("install",this.handleInstallEvent),navigator.mozApps.mgmt.removeEventListener("uninstall",this.handleUninstallEvent),navigator.mozApps.mgmt.removeEventListener("update",this.handleUpdateEvent)}},{key:"isKaiStore",value:function(e){return Object.values(p.kaistoreApps).includes(e)}},{key:"checkPreloadedAppUpdate",value:function(){var e=this;performance.mark("CHECK_PRELOAD_UPDATE_START"),this.preloadedApps.forEach(function(t){e.forceUpdate(t)}),performance.mark("CHECK_PRELOAD_UPDATE_END")}},{key:"resetStore",value:function(){this.init(),this.removeEventListeners()}},{key:"bookmarksListener",value:function(){var e=window.BookmarksDatabase,t=function(e,t){var n=e.target.id,r=new v.BookmarkUpdateCommand({detail:{pin:t,url:n}});h.MessageSender.send(r)};e.addEventListener("added",function(e){t(e,!0)}),e.addEventListener("removed",function(e){t(e,!1)})}},{key:"syncInstalledApps",value:function(e){var t=this;if(0!==e.size){var n=this.getUpdatableApps(e),r=n.remote,i=n.core;r.forEach(function(n){var r=n.manifestURL,i=t._getAppID(r),o=e.get(r);if(o)switch(i){case p.internalApps.PAYMENT:S.default.checkIfKaiPayUpdated(o),o.checkForUpdate();break;case p.internalApps.EVENT_LOGGER:o.checkForUpdate();break;default:o.checkForUpdate(!1)}}),i.forEach(function(e){e.checkForUpdate(!1)}),e.forEach(function(e){var n=t._getAppID(e.manifestURL);E.indexOf(n)>=0&&t.preloadedApps.push(e)})}}},{key:"getUpdatableApps",value:function(e){var t=[],n=[];return e.forEach(function(e){e.manifestURL.startsWith("https://")?t.push(e):e.manifestURL.startsWith("app://")&&e.manifest.updateURL&&n.push(e)}),{remote:t,core:n}}},{key:"syncBookmarks",value:function(){var e=this;return new Promise(function(t){var n=window.BookmarksDatabase,r=new Map;n.getAll().then(function(n){Object.keys(n).forEach(function(e){r.set(e,n[e])}),e.bookmarks.forEach(function(e){var t=e.url;e.pinStatus=!1,r.has(t)&&(e.pinStatus=!0)}),t({bookmarkDBSupported:!0})},function(e){t({bookmarkDBSupported:!1})})})}},{key:"checkUpdateForInstalledApps",value:function(){var e=this;[].concat(i(this.mozApps.installed.keys())).forEach(function(t){t.startsWith("https://")&&e.checkUpdate(t)})}},{key:"checkUpdate",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.mozApps.installed.get(e);if(r){var i={manifestURL:e,mozAppsEvent:p.mozAppsEvents.UPDATE,mozApp:r};r.ondownloadavailable=function(){i.mozAppEvent=p.mozAppEvent.ON_DOWNLOAD_AVAILABLE;var e=new v.MozAppUpdateCommand({detail:i});h.MessageSender.send(e)},r.ondownloadsuccess=function(){t.handleDownloadSuccess(r),i.mozAppEvent=p.mozAppEvent.ON_DOWNLOAD_SUCCESS;var e=new v.MozAppUpdateCommand({detail:i});h.MessageSender.send(e);var n={version:r.manifest.version,manifestURL:r.manifestURL};t.saveAppStatus("add",n)},r.ondownloadapplied=function(){i.mozAppEvent=p.mozAppEvent.ON_DOWNLOAD_APPLIED;var e=new v.MozAppUpdateCommand({detail:i});h.MessageSender.send(e)},r.ondownloaderror=function(){i.mozAppEvent=p.mozAppEvent.ON_DOWNLOAD_ERROR;var e=new v.MozAppUpdateCommand({detail:i});h.MessageSender.send(e)},r.checkForUpdate(n)}}},{key:"forceUpdate",value:function(e){var t=this;e&&(e.ondownloadavailable=function(){t.publish("appstore:updatable",{application:e})},e.checkForUpdate(!1))}},{key:"forceIntsall",value:function(e){m.utils.showToastMsg("force-updating-tips",{appName:e.manifest.name}),e.download(),e.ondownloadapplied=function(){}}},{key:"handleUpdate",value:function(e){var t=this,n=this.mozApps.installed.get(e);if(!n)return!1;n.manifest&&n.manifest.core&&this.setExitLock(!0);var r={manifestURL:e,mozAppsEvent:p.mozAppsEvents.UPDATE,mozApp:n};return n.ondownloadapplied=function(){n.manifest.reboot&&(t.rebootNeeded=!0),r.mozAppEvent=p.mozAppEvent.ON_DOWNLOAD_APPLIED;var e=new v.MozAppUpdateCommand({detail:r});h.MessageSender.send(e)},n.ondownloaderror=function(e){r.mozAppEvent=p.mozAppEvent.ON_DOWNLOAD_ERROR;var t=new v.MozAppUpdateCommand({detail:r});h.MessageSender.send(t)},n.onprogress=function(){r.mozAppEvent=p.mozAppEvent.ON_PROGRESS;var e=new v.MozAppUpdateCommand({detail:r});h.MessageSender.send(e)},n.download(),!0}},{key:"handleDownloadSuccess",value:function(e){var t=w.getRemoteManifestURL(e);this.mozApps.installed.set(t,e);var n={version:e.manifest.version,manifestURL:e.manifestURL};this.saveAppStatus("add",n)}},{key:"lockAppStatus",value:function(e,t,n){e[t]=n,this.publish("appstore:change")}},{key:"saveAppStatus",value:function(e,t){var n=this;switch(e){case"add":asyncStorage.getItem(t.manifestURL,function(e){null===e&&asyncStorage.setItem(t.manifestURL,t.version)});break;case"remove":asyncStorage.getItem(t.manifestURL,function(e){e&&asyncStorage.removeItem(t.manifestURL,function(){t.messageOption&&n.publish("appstore:change",u({type:"request-toast"},t.messageOption))})})}}},{key:"cancelDownload",value:function(e){var t=this.mozApps.installing[e];t?t.cancelDownload():this.mozApps.pendingCancelDownload[e]=!0}},{key:"_handlePendingCancelDownload",value:function(e,t){this.mozApps.pendingCancelDownload[e]&&(t.cancelDownload(),delete this.mozApps.pendingCancelDownload[e])}},{key:"bookmarks",get:function(){return this._bookmarks}}]),t}(d.default);exports.default=A=new A},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(i,o){try{var a=t[i](o),s=a.value}catch(u){return void n(u)}return a.done?void e(s):Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)})}return r("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=t(8),u=n(s),c=t(7),l=n(c),f=t(18),d=n(f),p=t(34),h=n(p),v=t(10),m={ADVERTISEMENT:"advertisement",APP_PUSH_CAMPAIGN:"app_push_campaign"},g={STORE_OPEN_INIT:"store_open_init",STORE_OPEN_DONE:"store_open_done"},y=function(){function e(){var t=this;i(this,e),this.saveStoreOpenEvent=function(e){e.evtName===g.STORE_OPEN_INIT&&(t.launchByActivity.storeOpenInit=o({},e))},this._composeLogInfo=function(e,n){var r=o({},e,{store_version:l.default.storeVersion,connection_type:t.setConnectionType,device_utc:null===n?Date.now():n});return null!==d.default.accountId&&(r.account_id=d.default.accountId),r},this.handleEventQueue=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=e.event_name,i=t._composeLogInfo(e,n),o=void 0!==t.eventQueue[g.STORE_OPEN_INIT];r===g.STORE_OPEN_INIT?t.postData(i):r===g.STORE_OPEN_DONE&&o?(t.postData(i),delete t.eventQueue[g.STORE_OPEN_INIT]):r.startsWith("store_push_registration")&&t.postData(i)},this.postData=function(e){var n=window.deviceInfos.get("apps.analyticsEventBaseUrl"),r=n+"/"+t.apiName;u.default.getRequester({serverTimeOffset:window.serverTimeOffset,deviceInfos:window.deviceInfos,setDeviceInfo:!0}).send({url:r,method:"POST",params:e}).then(function(){},function(e){throw e})},this.postStoreOpenEvent=function(){var e=r(regeneratorRuntime.mark(function e(n){var r,i,a,s,u,c,l,f,d,p,m,y,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,w=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},i=null!==b,a=i?"init":"done",s=t.launchByActivity["storeOpen"+r(a)],u=s&&s.triggerType,c=s&&s.evtUtc,l={event_name:g["STORE_OPEN_"+a.toUpperCase()]},f=c||n,!i){e.next=26;break}if(void 0===t.eventQueue[g.STORE_OPEN_INIT]){e.next=11;break}return e.abrupt("return");case 11:return t.eventQueue[g.STORE_OPEN_INIT]=l,e.next=14,h.default.getConfigFromCache();case 14:d=e.sent,p=t._getExperimentFields(d),l.experiment_id=p.id,l.experiment_variant_name=p.variantName,l.experiment_bucket_id=p.bucketId,l.experiment_type=p.type,l.experiment_version_requested=p.version,""!==t.referralMeta.referralType&&(m=t._getReferralInfo(),l=o({},l,m)),l.store_launch_state=b,l.trigger_type=w||u||v.TRIGGER_TYPE.MOZ_APP_LAUNCH,e.next=28;break;case 26:y=h.default.errorInfo,y&&(l.error_detail=h.default.errorInfo);case 28:t.handleEventQueue(l,f),t._initializeLaunchByActivityMeta();case 30:case"end":return e.stop()}},e,t)}));return function(t){return e.apply(this,arguments)}}(),this.postPushRegistrationEvent=function(){var e=r(regeneratorRuntime.mark(function e(n){var r,i,o,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=a.err,i=a.type,o={event_name:"store_push_registration_"+n},i&&(o.trigger_type=i),r&&(o.error_detail=r),t.handleEventQueue(o);case 5:case"end":return e.stop()}},e,t)}));return function(t){return e.apply(this,arguments)}}(),this._getExperimentFields=function(e){var t={id:"",variantName:"",bucketId:"",version:"",type:""};if(e){var n=e.config,r=e.params;n&&(t.id=n.experiment_id,t.variantName=n.variant&&n.variant.name,t.bucketId=n.bucket_id,t.version=n.version),r&&(t.type=r.experimentType)}return t},this._getReferralInfo=function(){var e={};if(t.referralMeta.referralType===m.ADVERTISEMENT)e.referral_type=t.referralMeta.referralType,e.referral_ad_request_id=t.referralMeta.data.adRequestId;else if(t.referralMeta.referralType===m.APP_PUSH_CAMPAIGN){var n=t.referralMeta.data,r=n.pushCsId,i=n.pushCmpId,o=n.manifestURL;e.referral_type=t.referralMeta.referralType,e.referral_push_cs_id=r,e.referral_push_campaign_id=i,e.referral_push_manifest_url=o}return t._initializeReferralMeta(),e},this.apiName="store",this._initializeReferralMeta(),this._initializeLaunchByActivityMeta(),this.setConnectionType="wifi",this.eventQueue={}}return a(e,[{key:"init",value:function(){var e=window.deviceInfos.get("ril.data.defaultServiceId");this.setConnectionType=l.default.connectionType(e)}},{key:"saveReferralMeta",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.ad_request_id?(this.referralMeta.referralType=m.ADVERTISEMENT,this.referralMeta.data.adRequestId=e.ad_request_id):e.cs_id&&(e.token&&this._getPushCampaignId(e.token),this.referralMeta.referralType=m.APP_PUSH_CAMPAIGN,this.referralMeta.data.manifestURL=e.manifestURL,this.referralMeta.data.pushCsId=e.cs_id)}},{key:"_initializeReferralMeta",value:function(){this.referralMeta={referralType:"",data:{adRequestId:"",pushCsId:"",pushCmpId:"",manifestURL:""}}}},{key:"_initializeLaunchByActivityMeta",value:function(){this.launchByActivity={storeOpenInit:{}}}},{key:"_getPushCampaignId",value:function(e){var t=JSON.parse(e),n=t.access_token;if(n){var r=n.split(".")[1],i=r.replace(/-/g,"+").replace(/_/g,"/"),o=decodeURIComponent(atob(i).split("").map(function(e){return"%"+e.charCodeAt(0).toString(16).slice(-2)}).join("")),a=JSON.parse(o);this.referralMeta.data.pushCmpId=a.campaign_id||""}}}]),e}(),b=new y;exports.default=b},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=t(11),a=t(3),s=t(9),u=t(8),c=n(u),l=t(32),f=t(12),d=n(f),p=function(){function e(){var t=this;r(this,e),this._postAccountEvent=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new o.AccountEventCommand({detail:{event:e,data:t}});s.MessageSender.send(n)},this.checkAccountId=function(){return new Promise(function(e,n){if(!t.isAccountToken||null!==t.accountId)return void e();var r=window.deviceInfos.get("identity.kaiaccounts.api.uri"),i="/core/v2.0/accounts/me",o=r+i;c.default.getRequester({serverTimeOffset:window.serverTimeOffset,deviceInfos:window.deviceInfos}).send({url:o,method:"GET"}).then(function(n){var r=JSON.parse(n);r&&r.id&&(t.accountId=r.id),e()}).catch(function(e){console.error("account requester: "+e.statusText),n(e)})})},this.ready=function(e){t.isAccountReady?e():t.onReadyCallbacks.push(e)},this.isInitialized=!1,this.accountVersion=null,this.token=null,this.deviceTokenPromise=null,this.accountId=null,this.isAccountReady=!1,this.onReadyCallbacks=[]}return i(e,[{key:"initAccount",value:function(){var e=this;if(!this.isInitialized)return this.isInitialized=!0,navigator.mozId?void this.getAccountVersion().then(function(t){return t?void navigator.mozId.watch({wantIssuer:"kaios-accounts",onlogin:function(t){if(!d.default.isKaiPayRunning){var n=JSON.parse(t),r=e.token||{},i=r.kid,o=r.macKey,s=n.kid!==i||n.mac_key!==o;e.setToken({kid:n.kid,macKey:n.mac_key,type:a.tokenType.ACCOUNT}),s&&(console.warn("navigator.mozId:onlogin",n),window.deviceInfos&&e.isAccountReady&&e.checkAccountId(),e._postAccountEvent(a.accountEvent.ON_LOGIN))}},onlogout:function(){var t=null===e.token;e.setToken(null),e.accountId=null,e._postAccountEvent(a.accountEvent.ON_LOGOUT),t||(console.warn("navigator.mozId:onlogout"),e.getToken(!0))},onready:function(){e._setAccountReady()},onerror:function(t){e._postAccountEvent(a.accountEvent.ON_LOGOUT,t)}}):void e._setAccountReady()}):void this._postAccountEvent(a.accountEvent.ON_ACCOUNT_API_MISSING)}},{key:"refreshAccountToken",value:function(){this.isAccountToken&&navigator.mozId.request()}},{key:"_handleAccountReady",value:function(){this.isAccountReady=!0;var e=new CustomEvent("account-ready");for(window.dispatchEvent(e);this.onReadyCallbacks.length>0;){this.onReadyCallbacks.shift()()}}},{key:"_setAccountReady",value:function(){this._postAccountEvent(a.accountEvent.ON_READY),this._handleAccountReady(),performance.mark("INIT_ACCOUNT_END")}},{key:"openAccount",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"accounts",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=new MozActivity({name:"configure",data:{target:"device",section:e}});r.onsuccess=t,r.onerror=n}},{key:"getAccountVersion",value:function(){var e=this,t="kaiaccount.version",n=SettingsHelper(t,null);return new Promise(function(t){return navigator.mozId?e.accountVersion?void t(e.accountVersion):void n.get(function(n){var r=n||null;e.accountVersion=r,t(r)}):void t(null)})}},{key:"getDeviceToken",value:function(){return navigator.kaiAuth.getRestrictedToken("apps").then(function(e){return asyncStorage.setItem(l.CACHE_DATA.TOKEN.KEY,{timestamp:Date.now(),isCached:!0,expiryTime:.9*e.expiresInSeconds*1e3,token:e}),e})}},{key:"setDeviceTokenPromise",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.deviceTokenPromise=new Promise(function(n){"true"===localStorage.forceRefetch||t===!0?n(e.getDeviceToken()):asyncStorage.getItem(l.CACHE_DATA.TOKEN.KEY,function(t){n(t&&t.isCached&&t.token?t.token:e.getDeviceToken())})})}},{key:"setToken",value:function(e){if(null!==e){var t=this.token;e.kid!==(t&&t.kid)&&c.default.setToken(e.kid,e.macKey)}this.token=e}},{key:"getToken",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.isAccountToken||this.token&&t===!1?Promise.resolve(this.token):new Promise(function(n,r){null!==e.deviceTokenPromise&&t!==!0||e.setDeviceTokenPromise(t),e.deviceTokenPromise.then(function(t){e.setToken({kid:t.kid,macKey:t.macKey,type:a.tokenType.RESTRICTED}),n(e.token)}).catch(function(e){console.warn("failed to fetch token",e),r(e)})})}},{key:"isAccountToken",get:function(){return Boolean(this.token&&this.token.type===a.tokenType.ACCOUNT)}}]),e}();exports.default=new p},function(e,exports){"use strict";function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var n=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),r=function(){function e(){var n=this;t(this,e),this.handleDataChange=function(){var e=n.status;return e.cellular&&!n.isDataConnected?(n.setCurrentStatus(!1,!1),void n.onNetworkStatusChange(!1)):void(!e.cellular&&n.isDataConnected&&(n.setCurrentStatus(!1,!0),n.onNetworkStatusChange(!0)))},this.handleWifiHasInternet=function(){var e=n.status;e.cellular||e.wifi||(n.setCurrentStatus(!0,!1),n.onNetworkStatusChange(!0))},this.handleWifiDisabled=function(){var e=n.status;!e.cellular&&e.wifi&&(n.setCurrentStatus(!1,!1),n.onNetworkStatusChange(!1))},this.status={cellular:this.isDataConnected,wifi:this.isWifiConnected}}return n(e,[{key:"setCurrentStatus",value:function(e,t){var n={cellular:t,wifi:e};this.status=n}},{key:"addEventListeners",value:function(){var e=this,t=navigator.mozMobileConnections||[],n=navigator.mozWifiManager;t&&Array.from(t).forEach(function(t){t.addEventListener("datachange",e.handleDataChange)}),n&&(n.addEventListener("wifihasinternet",this.handleWifiHasInternet),n.addEventListener("disabled",this.handleWifiDisabled))}},{key:"onNetworkStatusChange",value:function(e){var t=new CustomEvent("networkstatuschange",{detail:{online:e}});window.dispatchEvent(t)}},{key:"isWifiConnected",get:function(){var e=this,t=window.navigator.mozWifiManager,n=function(){var n=t.connection.network&&t.connection.network.hasInternet,r=!e.isDataConnected&&navigator.onLine;return console.warn("[hasInternetOnline] mozWifiManager.connection.network.hasInternet: "+n),console.warn("[hasInternetOnline] this.isDataConnected: "+e.isDataConnected),console.warn("[hasInternetOnline] navigator.onLine: "+navigator.onLine),n||r};return t&&t.connection&&"connected"===t.connection.status&&t.hasInternet||n()}},{key:"isDataConnected",get:function(){var e=navigator.mozMobileConnections||[];return!!Array.prototype.find.call(e,function(e){return e.iccId&&e.data&&e.data.connected})}},{key:"online",get:function(){return this.isDataConnected||this.isWifiConnected}}]),e}();exports.default=r=new r},function(e,exports){"use strict";function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var n=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),r=function(){function e(){var n=this;t(this,e),this.mountComponent=function(e,t){t&&(n.softkey||(n.softkey=document.querySelector("#softkeyPanel")),n.displayed.push({key:e,value:t}),t.focus(),n.softkey.classList.remove("hidden"))},this.unmountComponent=function(e){var t=n.displayed.findIndex(function(t){return t.key===e});return n.displayed.splice(t,1),n.nextComponent},this.focusIframe=function(){var e=document.querySelector("iframe");e&&!n.focusLock?(document.activeElement.blur(),e.focus()):n.nextComponent&&n.nextComponent.focus()},this.hideLoading=function(){return new Promise(function(e){var t=document.getElementById("ssr"),r=document.querySelector("iframe"),i=document.querySelector("#dialog");t.classList.add("hidden"),r&&r.classList.remove("hidden"),requestAnimationFrame(function(){i&&!i.classList.contains("hidden")||n.focusIframe(),e()})})},this.toggleRebootPanel=function(e){var t=e.visible,r=e.isInPaymentProcess,i=void 0!==r&&r,o=e.isUpgradeCAProcess,a=void 0!==o&&o;n._broadcast("rebootPanel:toggle",{visible:t,isInPaymentProcess:i,isUpgradeCAProcess:a})},this.toggleUpdatePanel=function(){n._broadcast("updatePanel:toggle",{visible:!0})},this._broadcast=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=new CustomEvent(e,{detail:t});window.dispatchEvent(n)},this.displayed=[],this.softkey=null}return n(e,[{key:"isElementHidden",value:function(e){var t=document.querySelector("#"+e);return!t||t.classList.contains("hidden")}},{key:"focusLock",get:function(){return this.displayed.length>0}},{key:"nextComponent",get:function(){var e=this.displayed.length,t=this.displayed[e-1];return t&&t.value?t.value:null}}]),e}();exports.default=r=new r},function(e,exports){"use strict";function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e){if(!e||"string"!=typeof e)throw new Error("Event name should be a valid non-empty string!")}function r(e){if("function"!=typeof e)throw new Error("Handler should be a function!")}Object.defineProperty(exports,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){t(this,e),this.listeners=new Map}return i(e,[{key:"on",value:function(e,t){n(e),r(t);var i=this.listeners.get(e);i||(i=new Set,this.listeners.set(e,i)),i.add(t)}},{key:"off",value:function(e,t){n(e),r(t);var i=this.listeners.get(e);i&&(i.delete(t),i.size||this.listeners.delete(e))}},{key:"offAll",value:function(e){if("undefined"==typeof e)return void this.listeners.clear();n(e);var t=this.listeners.get(e);t&&(t.clear(),this.listeners.delete(e))}},{key:"emit",value:function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];n(e);var o=this.listeners.get(e);o&&o.forEach(function(e){try{e.apply(null,r)}catch(t){console.error(t)}})}}]),e}();exports.default=o},function(e,exports,t){(function(e,n){"use strict";function r(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(t){return!1}}function i(){return e.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(t,n){if(i()<n)throw new RangeError("Invalid typed array length");return e.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(n),t.__proto__=e.prototype):(null===t&&(t=new e(n)),t.length=n),t}function e(t,n,r){if(!(e.TYPED_ARRAY_SUPPORT||this instanceof e))return new e(t,n,r);if("number"==typeof t){if("string"==typeof n)throw new Error("If encoding is specified then the first argument must be a string");return c(this,t)}return a(this,t,n,r)}function a(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?d(e,t,n,r):"string"==typeof t?l(e,t,n):p(e,t)}function s(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function u(e,t,n,r){return s(t),t<=0?o(e,t):void 0!==n?"string"==typeof r?o(e,t).fill(n,r):o(e,t).fill(n):o(e,t)}function c(t,n){if(s(n),t=o(t,n<0?0:0|h(n)),!e.TYPED_ARRAY_SUPPORT)for(var r=0;r<n;++r)t[r]=0;return t}function l(t,n,r){if("string"==typeof r&&""!==r||(r="utf8"),!e.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var i=0|m(n,r);t=o(t,i);var a=t.write(n,r);return a!==i&&(t=t.slice(0,a)),t}function f(e,t){var n=t.length<0?0:0|h(t.length);e=o(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function d(t,n,r,i){if(n.byteLength,r<0||n.byteLength<r)throw new RangeError("'offset' is out of bounds");if(n.byteLength<r+(i||0))throw new RangeError("'length' is out of bounds");return n=void 0===r&&void 0===i?new Uint8Array(n):void 0===i?new Uint8Array(n,r):new Uint8Array(n,r,i),e.TYPED_ARRAY_SUPPORT?(t=n,t.__proto__=e.prototype):t=f(t,n),t}function p(t,n){if(e.isBuffer(n)){var r=0|h(n.length);return t=o(t,r),0===t.length?t:(n.copy(t,0,0,r),t)}if(n){if("undefined"!=typeof ArrayBuffer&&n.buffer instanceof ArrayBuffer||"length"in n)return"number"!=typeof n.length||Q(n.length)?o(t,0):f(t,n);if("Buffer"===n.type&&Z(n.data))return f(t,n.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function h(e){if(e>=i())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i().toString(16)+" bytes");return 0|e}function v(t){return+t!=t&&(t=0),e.alloc(+t)}function m(t,n){if(e.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var r=t.length;if(0===r)return 0;for(var i=!1;;)switch(n){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return q(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return Y(t).length;default:if(i)return q(t).length;n=(""+n).toLowerCase(),i=!0}}function g(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if(n>>>=0,t>>>=0,n<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return M(this,t,n);case"utf8":case"utf-8":return O(this,t,n);case"ascii":return P(this,t,n);case"latin1":case"binary":return R(this,t,n);case"base64":return T(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function y(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function b(t,n,r,i,o){if(0===t.length)return-1;if("string"==typeof r?(i=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=o?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(o)return-1;r=t.length-1}else if(r<0){if(!o)return-1;r=0}if("string"==typeof n&&(n=e.from(n,i)),e.isBuffer(n))return 0===n.length?-1:w(t,n,r,i,o);if("number"==typeof n)return n=255&n,e.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,n,r):Uint8Array.prototype.lastIndexOf.call(t,n,r):w(t,[n],r,i,o);throw new TypeError("val must be string, number or Buffer")}function w(e,t,n,r,i){function o(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}var a=1,s=e.length,u=t.length;if(void 0!==r&&(r=String(r).toLowerCase(),"ucs2"===r||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,s/=2,u/=2,n/=2}var c;if(i){var l=-1;for(c=n;c<s;c++)if(o(e,c)===o(t,l===-1?0:c-l)){if(l===-1&&(l=c),c-l+1===u)return l*a}else l!==-1&&(c-=c-l),l=-1}else for(n+u>s&&(n=s-u),c=n;c>=0;c--){for(var f=!0,d=0;d<u;d++)if(o(e,c+d)!==o(t,d)){f=!1;break}if(f)return c}return-1}function _(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r),r>i&&(r=i)):r=i;var o=t.length;if(o%2!==0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var a=0;a<r;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[n+a]=s}return a}function S(e,t,n,r){return W(q(t,e.length-n),e,n,r)}function E(e,t,n,r){return W(V(t),e,n,r)}function k(e,t,n,r){return E(e,t,n,r)}function A(e,t,n,r){return W(Y(t),e,n,r)}function C(e,t,n,r){return W(G(t,e.length-n),e,n,r)}function T(e,t,n){return 0===t&&n===e.length?J.fromByteArray(e):J.fromByteArray(e.slice(t,n))}function O(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o=e[i],a=null,s=o>239?4:o>223?3:o>191?2:1;if(i+s<=n){var u,c,l,f;switch(s){case 1:o<128&&(a=o);break;case 2:u=e[i+1],128===(192&u)&&(f=(31&o)<<6|63&u,f>127&&(a=f));break;case 3:u=e[i+1],c=e[i+2],128===(192&u)&&128===(192&c)&&(f=(15&o)<<12|(63&u)<<6|63&c,f>2047&&(f<55296||f>57343)&&(a=f));break;case 4:u=e[i+1],c=e[i+2],l=e[i+3],128===(192&u)&&128===(192&c)&&128===(192&l)&&(f=(15&o)<<18|(63&u)<<12|(63&c)<<6|63&l,f>65535&&f<1114112&&(a=f))}}null===a?(a=65533,s=1):a>65535&&(a-=65536,r.push(a>>>10&1023|55296),a=56320|1023&a),r.push(a),i+=s}return I(r)}function I(e){var t=e.length;if(t<=ee)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=ee));return n}function P(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function R(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function M(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=t;o<n;++o)i+=K(e[o]);return i}function L(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function U(e,t,n){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function N(t,n,r,i,o,a){if(!e.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(n>o||n<a)throw new RangeError('"value" argument is out of bounds');if(r+i>t.length)throw new RangeError("Index out of range")}function D(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-n,2);i<o;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function x(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-n,4);i<o;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function j(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function B(e,t,n,r,i){return i||j(e,t,n,4,3.4028234663852886e38,-3.4028234663852886e38),X.write(e,t,n,r,23,4),n+4}function F(e,t,n,r,i){return i||j(e,t,n,8,1.7976931348623157e308,-1.7976931348623157e308),X.write(e,t,n,r,52,8),n+8}function z(e){if(e=H(e).replace(te,""),e.length<2)return"";for(;e.length%4!==0;)e+="=";return e}function H(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function K(e){return e<16?"0"+e.toString(16):e.toString(16)}function q(e,t){t=t||1/0;for(var n,r=e.length,i=null,o=[],a=0;a<r;++a){if(n=e.charCodeAt(a),n>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=(i-55296<<10|n-56320)+65536}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function V(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}function G(e,t){for(var n,r,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)n=e.charCodeAt(a),r=n>>8,i=n%256,o.push(i),o.push(r);return o}function Y(e){return J.toByteArray(z(e))}function W(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function Q(e){return e!==e}var J=t(37),X=t(40),Z=t(41);exports.Buffer=e,exports.SlowBuffer=v,exports.INSPECT_MAX_BYTES=50,e.TYPED_ARRAY_SUPPORT=void 0!==n.TYPED_ARRAY_SUPPORT?n.TYPED_ARRAY_SUPPORT:r(),exports.kMaxLength=i(),e.poolSize=8192,e._augment=function(t){return t.__proto__=e.prototype,t},e.from=function(e,t,n){return a(null,e,t,n)},e.TYPED_ARRAY_SUPPORT&&(e.prototype.__proto__=Uint8Array.prototype,e.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&e[Symbol.species]===e&&Object.defineProperty(e,Symbol.species,{value:null,configurable:!0})),e.alloc=function(e,t,n){return u(null,e,t,n)},e.allocUnsafe=function(e){return c(null,e)},e.allocUnsafeSlow=function(e){return c(null,e)},e.isBuffer=function(e){return!(null==e||!e._isBuffer)},e.compare=function(t,n){if(!e.isBuffer(t)||!e.isBuffer(n))throw new TypeError("Arguments must be Buffers");if(t===n)return 0;for(var r=t.length,i=n.length,o=0,a=Math.min(r,i);o<a;++o)if(t[o]!==n[o]){r=t[o],i=n[o];break}return r<i?-1:i<r?1:0},e.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},e.concat=function(t,n){if(!Z(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return e.alloc(0);var r;if(void 0===n)for(n=0,r=0;r<t.length;++r)n+=t[r].length;var i=e.allocUnsafe(n),o=0;for(r=0;r<t.length;++r){var a=t[r];if(!e.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(i,o),o+=a.length}return i},e.byteLength=m,e.prototype._isBuffer=!0,e.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)y(this,t,t+1);return this},e.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},e.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},e.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?O(this,0,e):g.apply(this,arguments)},e.prototype.equals=function(t){if(!e.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===e.compare(this,t)},e.prototype.inspect=function(){var e="",t=exports.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"},e.prototype.compare=function(t,n,r,i,o){if(!e.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===n&&(n=0),void 0===r&&(r=t?t.length:0),void 0===i&&(i=0),void 0===o&&(o=this.length),n<0||r>t.length||i<0||o>this.length)throw new RangeError("out of range index");if(i>=o&&n>=r)return 0;if(i>=o)return-1;if(n>=r)return 1;if(n>>>=0,r>>>=0,i>>>=0,o>>>=0,this===t)return 0;for(var a=o-i,s=r-n,u=Math.min(a,s),c=this.slice(i,o),l=t.slice(n,r),f=0;f<u;++f)if(c[f]!==l[f]){a=c[f],s=l[f];break}return a<s?-1:s<a?1:0},e.prototype.includes=function(e,t,n){return this.indexOf(e,t,n)!==-1},e.prototype.indexOf=function(e,t,n){return b(this,e,t,n,!0)},e.prototype.lastIndexOf=function(e,t,n){return b(this,e,t,n,!1)},e.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t=0|t,isFinite(n)?(n=0|n,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return _(this,e,t,n);case"utf8":case"utf-8":return S(this,e,t,n);case"ascii":return E(this,e,t,n);case"latin1":case"binary":return k(this,e,t,n);case"base64":return A(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},e.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var ee=4096;e.prototype.slice=function(t,n){var r=this.length;t=~~t,n=void 0===n?r:~~n,t<0?(t+=r,t<0&&(t=0)):t>r&&(t=r),n<0?(n+=r,n<0&&(n=0)):n>r&&(n=r),n<t&&(n=t);var i;if(e.TYPED_ARRAY_SUPPORT)i=this.subarray(t,n),i.__proto__=e.prototype;else{var o=n-t;i=new e(o,(void 0));for(var a=0;a<o;++a)i[a]=this[a+t]}return i},e.prototype.readUIntLE=function(e,t,n){e=0|e,t=0|t,n||U(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},e.prototype.readUIntBE=function(e,t,n){e=0|e,t=0|t,n||U(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},e.prototype.readUInt8=function(e,t){return t||U(e,1,this.length),this[e]},e.prototype.readUInt16LE=function(e,t){return t||U(e,2,this.length),this[e]|this[e+1]<<8},e.prototype.readUInt16BE=function(e,t){return t||U(e,2,this.length),this[e]<<8|this[e+1]},e.prototype.readUInt32LE=function(e,t){return t||U(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},e.prototype.readUInt32BE=function(e,t){return t||U(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},e.prototype.readIntLE=function(e,t,n){e=0|e,t=0|t,n||U(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return i*=128,r>=i&&(r-=Math.pow(2,8*t)),r},e.prototype.readIntBE=function(e,t,n){e=0|e,t=0|t,n||U(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*t)),o},e.prototype.readInt8=function(e,t){return t||U(e,1,this.length),128&this[e]?(255-this[e]+1)*-1:this[e]},e.prototype.readInt16LE=function(e,t){t||U(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},e.prototype.readInt16BE=function(e,t){t||U(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},e.prototype.readInt32LE=function(e,t){return t||U(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},e.prototype.readInt32BE=function(e,t){return t||U(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},e.prototype.readFloatLE=function(e,t){return t||U(e,4,this.length),X.read(this,e,!0,23,4)},e.prototype.readFloatBE=function(e,t){return t||U(e,4,this.length),X.read(this,e,!1,23,4)},e.prototype.readDoubleLE=function(e,t){return t||U(e,8,this.length),X.read(this,e,!0,52,8)},e.prototype.readDoubleBE=function(e,t){return t||U(e,8,this.length),X.read(this,e,!1,52,8)},e.prototype.writeUIntLE=function(e,t,n,r){if(e=+e,t=0|t,n=0|n,!r){N(this,e,t,n,Math.pow(2,8*n)-1,0)}var i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},e.prototype.writeUIntBE=function(e,t,n,r){if(e=+e,t=0|t,n=0|n,!r){N(this,e,t,n,Math.pow(2,8*n)-1,0)}var i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},e.prototype.writeUInt8=function(t,n,r){return t=+t,n=0|n,r||N(this,t,n,1,255,0),e.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[n]=255&t,n+1},e.prototype.writeUInt16LE=function(t,n,r){return t=+t,n=0|n,r||N(this,t,n,2,65535,0),e.TYPED_ARRAY_SUPPORT?(this[n]=255&t,this[n+1]=t>>>8):D(this,t,n,!0),n+2},e.prototype.writeUInt16BE=function(t,n,r){return t=+t,n=0|n,r||N(this,t,n,2,65535,0),e.TYPED_ARRAY_SUPPORT?(this[n]=t>>>8,this[n+1]=255&t):D(this,t,n,!1),n+2},e.prototype.writeUInt32LE=function(t,n,r){return t=+t,n=0|n,r||N(this,t,n,4,4294967295,0),e.TYPED_ARRAY_SUPPORT?(this[n+3]=t>>>24,this[n+2]=t>>>16,this[n+1]=t>>>8,this[n]=255&t):x(this,t,n,!0),n+4},e.prototype.writeUInt32BE=function(t,n,r){return t=+t,n=0|n,r||N(this,t,n,4,4294967295,0),e.TYPED_ARRAY_SUPPORT?(this[n]=t>>>24,this[n+1]=t>>>16,this[n+2]=t>>>8,this[n+3]=255&t):x(this,t,n,!1),n+4},e.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t=0|t,!r){var i=Math.pow(2,8*n-1);N(this,e,t,n,i-1,-i)}var o=0,a=1,s=0;for(this[t]=255&e;++o<n&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},e.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t=0|t,!r){var i=Math.pow(2,8*n-1);N(this,e,t,n,i-1,-i)}var o=n-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},e.prototype.writeInt8=function(t,n,r){return t=+t,n=0|n,r||N(this,t,n,1,127,-128),e.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[n]=255&t,n+1},e.prototype.writeInt16LE=function(t,n,r){return t=+t,n=0|n,r||N(this,t,n,2,32767,-32768),e.TYPED_ARRAY_SUPPORT?(this[n]=255&t,this[n+1]=t>>>8):D(this,t,n,!0),n+2},e.prototype.writeInt16BE=function(t,n,r){return t=+t,n=0|n,r||N(this,t,n,2,32767,-32768),e.TYPED_ARRAY_SUPPORT?(this[n]=t>>>8,this[n+1]=255&t):D(this,t,n,!1),n+2},e.prototype.writeInt32LE=function(t,n,r){return t=+t,n=0|n,r||N(this,t,n,4,2147483647,-2147483648),e.TYPED_ARRAY_SUPPORT?(this[n]=255&t,this[n+1]=t>>>8,this[n+2]=t>>>16,this[n+3]=t>>>24):x(this,t,n,!0),n+4},e.prototype.writeInt32BE=function(t,n,r){return t=+t,n=0|n,r||N(this,t,n,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),e.TYPED_ARRAY_SUPPORT?(this[n]=t>>>24,this[n+1]=t>>>16,this[n+2]=t>>>8,this[n+3]=255&t):x(this,t,n,!1),n+4},e.prototype.writeFloatLE=function(e,t,n){return B(this,e,t,!0,n)},e.prototype.writeFloatBE=function(e,t,n){return B(this,e,t,!1,n)},e.prototype.writeDoubleLE=function(e,t,n){return F(this,e,t,!0,n)},e.prototype.writeDoubleBE=function(e,t,n){return F(this,e,t,!1,n)},e.prototype.copy=function(t,n,r,i){if(r||(r=0),i||0===i||(i=this.length),n>=t.length&&(n=t.length),n||(n=0),i>0&&i<r&&(i=r),i===r)return 0;if(0===t.length||0===this.length)return 0;if(n<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-n<i-r&&(i=t.length-n+r);var o,a=i-r;if(this===t&&r<n&&n<i)for(o=a-1;o>=0;--o)t[o+n]=this[o+r];else if(a<1e3||!e.TYPED_ARRAY_SUPPORT)for(o=0;o<a;++o)t[o+n]=this[o+r];else Uint8Array.prototype.set.call(t,this.subarray(r,r+a),n);return a},e.prototype.fill=function(t,n,r,i){if("string"==typeof t){if("string"==typeof n?(i=n,n=0,r=this.length):"string"==typeof r&&(i=r,r=this.length),1===t.length){var o=t.charCodeAt(0);o<256&&(t=o)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!e.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof t&&(t=255&t);if(n<0||this.length<n||this.length<r)throw new RangeError("Out of range index");if(r<=n)return this;n>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0);var a;if("number"==typeof t)for(a=n;a<r;++a)this[a]=t;else{var s=e.isBuffer(t)?t:q(new e(t,i).toString()),u=s.length;for(a=0;a<r-n;++a)this[a+n]=s[a%u]}return this};var te=/[^+\/0-9A-Za-z-_]/g}).call(exports,t(22).Buffer,function(){return this}())},function(e,exports,t){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var n=t(44);Object.defineProperty(exports,"DeviceInfo",{enumerable:!0,get:function(){return n.DeviceInfo}});var r=t(14);Object.defineProperty(exports,"BookmarkApp",{enumerable:!0,get:function(){return r.BookmarkApp}}),Object.defineProperty(exports,"NormalApp",{enumerable:!0,get:function(){return r.NormalApp}}),Object.defineProperty(exports,"Bookmark",{enumerable:!0,get:function(){return r.Bookmark}}),Object.defineProperty(exports,"MozApp",{enumerable:!0,get:function(){return r.MozApp}});var i=t(27);Object.defineProperty(exports,"Notification",{enumerable:!0,get:function(){return i.Notification}}),Object.defineProperty(exports,"Toast",{enumerable:!0,get:function(){return i.Toast}});var o=t(43);Object.defineProperty(exports,"Token",{enumerable:!0,get:function(){return o.Token}});var a=t(24);Object.defineProperty(exports,"PaymentDetail",{enumerable:!0,get:function(){return a.PaymentDetail}}),Object.defineProperty(exports,"PaymentProfile",{enumerable:!0,get:function(){return a.PaymentProfile}});var s=t(26);Object.defineProperty(exports,"Task",{enumerable:!0,get:function(){return s.Task}});var u=t(25);Object.defineProperty(exports,"Setting",{enumerable:!0,get:function(){return u.Setting}})},function(e,exports,t){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PaymentDetail=exports.PaymentProfile=void 0;var n=t(6),r=new n.ObjectModel({price:Number,currency:String}),i=new n.ObjectModel({id:String,name:String});exports.PaymentProfile=r,exports.PaymentDetail=i},function(e,exports,t){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Setting=void 0;var n=t(6),r=t(3),i=new n.ObjectModel({key:Object.values(r.validSettingKey),value:[Number,String,Boolean,Object]});exports.Setting=i},function(e,exports,t){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Task=void 0;var n=t(6),r=new n.ObjectModel({data:{type:["name","url","push-app",void 0,null],url:[String],name:[String],csId:[String],pixel:[String],action:[String],detail:[Object]},name:String,origin:[String],getFilterResults:Boolean});exports.Task=r},function(e,exports,t){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Toast=exports.Notification=void 0;var n=t(6),r=new n.ObjectModel({title:String,options:Object}),i=new n.ObjectModel({messageL10nId:[String],message:[String],messageL10nArgs:[Object],titleL10nId:[String],title:[String],titleL10nArgs:[Object]});exports.Notification=r,exports.Toast=i},function(e,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t={start:function(){this.settings=window.navigator.mozSettings},_lock:null,_observers:[],debug:function(){!this.DEBUG},getSettingsLock:function(){return this._lock&&!this._lock.closed?this._lock:this._lock=this.settings.createLock()},get:function(e){var t=this;return new Promise(function(n,r){t.debug("reading "+e+" from settings db.");var i=t.getSettingsLock().get(e);i.addEventListener("success",function(){t.debug("...value is "+i.result[e]),n(i.result[e])}),i.addEventListener("error",function(){r()})})},set:function(e){var t=this;return new Promise(function(n,r){t.debug("writing "+JSON.stringify(e)+" to settings db.");var i=t.getSettingsLock(),o=i.set(e);o.addEventListener("success",function(){n()}),o.addEventListener("error",function(){r()})})},addObserver:function(e,t){if(this.debug("adding observer for "+t+" on "+e),t){if(!this.settings)return void window.setTimeout(function(){"observe"in t?t.observe.call(t,e,null):"function"==typeof t&&t(null)});var n=this,r=this.getSettingsLock().get(e);r.addEventListener("success",function(){n.debug("get settings "+e+" as "+r.result[e]),n.debug("now performing the observer in "+t.name),"observe"in t?t.observe.call(t,e,r.result[e]):"function"==typeof t&&t(r.result[e])});var i=function(e){n.debug("observing settings "+e.settingName+" changed to "+e.settingValue),n.debug("now performing the observer in "+t.name),"observe"in t?t.observe.call(t,e.settingName,e.settingValue):"function"==typeof t&&t(e.settingValue)};this.settings.addObserver(e,i),this._observers.push({name:e,context:t,observer:i})}else this.warn("irregular observer "+t.name+", stop oberseving")},removeObserver:function(e,t){var n=this.settings,r=this;this._observers.forEach(function(i,o){i.name===e&&i.context===t&&(n.removeObserver(e,i.observer),r._observers.splice(o,1))})}};t.start(),exports.default=t},function(e,exports,t){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SimpleResult=void 0;var n=t(56),r=new n.ObjectModel({id:String,success:Boolean,detail:[Object]});exports.SimpleResult=r},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(i,o){try{var a=t[i](o),s=a.value}catch(u){return void n(u)}return a.done?void e(s):Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)})}return r("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.serviceWorkerManager=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=t(8),s=n(a),u=t(1),c=t(76),l=t(10),f=t(17),d=n(f),p={campaign:"/pushsubs/services/TjQRB8nzO4u3J7RJiKU-"},h=function(){function e(){var t=this;i(this,e),this.checkAndDoForceUpdate=function(){t.retryTimer&&window.clearInterval(t.retryTimer),t.isSubscriptionSuccessed().then(function(e){if(!e||t.swForceUpdate){console.warn("Endpoint not subscript yet.");var n={deviceInfos:window.deviceInfos};t.forceUpdate(n)}})},this.unregister=function(){return navigator.serviceWorker.ready.then(function(e){return e.pushManager.getSubscription()}).then(function(e){return e.unsubscribe()})},this.prepareIndexedDB=function(){for(var e=l.PUSH_TEXT,t={},n=0;n<e.length;n++)t[e[n]]=navigator.mozL10n.get(e[n]);t=JSON.stringify(t);var r=u.utils.getCommsInfo();return new Promise(function(e){asyncStorage.setItem(l.STORAGE_KEY.simInfo,r,function(){e()})}).then(function(){return new Promise(function(e){asyncStorage.getItem(l.STORAGE_KEY.l10nMapping,function(n){n!==t?asyncStorage.setItem(l.STORAGE_KEY.l10nMapping,t,function(){e()}):e()})})})},this.batchSetSubscriptionRecord=function(){var e=r(regeneratorRuntime.mark(function e(n){var r,i,o,a,s,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(r={},i=!0,o=!1,a=void 0,e.prev=4,s=n[Symbol.iterator]();!(i=(u=s.next()).done);i=!0)c=u.value,r[c]=!0;e.next=12;break;case 8:e.prev=8,e.t0=e.catch(4),o=!0,a=e.t0;case 12:e.prev=12,e.prev=13,!i&&s.return&&s.return();case 15:if(e.prev=15,!o){e.next=18;break}throw a;case 18:return e.finish(15);case 19:return e.finish(12);case 20:asyncStorage.setItem(l.STORAGE_KEY.subscriptionRecord,JSON.stringify(r));case 21:case"end":return e.stop()}},e,t,[[4,8,12,20],[13,,15,19]])}));return function(t){return e.apply(this,arguments)}}(),this.clearSubscriptionRecord=function(){asyncStorage.setItem(l.STORAGE_KEY.subscriptionRecord,"{}")},this.isSubscriptionSuccessed=function(){return new Promise(function(e){asyncStorage.getItem(l.STORAGE_KEY.subscriptionRecord,function(n){var r=function(){if(n)try{return JSON.parse(n)}catch(e){return{}}return{}}();e(function(){if(0===Object.keys(r).length)return!1;for(var e in t.subscriptionURI)if(!r[e])return!1;return!0}())})})},this.retrySubscription=function(){t.retryTimer=window.setTimeout(function(){t.checkAndDoForceUpdate()},6e4)},this.publicKey=(0,c.base64UrlToUint8Array)("BJpjnIyVeRwf4tiHA5GeM-j1IqR7NN8kbqdQPaRD6QWezxvXJwicLRIYNU48JDJt8aH_28RvjUTtXRRqfL0GSZM"),this.observedSettings=["ril.data.defaultServiceId"],navigator.mozL10n.ready(function(){t.prepareIndexedDB()}),this.eventName="",this.eventTarget="sw-register",this.endpointRegistrationStatus={};for(var n in p)this.endpointRegistrationStatus[n]=null;this.swForceUpdate=!1,this.retryTimer=null}return o(e,[{key:"start",value:function(e,t){var n=this;t&&(this.eventName=t),this.updateParameters(e),"serviceWorker"in navigator?navigator.serviceWorker.register("sw.js").then(function(e){n.initialiseState(e),performance.mark("SERVICE_WORKER_END")}).catch(function(e){console.error("[sw] Fail to register sw.js",e),n.dispatchRegistrationEvent(!1,"Fail to register sw.js")}):(console.error("[sw] Service workers aren't supported in this browser."),this.dispatchRegistrationEvent(!1,"Service workers aren't supported in this browser"))}},{key:"forceUpdate",value:function(e){this.swForceUpdate=!1,this.updateParameters(e),this.updateEndpoint()}},{key:"updateParameters",value:function(e){this.deviceInfos=e.deviceInfos;var t=this.deviceInfos.get("apps.serviceCenterUrl");this.subscriptionURI={campaign:t+p.campaign}}},{key:"initialiseState",value:function(e){var t=this;navigator.serviceWorker.ready.then(function(e){Promise.all([e.pushManager.getSubscription(),t.isSubscriptionSuccessed()]).then(function(e){var n=e[0],r=e[1];n&&r?(console.warn("[sw] Already has subscription.",n),t.dispatchRegistrationEvent(!0)):(console.warn("[sw] Not subscript yet."),t.register())}).catch(function(e){console.error("[sw] Get subscription status Error",e),t.dispatchRegistrationEvent(!1,"Get subscription status Error")})})}},{key:"register",value:function(){var e=this;navigator.serviceWorker.ready.then(function(t){return t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:e.publicKey})}).then(function(t){if(t.options.applicationServerKey){new Uint8Array(t.options.applicationServerKey)}e.addSubscription(t)}).catch(function(t){console.error("[sw] subscriptionErr: "+t),e.dispatchRegistrationEvent(!1,"SubscriptionErr: "+t)})}},{key:"removeSubscription",value:function(){var e=this;return new Promise(function(t,n){e.clearSubscriptionRecord();for(var r in e.subscriptionURI){var i={url:e.subscriptionURI[r],method:"DELETE"};s.default.getRequester({serverTimeOffset:window.serverTimeOffset,setDeviceInfo:!0,deviceInfos:window.deviceInfos}).send(i).then(function(){t()},function(e){n(),console.error("antitheft deleting error "+JSON.stringify(e))})}})}},{key:"addSubscription",value:function(){function e(e){return t.apply(this,arguments)}var t=r(regeneratorRuntime.mark(function e(t){var n,i,o,a,c,f,p,h,v=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n="registration-complete"===this.eventName?l.TRIGGER_TYPE.FTU_REGISTER:l.TRIGGER_TYPE.MOZ_APP_LAUNCH,d.default.postPushRegistrationEvent("init",{type:n}),i=this.deviceInfos.get("ril.data.defaultServiceId"),o=u.utils.getCommsInfo(),e.next=6,r(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mozSettings.createLock().get("app.update.custom");case 3:if(t=e.sent,!t){e.next=6;break}return e.abrupt("return",t["app.update.custom"]);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("addSubscription error",e.t0);case 11:return e.abrupt("return",null);case 12:case"end":return e.stop()}},e,v,[[0,8]])}))();case 6:a=e.sent,c={push_type:5e3,push_subsc:window.btoa(JSON.stringify(t)),defaultServiceId:i,icc_mcc:parseInt(o.simMCC,10)||0,icc_mnc:parseInt(o.simMNC,10)||0,icc_mcc2:parseInt(o.simMCC2,10)||0,icc_mnc2:parseInt(o.simMNC2,10)||0,lang:navigator.mozL10n.language.code||"en-US",build_id:window.deviceInfos.get("deviceinfo.platform_build_id"),uuid:a},f=[],p=function(e){var t=new Promise(function(t,n){var r=e,i={url:v.subscriptionURI[r],method:"POST",params:c};s.default.getRequester({serverTimeOffset:window.serverTimeOffset,setDeviceInfo:!0,deviceInfos:window.deviceInfos}).send(i).then(function(e){console.warn("[sw] push to endpoint "+v.subscriptionURI[r]+" success!"),v.dispatchRegistrationEvent(!0,null,r),t(r)},function(e){console.error("[sw] push to endpoint "+v.subscriptionURI[r]+" failed: "+e.statusText),v.dispatchRegistrationEvent(!1,"Push to endpoint "+v.subscriptionURI[r]+" failed: "+e.statusText,r),n(e)})});f.push(t)};for(h in this.subscriptionURI)p(h);Promise.all(f).then(function(e){v.batchSetSubscriptionRecord(e)}).catch(function(e){v.clearSubscriptionRecord(),v.retrySubscription()});case 12:case"end":return e.stop()}},e,this)}));return e}()},{key:"updateEndpoint",value:function(){var e=this;"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.pushManager.getSubscription().then(function(t){t?e.addSubscription(t):e.register()}).catch(function(e){console.error("[sw] Error during getSubscription()",e);})})}},{key:"dispatchRegistrationEvent",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r={success:e,target:this.eventTarget};if(e===!1&&t&&(r.reason=t),null===n)this.eventName?document.dispatchEvent(new CustomEvent(this.eventName,{detail:r})):navigator.mozSettings.createLock().set({"ftu.storePushRegistration":e});else{var i=this.isRegistartionSuccess(e,n);i===!0?d.default.postPushRegistrationEvent("done"):d.default.postPushRegistrationEvent("failed",{err:t}),null!==i&&(this.eventName?(r.success=i,document.dispatchEvent(new CustomEvent(this.eventName,{detail:r}))):navigator.mozSettings.createLock().set({"ftu.storePushRegistration":i}))}}},{key:"isRegistartionSuccess",value:function(e,t){this.endpointRegistrationStatus[t]=e;var n=!0;for(var r in this.endpointRegistrationStatus){if(null===this.endpointRegistrationStatus[r])return null;this.endpointRegistrationStatus[r]===!1&&(n=!1)}return n}}]),e}();exports.serviceWorkerManager=new h},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.getRemoteManifestURL=exports.getInstalledApps=exports.uninstall=exports.installAppByManifestURL=exports.checkKaiStoreUpdate=exports.updateKaiStoreApp=void 0;var r=t(71),i=n(r),o=(exports.updateKaiStoreApp=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){return window.close()},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};navigator.mozApps.getSelf().onsuccess=function(n){var r=n.target.result;r.download(),r.ondownloadapplied=e,r.ondownloaderror=t}},exports.checkKaiStoreUpdate=function(){return new Promise(function(e,t){var n=navigator.mozApps.getSelf();n.onsuccess=function(n){var r=n.target.result,i=r.checkForUpdate(!1);i.onerror=function(e){t(e)},i.onsuccess=function(){e(r.downloadAvailable)}},n.onerror=function(e){t(e)}})},function(e){return new Promise(function(t,n){var r=navigator.mozApps.install(e);r.onsuccess=function(){t()},r.onerror=function(){n({error:r.error.name})}})}),a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new Promise(function(n,r){var i=null;if(t&&t.receiptToken){var o={receipts:[t.receiptToken]};i=navigator.mozApps.installPackage(e,o)}else i=navigator.mozApps.installPackage(e);i.onsuccess=function(){n()},i.onerror=function(){r({error:i.error.name})}})};exports.installAppByManifestURL=function(e,t){var n=t.isHosted,r=t.jwt,i=void 0===r?null:r;return(n?o(e):a(e,i)).catch(function(e){throw console.warn("install error:"+JSON.stringify(e)),e})},exports.uninstall=function(e){navigator.mozApps.mgmt.uninstall(e)},exports.getInstalledApps=function(){return new Promise(function(e){navigator.mozApps.mgmt.getAll().onsuccess=function(t){e(t.target.result.filter(function(e){return"installed"===e.installState||e.downloading===!0}).map(function(e){return i.default.releaseUnusedInfo(e),e}))}})},exports.getRemoteManifestURL=function(e){return e.manifest&&e.manifest.updateURL?e.manifest.updateURL:e.manifestURL}},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.CACHE_DATA=void 0;var i=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(u){i=!0,o=u}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=t(1),u=t(7),c=n(u),l=exports.CACHE_DATA={API:{KEY:"cached_apps_categories",EXPIRY_TIME:864e5},TOKEN:{KEY:"cached_token",EXPIRY_TIME:null}},f={STATIC:"static_params",RUNTIME:"runtime_params"},d=function(){function e(){r(this,e)}return a(e,[{key:"updateCacheStatus",value:function(){var e=this,t=Object.values(l).map(function(t){var n=t.KEY,r=t.EXPIRY_TIME;return e.checkAndHandleExpiration(n,r)});return Promise.all(t).then(function(e){return e.some(function(e){return e===!0})})}},{key:"checkAndHandleExpiration",value:function(e,t){var n=Date.now();return new Promise(function(r,i){asyncStorage.getItem(e,function(i){if(null===i)return void r(!1);var o=null!==t,a=Math.abs(n-i.timestamp);(o?i&&i.timestamp&&a>t:i&&i.expiryTime&&a>i.expiryTime)?(i.isCached=!1,asyncStorage.setItem(e,i),r(!0)):r(!1)})})}},{key:"clearAll",value:function(){Object.values(l).forEach(function(e){var t=e.KEY;asyncStorage.removeItem(t)})}},{key:"handleStaticParamsChange",value:function(){var e=["deviceinfo.build_number","deviceinfo.os","deviceinfo.platform_build_id","deviceinfo.platform_version","deviceinfo.software"],t={};return e.forEach(function(e){t[e]=window.deviceInfos.get(e)}),this.handleParamsChange(f.STATIC,t)}},{key:"handleRuntimeParamsChange",value:function(){var e=window.deviceInfos.get("ril.data.defaultServiceId"),t=o({},s.utils.getCommsInfo(),{defaultServiceId:e,deviceLanguage:navigator.mozL10n.language.code||"",connectionType:c.default.connectionType(e)});return this.handleParamsChange(f.RUNTIME,t,!0)}},{key:"handleParamsChange",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n&&performance.mark("CHECK_PARAM_START");var r=JSON.stringify(t);return new Promise(function(t){asyncStorage.getItem(e,function(i){null===i?(asyncStorage.setItem(e,r),t(!1)):r!==i?(asyncStorage.setItem(e,r),t(!0)):t(!1),n&&performance.mark("CHECK_PARAM_END")})})}},{key:"cacheCleanUp",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=[this.handleRuntimeParamsChange(),this.updateCacheStatus()];return t&&n.push(this.handleStaticParamsChange()),Promise.all(n).then(function(n){var r=i(n,3),a=r[0],s=r[1],u=r[2];return(t&&(a||u)||!t&&a)&&e.clearAll(),o({runtimeParamsChanged:a,cacheExpired:s},t&&{staticParamsChanged:u})})}}]),e}();exports.default=d=new d},function(e,exports){"use strict";function t(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(i,o){try{var a=t[i](o),s=a.value}catch(u){return void n(u)}return a.done?void e(s):Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)})}return r("next")})}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(){var r=this;n(this,e),this.initSession=t(regeneratorRuntime.mark(function e(){var n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r.canUpgrade()){e.next=2;break}return e.abrupt("return");case 2:n=new lib_session.Session,i={},i.onsessionconnected=t(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.warn("************************"),console.warn("**   CA Hotfix v2.1   **"),console.warn("************************"),e.prev=3,e.next=6,lib_telephony.TelephonyService.get(n);case 6:t=e.sent,r.getCert().then(function(){return r.runCertUpdate(t)}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),console.error(e.t0);case 13:case"end":return e.stop()}},e,r,[[3,10]])})),i.onsessiondisconnected=function(){console.warn("Error! Daemon crashed, please get new session object")},i.onsessionconnectionerror=function(){console.warn("Error! Session connection error.")},navigator.externalapi.getToken().then(function(e){console.warn("Client token is "+e),n.open("websocket","localhost:8081",e,i,!0)},function(e){console.error("Get Client token error: "+e)});case 8:case"end":return e.stop()}},e,r)})),this.shownRebootPanel=!1,this.settingsKey="ssl.certificate.fixedversion",this.hotfixVersion="v2.1",this.fixedVersions=["v2.1"],this.updating=!1}return r(e,[{key:"start",value:function(){function e(){return n.apply(this,arguments)}var n=t(regeneratorRuntime.mark(function e(){var n,r,i,o=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=8081,navigator.externalapi&&(n=navigator.externalapi.port||n),e.next=4,this.checkDeviceCertificate();case 4:r=e.sent,i=["http://127.0.0.1:"+n+"/api/v1/shared/core.js","http://127.0.0.1:"+n+"/api/v1/shared/session.js","http://127.0.0.1:"+n+"/api/v1/telephony/service.js"],r?console.warn("No need to do CA hotfix!"):i.forEach(function(){var e=t(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,LazyLoader.load(t);case 2:console.warn("Load "+t+" success."),n===i.length-1&&(console.warn("Init api-daemon session."),o.initSession());case 4:case"end":return e.stop()}},e,o)}));return function(t,n){return e.apply(this,arguments)}}());case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"checkDeviceCertificate",value:function(){var e=this;return navigator.mozSettings.createLock().get(this.settingsKey).then(function(t){return e.fixedVersions.includes(t[e.settingsKey])})}},{key:"updateSettingsFlag",value:function(e){var t={};return t[this.settingsKey]=e,navigator.mozSettings.createLock().set(t)}},{key:"canUpgrade",value:function(){return navigator.engmodeExtension?navigator.externalapi?lib_session?!!lib_telephony||(console.warn("lib_telephony is not available: Do Nothing!"),!1):(console.warn("lib_session is not available: Do Nothing!"),!1):(console.warn("navigator.externalapi: Not supported!"),!1):(console.warn("navigator.engmodeExtension: Not supported!"),!1)}},{key:"getCert",value:function(){return new Promise(function(e){navigator.engmodeExtension.execCmdLE(["busybox_tar","x; cp -f `ls -d /data/b2g/mozilla/*.default`/cert9.db /data/local/service/api-daemon/cert/"],2).then(function(t){console.warn("getCert result 1: "+t),navigator.engmodeExtension.execCmdLE(["busybox_tar","x; cp -f `ls -d /data/b2g/mozilla/*.default`/key4.db /data/local/service/api-daemon/cert/"],2).then(function(t){console.warn("getCert result 2: "+t),e()})})})}},{key:"putCert",value:function(){var e=this;return new Promise(function(t){navigator.engmodeExtension.execCmdLE(["busybox_tar","x; cp -f /data/local/service/api-daemon/cert/cert9.db `ls -d /data/b2g/mozilla/*.default`"],2).then(function(n){console.warn("PutCert result 1: "+n),navigator.engmodeExtension.execCmdLE(["busybox_tar","x; cp -f /data/local/service/api-daemon/cert/key4.db `ls -d /data/b2g/mozilla/*.default`"],2).then(function(n){console.warn("PutCert result 2: "+n),console.warn("Update finished."),e.checkDaemonStatus().then(function(n){console.warn("CA Flag: "+n),t(n===e.hotfixVersion)})})})})}},{key:"checkDaemonStatus",value:function(){function e(){return n.apply(this,arguments)}var n=t(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://127.0.0.1:8081/ca");case 2:return t=e.sent,e.abrupt("return",t.text());case 4:case"end":return e.stop()}},e,this)}));return e}()},{key:"runCertUpdate",value:function(){function e(e){return n.apply(this,arguments)}var n=t(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=3;break}return console.warn("TelephonyService is not ready."),e.abrupt("return");case 3:if(!this.updating){e.next=6;break}return console.warn("Update cert is ongoing..."),e.abrupt("return");case 6:return this.updating=!0,e.next=9,t.update_cert();case 9:return n=e.sent,console.warn("update_cert result: "+n),e.next=13,this.putCert();case 13:if(r=e.sent,console.warn("check flag success: "+r),!r){e.next=21;break}return e.next=18,this.updateSettingsFlag(this.hotfixVersion);case 18:console.warn("****************************"),console.warn("**   CA Hotfix Finished   **"),console.warn("****************************");case 21:this.updating=!1;case 22:case"end":return e.stop()}},e,this)}));return e}()}]),e}();exports.default=i=new i},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(i,o){try{var a=t[i](o),s=a.value}catch(u){return void n(u)}return a.done?void e(s):Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)})}return r("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var o=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(u){i=!0,o=u}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=t(1),u=t(10),c=t(7),l=n(c),f=function(){function e(){i(this,e),this.errorInfo=null,this.settingsKey="apps.experimentBaseUrl",this.graphqlDefaultURL="https://configapi.store.kaiostech.com"}return a(e,[{key:"getExperimentURL",value:function(){var e=SettingsHelper(this.settingsKey,this.graphqlDefaultURL);return new Promise(function(t){e.get(function(e){t(e+"/graphql")})})}},{key:"getParams",value:function(){var e={experimentType:"Tiny-Store-UI"};return l.default.getDeviceInfos().then(function(t){var n=s.utils.getCommsInfo();return e.mcc=n.simMCC||0,e.mnc=n.simMNC||0,e.curef=t.get("deviceinfo.cu"),e.os=t.get("deviceinfo.os").split(" ")[0],e.storeVersion=l.default.storeVersion,s.utils.getIMEI()}).then(function(t){return e.imei=t,e})}},{key:"getRequestBody",value:function(e){return'query {\n      getExperiment(\n        imei: "'+e.imei+'",\n        experiment_type: "'+e.experimentType+'",\n        curef: "'+e.curef+'",\n        mcc: "'+e.mcc+'",\n        mnc: "'+e.mnc+'",\n        os_version: "'+e.os+'",\n        store_client_version: "'+e.storeVersion+'"\n      ) {\n        experiment_id,\n        variant,\n        base_version,\n        version,\n        fallback,\n        description,\n        config_ttl_in_sec,\n        status,\n        creation_timestamp,\n        bucket_id\n      }\n    }'}},{key:"fetchConfig",value:function(){var e=this;return performance.mark("FETCH_CONFIG_START"),this.getConfigFromCache().then(function(t){if(performance.mark("FETCH_CONFIG_END"),!t)return e.getConfigFromServer();var n=t.config;return n&&!e.isExpired(n)?n:e.getConfigFromServer()})}},{key:"getConfigFromServer",value:function(){function e(){return t.apply(this,arguments)}var t=r(regeneratorRuntime.mark(function e(){var t,n,r,i,a,c,l,f,d,p=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=[this.getExperimentURL(),this.getParams()],n="POST",r="cors",i=3e3,e.next=6,Promise.all(t);case 6:return a=e.sent,c=o(a,2),l=c[0],f=c[1],d=this.getRequestBody(f),e.abrupt("return",(0,s.fetchWithTimeout)(l,{method:n,mode:r,body:d},i).then(function(e){return performance.mark("FETCH_CONFIG_END"),e.json()}).then(function(e){var t=p.getValidConfig(e);if(t){var n=t.config_ttl_in_sec;t.expiryTime=Date.now()+1e3*n,asyncStorage.setItem(u.STORAGE_KEY.experimentConfig,{config:t,params:f}),p.setErrorInfo({isConfigError:!1})}else null===t&&e.errors&&p.setErrorInfo({isConfigError:!0,error:{name:"invalidConfig",message:e.errors[0].message}});return t}).catch(function(e){return performance.mark("FETCH_CONFIG_END"),p.setErrorInfo({isConfigError:!0,error:{name:e.name,message:e.message}}),console.error(e),null}));case 12:case"end":return e.stop()}},e,this)}));return e}()},{key:"getValidConfig",value:function(e){var t=null;if(e&&e.data){var n=e.data.getExperiment;n&&n.version&&n.config_ttl_in_sec&&(t=n)}return t}},{key:"getConfigFromCache",value:function(){return new Promise(function(e){asyncStorage.getItem(u.STORAGE_KEY.experimentConfig,function(t){return e(t)})})}},{key:"isExpired",value:function(e){return!(e&&e.expiryTime&&e.expiryTime>Date.now())}},{key:"setErrorInfo",value:function(e){var t=e.isConfigError,n=e.error,r=void 0===n?{}:n;t?this.errorInfo={name:r.name,message:r.message}:this.errorInfo=null}}]),e}(),d=new f;exports.default=d},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(i,o){try{var a=t[i](o),s=a.value}catch(u){return void n(u)}return a.done?void e(s):Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)})}return r("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=t(23),s=t(11),u=t(9),c=t(16),l=n(c),f=(t(1),t(30)),d=t(17),p=n(d),h=function(){function e(){var t=this;i(this,e),this.processRemoteQueue=r(regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(t.isRemoteFirstViewReady=!0;t.remoteTaskQueue.length;)n=t.remoteTaskQueue.shift(),t.saveToQueue(n);case 2:case"end":return e.stop()}},e,t)})),this.processActivityQueue=r(regeneratorRuntime.mark(function e(){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=t.activityQueue.shift(),n&&(r=new MozActivity(n));case 2:case"end":return e.stop()}},e,t)})),this.iac_kaipay="kaipay-to-kaistore",this.activityQueue=[],this.remoteTaskQueue=[],this.activityRequestHandler=null,this.isRemoteFirstViewReady=!1,this.doNotShowUpdateDailogWhenBoot=!1}return o(e,[{key:"start",value:function(){this.startListener()}},{key:"startListener",value:function(){var e=this;navigator.mozSetMessageHandler("activity",this.handleActivity.bind(this)),navigator.mozSetMessageHandler("connection",this.handleIAC.bind(this)),navigator.mozSetMessageHandler("serviceworker-notification",function(t){if(t.msg){console.warn("[serviceworker-notification] Push notification:",t.msg);var n=JSON.parse(t.msg);if(n.isNeedByStream&&e._composePushCampInfo(n),n.launch&&n.manifestURL)e.doNotShowUpdateDailogWhenBoot=!0,l.default.launchAppByManifestURL(n.manifestURL,n);else if(n.manifestURL)e.showDetailPageFromPush(n);else if(n.url){var r={name:"view",data:{type:"url",url:n.url}};"hidden"===document.visibilityState?(e.doNotShowUpdateDailogWhenBoot=!0,e.activityQueue.push(r)):new MozActivity(r)}else n.categoryCode?e.openCategoryTabFromPush(n):n.swForceUpdate===!0&&(f.serviceWorkerManager.swForceUpdate=!0)}else console.error("[serviceworker-notification] error!!!")}),performance.mark("INIT_LISTENERS_END")}},{key:"showDetailPageFromPush",value:function(e){var t=e.manifestURL,n=e.csId,r=e.token;if(!t)return void console.error("There is no manifestURL in the push data.");var i={data:{type:"push-app",url:t,csId:n,token:r},name:"push-app",origin:"serviceworker",getFilterResults:!1};this.isRemoteFirstViewReady?this.saveToQueue(i):this.remoteTaskQueue.push(i)}},{key:"openCategoryTabFromPush",value:function(e){var t=e.categoryCode;if(!t)return void console.error("There is no categoryCode in the push data.");var n={data:{action:"open-appspanel",detail:{categoryCode:t}},name:"launch-store",origin:"",getFilterResults:!1};this.isRemoteFirstViewReady?this.saveToQueue(n):this.remoteTaskQueue.push(n)}},{key:"handleActivity",value:function(e){var t=e.source;switch(this.activityRequestHandler=e,t.name){case"open-deeplink":case"open-page":case"open-by-name":case"inline-open-page":case"inline-open-by-name":case"silent-launch":case"launch-store":this.saveToQueue(t)}}},{key:"handleIAC",value:function(e){if(e.keyword===this.iac_kaipay){e.port.onmessage=function(e){var t=e.data,n=t.productID,r=t.data.orderId;n&&r&&(t.updateTime=e.timeStamp,asyncStorage.setItem(this.iac_kaipay+"-"+n,t))}.bind(this)}}},{key:"saveToQueue",value:function(e){if(e){"push-app"!==e.name&&this._recordActivityInfo("init",e);var t=e.data;t&&(t.adId||"push-app"===t.type)&&(this.doNotShowUpdateDailogWhenBoot=!0),l.default.pushDataForDelayLaunch&&(l.default.pushDataForDelayLaunch=null,"push-app"!==e.name&&p.default.postStoreOpenEvent(window.timeOriginInEpoch,"cold_launch")),this.isRemoteFirstViewReady===!1?this.remoteTaskQueue.push(e):u.MessageSender.send(new s.TaskQueueUpdateCommand({detail:new a.Task(e)}))}}},{key:"_isInlineActivity",value:function(e){return["inline-open-page","inline-open-by-name"].includes(e)}},{key:"_recordActivityInfo",value:function(e,t){var n=t.name,r=t.data;p.default.saveStoreOpenEvent({evtName:"store_open_"+e,evtUtc:"init"===e?window.timeOriginInEpoch:Date.now(),triggerType:n}),r&&r.adId?p.default.saveReferralMeta({ad_request_id:r.adId}):r&&r.csId&&p.default.saveReferralMeta({cs_id:r.csId?r.csId:"",token:r.token?r.token:"",manifestURL:r.url?r.url:""})}},{key:"_composePushCampInfo",value:function(e){var t={name:"push campaign",data:{url:e.manifestURL||"",csId:e.csId||"",token:e.token||""}};this._recordActivityInfo("init",t)}},{key:"postResult",value:function(){if(this.activityRequestHandler&&this.activityRequestHandler.source){var e=["open-deeplink","ftu-register","silent-install"],t=this.activityRequestHandler.source,n=t.data.url,r=t.name;if(e.includes(r)){if("open-deeplink"===r){if("true"!==new URL(n).searchParams.get("postResult"))return}v.activityRequestHandler.postResult("done")}v.activityRequestHandler=null}}},{key:"remoteTask",get:function(){return 0!==this.remoteTaskQueue.length&&this.remoteTaskQueue.shift()}}]),e}(),v=new h;exports.default=v},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=t(21),u=n(s),c=t(55),l=n(c),f=t(28),d=n(f),p=!1,h=function(e){function t(){r(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.EVENT_PREFIX="",e.service=window.Service||l.default,e.EVENTS&&e.EVENTS.forEach(function(e){window.addEventListener(e,this)},e),e.SERVICES&&e.SERVICES.forEach(function(e){this.service.register(e,this)},e),e.STATES&&e.STATES.forEach(function(e){this.service.registerState(e,this)},e),e.SETTINGS&&(e._settings={},e.SETTINGS.forEach(function(e){d.default.addObserver(e,this)},e)),e}return o(t,e),a(t,[{key:"publish",value:function(e,t,n){var r=n?"":this.EVENT_PREFIX,i=new CustomEvent(r+e,{bubbles:!0,detail:t||this});this.debug("publishing: "+r+e),window.dispatchEvent(i)}},{key:"handleEvent",value:function(e){if("function"==typeof this._pre_handleEvent){if(this._pre_handleEvent(e)===!1)return}else this.debug("no handle event pre found. skip");"function"==typeof this["_handle_"+e.type]&&(this.debug("handling "+e.type),this["_handle_"+e.type](e)),"function"==typeof this._post_handleEvent&&this._post_handleEvent(e)}},{key:"observe",value:function(e,t){this.debug("observing "+e+" : "+t),this._settings||(this._settings={}),this._settings[e]=t,"function"==typeof this["_observe_"+e]&&(this.debug("observer for "+e+" found, invoking."),this["_observe_"+e](t))}},{key:"debug",value:function(){this.DEBUG||p?this.TRACE&&console.trace():window.DUMP&&DUMP("["+this.name+"]"+Array.slice(arguments).concat())}}]),t}(u.default);exports.default=h},function(e,exports){"use strict";function t(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return n===-1&&(n=t),[n,n===t?0:4-n%4]}function n(e){var n=t(e),r=n[0],i=n[1];return 3*(r+i)/4-i}function r(e,t,n){return 3*(t+n)/4-n}function i(e){var n,i,o=t(e),a=o[0],s=o[1],u=new l(r(e,a,s)),f=0,d=s>0?a-4:a;for(i=0;i<d;i+=4)n=c[e.charCodeAt(i)]<<18|c[e.charCodeAt(i+1)]<<12|c[e.charCodeAt(i+2)]<<6|c[e.charCodeAt(i+3)],u[f++]=n>>16&255,u[f++]=n>>8&255,u[f++]=255&n;return 2===s&&(n=c[e.charCodeAt(i)]<<2|c[e.charCodeAt(i+1)]>>4,u[f++]=255&n),1===s&&(n=c[e.charCodeAt(i)]<<10|c[e.charCodeAt(i+1)]<<4|c[e.charCodeAt(i+2)]>>2,u[f++]=n>>8&255,u[f++]=255&n),u}function o(e){return u[e>>18&63]+u[e>>12&63]+u[e>>6&63]+u[63&e]}function a(e,t,n){for(var r,i=[],a=t;a<n;a+=3)r=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),i.push(o(r));return i.join("")}function s(e){for(var t,n=e.length,r=n%3,i=[],o=16383,s=0,c=n-r;s<c;s+=o)i.push(a(e,s,s+o>c?c:s+o));return 1===r?(t=e[n-1],i.push(u[t>>2]+u[t<<4&63]+"==")):2===r&&(t=(e[n-2]<<8)+e[n-1],i.push(u[t>>10]+u[t>>4&63]+u[t<<2&63]+"=")),i.join("")}exports.byteLength=n,exports.toByteArray=i,exports.fromByteArray=s;for(var u=[],c=[],l="undefined"!=typeof Uint8Array?Uint8Array:Array,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",d=0,p=f.length;d<p;++d)u[d]=f[d],c[f.charCodeAt(d)]=d;c["-".charCodeAt(0)]=62,c["_".charCodeAt(0)]=63},function(e,exports,t){(function(e){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){for(var t=a(e),n=new ArrayBuffer(t.length),r=new Uint8Array(n),i=0;i<r.length;i++)r[i]=t.charCodeAt(i);return o(r)}function o(e){if(!e)return"";for(var t="",n=0;n<e.length;n++){var r=(255&e[n]).toString(16);r=1===r.length?"0"+r:r,t+=r}return t.toUpperCase()}function a(t){return new e(t,"base64").toString("binary")}Object.defineProperty(exports,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=t(39),c=n(u),l=6e4,f=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l;r(this,e),this._timeout=t,this._hawkCredentials=null,this._deviceInfo=null,this._timeOffset=null,this.hawk=c.default}return s(e,[{key:"setDeviceInfo",value:function(e){this._deviceInfo={ct:e.ct,dev_utc:e.utc,dev_utc_off:e.utcOff,dev_build_id:e.buildID,dev_build_number:e.buildNumber?e.buildNumber:null,client_version:e.client_version?e.client_version:null,client_name:e.client_name?e.client_name:null}}},{key:"_caculateOffset",value:function(e){var t=0;if(e){t=Date.parse(this._getUTCTime(e))-Date.parse((new Date).toUTCString())}return t}},{key:"_getUTCTime",value:function(e){return new Date(Date.parse(e)).toUTCString()}},{key:"_broadcast",value:function(e,t){var n=new CustomEvent("hawkrequester:offsetchange",{detail:{msg:"this._timeOffset in hawk-requester has been changed!",previous:e,current:t}});window.dispatchEvent(n)}},{key:"_send",value:function(e){var t=this;return new Promise(function(n,r){var i=JSON.stringify(e.params),o=e.paramsCompressed,a=e.url,s=e.method,u=e.authorization,c=e.extraHeaders,l=new XMLHttpRequest({mozSystem:!0});if(l.open(s,a,!0),l.timeout=t._timeout,l.setRequestHeader("Content-Type","application/json"),l.withCredentials=!0,l.responseType="",c&&Object.keys(c).forEach(function(e){var t=c[e];l.setRequestHeader(e,t)}),u)l.setRequestHeader("Authorization",u);else if(t._hawkCredentials){var f=t.getHawkHeader(i,a,s);l.setRequestHeader("Authorization",f.field)}if(t._deviceInfo){var d=t._deviceInfo;Object.keys(d).forEach(function(e){var t=d[e];l.setRequestHeader(e,t)})}l.onload=function(){l.status>=200&&l.status<300?n(l.response):r({status:l.status,statusText:l.statusText,responseText:l.responseText,date:l.getResponseHeader("date")})},l.onerror=function(){r({status:l.status,statusText:l.statusText,responseText:l.responseText,date:l.getResponseHeader("date")})},l.ontimeout=function(){l.onerror()};var p=i;o&&(p=o),p?l.send(p):l.send(null)})}},{key:"setHawkCredentials",value:function(e,t){this._hawkCredentials={id:e,key:i(t),algorithm:"sha256"}}},{key:"send",value:function(e){var t=this;return new Promise(function(n,r){t._send(e).then(function(e){n(e)},function(i){if(401===i.status){var o=t._timeOffset;t._timeOffset=t._caculateOffset(i.date),t._broadcast(o,t._timeOffset),t._send(e).then(function(e){n(e)},function(e){r(e)})}else r(i)})})}},{key:"getHawkHeader",value:function(e,t,n){var r={credentials:this._hawkCredentials};return this._timeOffset&&(r.timestamp=Math.floor((Date.now()+this._timeOffset)/1e3)),e&&(r.payload=e,r.contentType="application/json"),c.default.client.header(t,n,r)}},{key:"serverTimeOffset",get:function(){return this._timeOffset},set:function(e){this._timeOffset=e}}]),e}();exports.default=f}).call(exports,t(22).Buffer)},function(e,exports){"use strict";var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n={};"undefined"!=typeof e&&e.exports&&(e.exports=n),n.client={header:function e(r,i,o){var a={field:"",artifacts:{}};if(!r||"string"!=typeof r&&"object"!==("undefined"==typeof r?"undefined":t(r))||!i||"string"!=typeof i||!o||"object"!==("undefined"==typeof o?"undefined":t(o)))return a.err="Invalid argument type",a;var s=o.timestamp||Math.floor((n.utils.now()+(o.localtimeOffsetMsec||0))/1e3),u=o.credentials;if(!(u&&u.id&&u.key&&u.algorithm))return a.err="Invalid credential object",a;if(n.crypto.algorithms.indexOf(u.algorithm)===-1)return a.err="Unknown algorithm",a;"string"==typeof r&&(r=n.utils.parseUri(r));var c={ts:s,nonce:o.nonce||n.utils.randomString(6),method:i,resource:r.relative,host:r.hostname,port:r.port,hash:o.hash,ext:o.ext,app:o.app,dlg:o.dlg};a.artifacts=c,!c.hash&&o.hasOwnProperty("payload")&&(c.hash=n.crypto.calculatePayloadHash(o.payload,u.algorithm,o.contentType));var l=n.crypto.calculateMac("header",u,c),f=null!==c.ext&&void 0!==c.ext&&""!==c.ext,e='Hawk id="'+u.id+'", ts="'+c.ts+'", nonce="'+c.nonce+(c.hash?'", hash="'+c.hash:"")+(f?'", ext="'+n.utils.escapeHeaderAttribute(c.ext):"")+'", mac="'+l+'"';return c.app&&(e+=', app="'+c.app+(c.dlg?'", dlg="'+c.dlg:"")+'"'),a.field=e,a},authenticate:function(e,t,r,i){if(i=i||{},e.getResponseHeader("www-authenticate")){var o=n.utils.parseAuthorizationHeader(e.getResponseHeader("www-authenticate"),["ts","tsm","error"]);if(!o)return!1;if(o.ts){if(n.crypto.calculateTsMac(o.ts,t)!==o.tsm)return!1;n.utils.setNtpOffset(o.ts-Math.floor((new Date).getTime()/1e3));}}if(!e.getResponseHeader("server-authorization")&&!i.required)return!0;var o=n.utils.parseAuthorizationHeader(e.getResponseHeader("server-authorization"),["mac","ext","hash"]);if(!o)return!1;var a={ts:r.ts,nonce:r.nonce,method:r.method,resource:r.resource,host:r.host,port:r.port,hash:o.hash,ext:o.ext,app:r.app,dlg:r.dlg};return n.crypto.calculateMac("response",t,a)===o.mac&&(!i.hasOwnProperty("payload")||!!o.hash&&n.crypto.calculatePayloadHash(i.payload,t.algorithm,e.getResponseHeader("content-type"))===o.hash)},message:function(e,r,i,o){if(!e||"string"!=typeof e||!r||"number"!=typeof r||null===i||void 0===i||"string"!=typeof i||!o||"object"!==("undefined"==typeof o?"undefined":t(o)))return null;var a=o.timestamp||Math.floor((n.utils.now()+(o.localtimeOffsetMsec||0))/1e3),s=o.credentials;if(!(s&&s.id&&s.key&&s.algorithm))return null;if(n.crypto.algorithms.indexOf(s.algorithm)===-1)return null;var u={ts:a,nonce:o.nonce||n.utils.randomString(6),host:e,port:r,hash:n.crypto.calculatePayloadHash(i,s.algorithm)};return{id:s.id,ts:u.ts,nonce:u.nonce,hash:u.hash,mac:n.crypto.calculateMac("message",s,u)}},authenticateTimestamp:function(e,t,r){return n.crypto.calculateTsMac(e.ts,t)===e.tsm&&(r!==!1&&n.utils.setNtpOffset(e.ts-Math.floor((new Date).getTime()/1e3)),!0)}},n.crypto={headerVersion:"1",algorithms:["sha1","sha256"],calculateMac:function(e,t,i){var o=n.crypto.generateNormalizedString(e,i),a=r.enc.Hex.parse(t.key);return r["Hmac"+t.algorithm.toUpperCase()](o,a).toString(r.enc.Base64)},generateNormalizedString:function(e,t){var r="hawk."+n.crypto.headerVersion+"."+e+"\n"+t.ts+"\n"+t.nonce+"\n"+(t.method||"").toUpperCase()+"\n"+(t.resource||"")+"\n"+t.host.toLowerCase()+"\n"+t.port+"\n"+(t.hash||"")+"\n";return t.ext&&(r+=t.ext.replace("\\","\\\\").replace("\n","\\n")),r+="\n",t.app&&(r+=t.app+"\n"+(t.dlg||"")+"\n"),r},calculatePayloadHash:function(e,t,i){var o=r.algo[t.toUpperCase()].create();return o.update("hawk."+n.crypto.headerVersion+".payload\n"),o.update(n.utils.parseContentType(i)+"\n"),o.update(e||""),o.update("\n"),o.finalize().toString(r.enc.Base64)},calculateTsMac:function(e,t){return r["Hmac"+t.algorithm.toUpperCase()]("hawk."+n.crypto.headerVersion+".ts\n"+e+"\n",t.key).toString(r.enc.Base64)}},n.utils={storage:{_cache:{},setItem:function(e,t){n.utils.storage._cache[e]=t},getItem:function(e){return n.utils.storage._cache[e]}},setStorage:function(e){var t=n.utils.getNtpOffset()||0;n.utils.storage=e,n.utils.setNtpOffset(t)},setNtpOffset:function(e){try{n.utils.storage.setItem("hawk_ntp_offset",e)}catch(t){console.error("[hawk] could not write to storage."),console.error(t)}},getNtpOffset:function(){return parseInt(n.utils.storage.getItem("hawk_ntp_offset")||"0",10)},now:function(){return(new Date).getTime()+n.utils.getNtpOffset()},escapeHeaderAttribute:function(e){return e.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')},parseContentType:function(e){return e?e.split(";")[0].replace(/^\s+|\s+$/g,"").toLowerCase():""},parseAuthorizationHeader:function(e,t){if(!e)return null;var n=e.match(/^(\w+)(?:\s+(.*))?$/);if(!n)return null;if("hawk"!==n[1].toLowerCase())return null;var r=n[2];if(!r)return null;var i={};return""!==r.replace(/(\w+)="([^"\\]*)"\s*(?:,\s*|$)/g,function(e,n,r){if(t.indexOf(n)!==-1&&null!==r.match(/^[ \w\!#\$%&'\(\)\*\+,\-\.\/\:;<\=>\?@\[\]\^`\{\|\}~]+$/)&&!i.hasOwnProperty(n))return i[n]=r,""})?null:i},randomString:function(e){for(var t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",n=t.length,r=[],i=0;i<e;++i)r[i]=t[Math.floor(Math.random()*n)];return r.join("")},parseUri:function(e){for(var t=["source","protocol","authority","userInfo","user","password","hostname","port","resource","relative","pathname","directory","file","query","fragment"],n=/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?(((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?)(?:#(.*))?)/,r=n.exec(e),i={},o=15;o--;)i[t[o]]=r[o]||"";return null!==i.port&&""!==i.port||(i.port="http"===i.protocol.toLowerCase()?"80":"https"===i.protocol.toLowerCase()?"443":""),i}};var r=r||function(e,t){var n={},r=n.lib={},i=function(){},o=r.Base={extend:function(e){i.prototype=this;var t=new i;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},a=r.WordArray=o.extend({init:function(e,n){e=this.words=e||[],this.sigBytes=n!=t?n:4*e.length},toString:function(e){return(e||u).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes;if(e=e.sigBytes,this.clamp(),r%4)for(var i=0;i<e;i++)t[r+i>>>2]|=(n[i>>>2]>>>24-8*(i%4)&255)<<24-8*((r+i)%4);else if(65535<n.length)for(i=0;i<e;i+=4)t[r+i>>>2]=n[i>>>2];else t.push.apply(t,n);return this.sigBytes+=e,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-8*(n%4),t.length=e.ceil(n/4)},clone:function(){var e=o.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n=[],r=0;r<t;r+=4)n.push(4294967296*e.random()|0);return new a.init(n,t)}}),s=n.enc={},u=s.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++){var i=t[r>>>2]>>>24-8*(r%4)&255;n.push((i>>>4).toString(16)),n.push((15&i).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-4*(r%8);return new a.init(n,t/2)}},c=s.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++)n.push(String.fromCharCode(t[r>>>2]>>>24-8*(r%4)&255));return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-8*(r%4);return new a.init(n,t)}},l=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(t){throw Error("Malformed UTF-8 data")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},f=r.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,i=n.sigBytes,o=this.blockSize,s=i/(4*o),s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0);if(t=s*o,i=e.min(4*t,i),t){for(var u=0;u<t;u+=o)this._doProcessBlock(r,u);u=r.splice(0,t),n.sigBytes-=i}return new a.init(u,i)},clone:function(){var e=o.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});r.Hasher=f.extend({cfg:o.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new d.HMAC.init(e,n).finalize(t)}}});var d=n.algo={};return n}(Math);!function(){var e=r,t=e.lib,n=t.WordArray,i=t.Hasher,o=[],t=e.algo.SHA1=i.extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],i=n[1],a=n[2],s=n[3],u=n[4],c=0;80>c;c++){if(16>c)o[c]=0|e[t+c];else{var l=o[c-3]^o[c-8]^o[c-14]^o[c-16];o[c]=l<<1|l>>>31}l=(r<<5|r>>>27)+u+o[c],l=20>c?l+((i&a|~i&s)+1518500249):40>c?l+((i^a^s)+1859775393):60>c?l+((i&a|i&s|a&s)-1894007588):l+((i^a^s)-899497514),u=s,s=a,a=i<<30|i>>>2,i=r,r=l}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+a|0,n[3]=n[3]+s|0,n[4]=n[4]+u|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[(r+64>>>9<<4)+14]=Math.floor(n/4294967296),t[(r+64>>>9<<4)+15]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});e.SHA1=i._createHelper(t),e.HmacSHA1=i._createHmacHelper(t)}(),function(e){for(var t=r,n=t.lib,i=n.WordArray,o=n.Hasher,n=t.algo,a=[],s=[],u=function(e){return 4294967296*(e-(0|e))|0},c=2,l=0;64>l;){var f;e:{f=c;for(var d=e.sqrt(f),p=2;p<=d;p++)if(!(f%p)){f=!1;break e}f=!0}f&&(8>l&&(a[l]=u(e.pow(c,.5))),s[l]=u(e.pow(c,1/3)),l++),c++}var h=[],n=n.SHA256=o.extend({_doReset:function(){this._hash=new i.init(a.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],i=n[1],o=n[2],a=n[3],u=n[4],c=n[5],l=n[6],f=n[7],d=0;64>d;d++){if(16>d)h[d]=0|e[t+d];else{var p=h[d-15],v=h[d-2];h[d]=((p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3)+h[d-7]+((v<<15|v>>>17)^(v<<13|v>>>19)^v>>>10)+h[d-16]}p=f+((u<<26|u>>>6)^(u<<21|u>>>11)^(u<<7|u>>>25))+(u&c^~u&l)+s[d]+h[d],v=((r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22))+(r&i^r&o^i&o),f=l,l=c,c=u,u=a+p|0,a=o,o=i,i=r,r=p+v|0}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+o|0,n[3]=n[3]+a|0,n[4]=n[4]+u|0,n[5]=n[5]+c|0,n[6]=n[6]+l|0,n[7]=n[7]+f|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,i=8*t.sigBytes;return n[i>>>5]|=128<<24-i%32,n[(i+64>>>9<<4)+14]=e.floor(r/4294967296),n[(i+64>>>9<<4)+15]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=o._createHelper(n),t.HmacSHA256=o._createHmacHelper(n)}(Math),function(){var e=r,t=e.enc.Utf8;e.algo.HMAC=e.lib.Base.extend({init:function(e,n){e=this._hasher=new e.init,"string"==typeof n&&(n=t.parse(n));var r=e.blockSize,i=4*r;n.sigBytes>i&&(n=e.finalize(n)),n.clamp();for(var o=this._oKey=n.clone(),a=this._iKey=n.clone(),s=o.words,u=a.words,c=0;c<r;c++)s[c]^=1549556828,u[c]^=909522486;o.sigBytes=a.sigBytes=i,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher;return e=t.finalize(e),t.reset(),t.finalize(this._oKey.clone().concat(e))}})}(),function(){var e=r,t=e.lib.WordArray;e.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp(),e=[];for(var i=0;i<n;i+=3)for(var o=(t[i>>>2]>>>24-8*(i%4)&255)<<16|(t[i+1>>>2]>>>24-8*((i+1)%4)&255)<<8|t[i+2>>>2]>>>24-8*((i+2)%4)&255,a=0;4>a&&i+.75*a<n;a++)e.push(r.charAt(o>>>6*(3-a)&63));if(t=r.charAt(64))for(;e.length%4;)e.push(t);return e.join("")},parse:function(e){var n=e.length,r=this._map,i=r.charAt(64);i&&(i=e.indexOf(i),-1!=i&&(n=i));for(var i=[],o=0,a=0;a<n;a++)if(a%4){var s=r.indexOf(e.charAt(a-1))<<2*(a%4),u=r.indexOf(e.charAt(a))>>>6-2*(a%4);i[o>>>2]|=(s|u)<<24-8*(o%4),o++}return t.create(i,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}()},function(e,exports){"use strict";exports.read=function(e,t,n,r,i){var o,a,s=8*i-r-1,u=(1<<s)-1,c=u>>1,l=-7,f=n?i-1:0,d=n?-1:1,p=e[t+f];for(f+=d,o=p&(1<<-l)-1,p>>=-l,l+=s;l>0;o=256*o+e[t+f],f+=d,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=r;l>0;a=256*a+e[t+f],f+=d,l-=8);if(0===o)o=1-c;else{if(o===u)return a?NaN:(p?-1:1)*(1/0);a+=Math.pow(2,r),o-=c}return(p?-1:1)*a*Math.pow(2,o-r)},exports.write=function(e,t,n,r,i,o){var a,s,u,c=8*o-i-1,l=(1<<c)-1,f=l>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,h=r?1:-1,v=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-a))<1&&(a--,u*=2),t+=a+f>=1?d/u:d*Math.pow(2,1-f),t*u>=2&&(a++,u/=2),a+f>=l?(s=0,a=l):a+f>=1?(s=(t*u-1)*Math.pow(2,i),a+=f):(s=t*Math.pow(2,f-1)*Math.pow(2,i),a=0));i>=8;e[n+p]=255&s,p+=h,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;e[n+p]=255&a,p+=h,a/=256,c-=8);e[n+p-h]|=128*v}},function(e,exports){"use strict";var t={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==t.call(e)}},function(e,exports,t){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var n=t(2);Object.defineProperty(exports,"commandList",{enumerable:!0,get:function(){return n.commandList}})},function(e,exports,t){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Token=void 0;var n=t(6),r=t(3),i=new n.ObjectModel({kid:String,macKey:String,type:Object.values(r.tokenType)}).defaultTo({type:r.tokenType.RESTRICTED});exports.Token=i},function(e,exports,t){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DeviceInfo=void 0;var n=t(6),r=new n.ObjectModel({bookmarkSupported:Boolean,connection:{defaultServiceId:Number,imei:String,simMCC:[String,void 0,null],simMNC:[String,void 0,null],currentMCC:[String,void 0,null],currentMNC:[String,void 0,null],simMCC2:[String,void 0,null],simMNC2:[String,void 0,null],currentMCC2:[String,void 0,null],currentMNC2:[String,void 0,null],type:[String,void 0,null]},settings:{"apps.analyticsEventBaseUrl":String,"apps.graphqlBaseUrl":String,"apps.graphql.key":String,"apps.searchBaseUrl":String,"apps.serviceCenter.microServiceUrl":String,"apps.serviceCenter.remoteUrl":String,"apps.serviceCenter.settingsEnabled":Boolean,"apps.serviceCenterUrl":String,"deviceinfo.build_number":String,"deviceinfo.cu":String,"deviceinfo.hardware":String,"deviceinfo.os":String,"deviceinfo.product_model":String,"deviceinfo.platform_build_id":String,"deviceinfo.platform_version":String,"deviceinfo.software":String,"identity.kaiaccounts.api.uri":String,"ril.data.defaultServiceId":Number,"store.nativeUpdate.enable":Boolean}}).defaultTo({bookmarkSupported:!1,settings:{"apps.analyticsEventBaseUrl":"https://analytics.kaiostech.com/v1","apps.graphqlBaseUrl":"https://api.store.kaiostech.com","apps.graphql.key":"vTPQIDW1Qc5PjgLDBdGDN8334Yil3fre334oToEn","apps.searchBaseUrl":"https://search.kaiostech.com","apps.serviceCenter.microServiceUrl":"https://api.kaiostech.com/kc_ksfe/v1.0","apps.serviceCenter.remoteUrl":"https://kaios-plus.kaiostech.com","apps.serviceCenter.settingsEnabled":!1,"apps.serviceCenterUrl":"https://api.kaiostech.com/v3.0","deviceinfo.build_number":"","deviceinfo.cu":"4044O-2BAQUS1-R","deviceinfo.hardware":"unknown","deviceinfo.os":"unknown","deviceinfo.product_model":"unknown","deviceinfo.platform_build_id":"","deviceinfo.platform_version":"","deviceinfo.software":"unknown","identity.kaiaccounts.api.uri":"https://api.kaiostech.com","ril.data.defaultServiceId":0,"store.nativeUpdate.enable":!1}});exports.DeviceInfo=r},function(e,exports,t){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LaunchActivityCommand=void 0;var n=t(5),r=t(4),i=t(2),o=(t(3),n.Command.extend({detail:{name:String,data:[Object],fieldsTransformToBlobs:[Array]}}).defaultTo((0,r.generateDefault)({action:i.commandList.LAUNCH_ACTIVITY})));exports.LaunchActivityCommand=o},function(e,exports,t){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CheckAppUpdateCommand=exports.MozAppUpdateCommand=exports.UpdateAppCommand=exports.LaunchAppCommand=exports.CancelDownloadCommand=exports.UninstallCommand=exports.InstallCommand=void 0;var n=t(5),r=t(4),i=t(2),o=t(14),a=t(3),s=n.Command.extend({detail:{isHosted:Boolean,manifestURL:String,jwt:[Object]}}).defaultTo((0,r.generateDefault)({action:i.commandList.INSTALL_APP})),u=n.Command.extend({detail:{manifestURL:String}}).defaultTo((0,r.generateDefault)({action:i.commandList.UNINSTALL_APP})),c=n.Command.extend({detail:{manifestURL:String}}).defaultTo((0,r.generateDefault)({action:i.commandList.CANCEL_DOWNLOAD})),l=n.Command.extend({detail:{manifestURL:String}}).defaultTo((0,r.generateDefault)({action:i.commandList.LAUNCH_APP})),f=n.Command.extend({detail:{manifestURL:String}}).defaultTo((0,r.generateDefault)({action:i.commandList.UPDATE_APP})),d=n.Command.extend({detail:{manifestURL:String,autoDownload:[Boolean]}}).defaultTo((0,r.generateDefault)({action:i.commandList.CHECK_APP_UPDATE})),p=n.Command.extend({detail:{manifestURL:String,mozAppsEvent:Object.values(a.mozAppsEvents),mozAppEvent:[String],mozApp:o.MozApp}}).defaultTo((0,r.generateDefault)({action:i.commandList.MOZAPP_UPDATE}));exports.InstallCommand=s,exports.UninstallCommand=u,exports.CancelDownloadCommand=c,exports.LaunchAppCommand=l,exports.UpdateAppCommand=f,exports.MozAppUpdateCommand=p,exports.CheckAppUpdateCommand=d},function(e,exports,t){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GetAccountVersionCommand=exports.OpenAccountCommand=exports.AccountEventCommand=void 0;var n=t(5),r=t(4),i=t(2),o=t(3),a=n.Command.extend({detail:{event:Object.values(o.accountEvent),data:[Object]}}).defaultTo((0,r.generateDefault)({action:i.commandList.ACCOUNT_EVENT})),s=n.Command.extend({detail:{section:String}}).defaultTo((0,r.generateDefault)({action:i.commandList.OPEN_ACCOUNT})),u=n.Command.extend({}).defaultTo((0,r.generateDefault)({action:i.commandList.GET_ACCOUNT_VERSION}));exports.AccountEventCommand=a,exports.OpenAccountCommand=s,exports.GetAccountVersionCommand=u},function(e,exports,t){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BookmarkUpdateCommand=exports.RequestBookmarksCommand=exports.UnPINBookmarkCommand=exports.PINBookmarkCommand=void 0;var n=t(5),r=t(4),i=t(2),o=t(14),a=n.Command.extend({}).defaultTo((0,r.generateDefault)({action:i.commandList.REQUEST_BOOKMARKS})),s=n.Command.extend({detail:o.Bookmark}).defaultTo((0,r.generateDefault)({action:i.commandList.PIN_BOOKMARK})),u=n.Command.extend({detail:{url:String}}).defaultTo((0,r.generateDefault)({action:i.commandList.UNPIN_BOOKMARK})),c=n.Command.extend({detail:{url:String,pin:Boolean,silent:[Boolean]}}).defaultTo((0,r.generateDefault)({action:i.commandList.BOOKMARK_UPDATE}));exports.PINBookmarkCommand=s,exports.UnPINBookmarkCommand=u,exports.RequestBookmarksCommand=a,exports.BookmarkUpdateCommand=c},function(e,exports,t){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RequestGetCacheCommand=exports.RequestSetCacheCommand=void 0;var n=t(5),r=t(4),i=t(2),o=n.Command.extend({detail:{key:String,item:Object}}).defaultTo((0,r.generateDefault)({action:i.commandList.SET_ITEM_TO_CACHE})),a=n.Command.extend({detail:{key:String}}).defaultTo((0,r.generateDefault)({action:i.commandList.GET_ITEM_FROM_CACHE}));exports.RequestSetCacheCommand=o,exports.RequestGetCacheCommand=a},function(e,exports,t){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.NotifyStoreCloseCommand=exports.NotifyStoreUpdatableCommand=exports.SendHttpRequestCommand=exports.CheckIfStorageEnoughCommand=exports.CheckRebootCommand=exports.RequestReloadCommand=exports.UpdateSettingCommand=exports.RequestSettingCommand=exports.RequestHasFeatureCommand=exports.RequestInstalledAppsCommand=exports.RequestTokenCommand=exports.RequestExitCommand=exports.RequestDeviceInfoCommand=void 0;var n=t(5),r=t(4),i=t(2),o=t(3),a=t(25),s=n.Command.extend({}).defaultTo((0,r.generateDefault)({action:i.commandList.REQUEST_DEVICE_INFO})),u=n.Command.extend({}).defaultTo((0,r.generateDefault)({action:i.commandList.REQUEST_EXIT})),c=n.Command.extend({detail:{refresh:Boolean}}).defaultTo((0,r.generateDefault)({action:i.commandList.REQUEST_TOKEN,detail:{refresh:!1}})),l=n.Command.extend({}).defaultTo((0,r.generateDefault)({action:i.commandList.REQUEST_INSTALLED_APPS})),f=n.Command.extend({detail:{key:String}}).defaultTo((0,r.generateDefault)({action:i.commandList.REQUEST_HAS_FEATURE})),d=n.Command.extend({detail:{key:String}}).defaultTo((0,r.generateDefault)({action:i.commandList.REQUEST_SETTING})),p=n.Command.extend({detail:a.Setting}).defaultTo((0,r.generateDefault)({action:i.commandList.UPDATE_SETTING})),h=n.Command.extend({}).defaultTo((0,r.generateDefault)({action:i.commandList.REQUEST_RELOAD})),v=n.Command.extend({}).defaultTo((0,r.generateDefault)({action:i.commandList.CHECK_REBOOT})),m=n.Command.extend({detail:{isUpdatable:Boolean}}).defaultTo((0,r.generateDefault)({action:i.commandList.NOTIFY_STORE_UPDATABLE})),g=n.Command.extend({detail:{section:Object.values(o.validStorageSections)}}).defaultTo((0,r.generateDefault)({action:i.commandList.CHECK_IF_STORAGE_ENOUGH})),y=n.Command.extend({detail:{url:String,method:String,useDeviceInfo:Boolean,appendAccountInfo:[Boolean],params:[Object,void 0]}}).defaultTo((0,r.generateDefault)({action:i.commandList.SEND_HTTP_REQUEST})),b=n.Command.extend({detail:{extraData:[Object]}}).defaultTo((0,r.generateDefault)({action:i.commandList.NOTIFY_STORE_CLOSE}));exports.RequestDeviceInfoCommand=s,exports.RequestExitCommand=u,exports.RequestTokenCommand=c,exports.RequestInstalledAppsCommand=l,exports.RequestHasFeatureCommand=f,exports.RequestSettingCommand=d,exports.UpdateSettingCommand=p,exports.RequestReloadCommand=h,exports.CheckRebootCommand=v,exports.CheckIfStorageEnoughCommand=g,exports.SendHttpRequestCommand=y,exports.NotifyStoreUpdatableCommand=m,exports.NotifyStoreCloseCommand=b},function(e,exports,t){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RequestDefaultPaymentMethodCommand=exports.RequestPaymentCommand=exports.RequestPaymentProfileCommand=void 0;var n=t(5),r=t(4),i=t(2),o=t(24),a=n.Command.extend({}).defaultTo((0,r.generateDefault)({action:i.commandList.REQUEST_PAYMENT_PROFILE})),s=n.Command.extend({detail:o.PaymentDetail}).defaultTo((0,r.generateDefault)({action:i.commandList.REQUEST_PAYMENT})),u=n.Command.extend({}).defaultTo((0,r.generateDefault)({action:i.commandList.REQUEST_DEFAULT_PAYMENT_METHOD}));exports.RequestPaymentProfileCommand=a,exports.RequestPaymentCommand=s,exports.RequestDefaultPaymentMethodCommand=u},function(e,exports,t){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TaskQueueUpdateCommand=void 0;var n=t(5),r=t(4),i=t(2),o=t(26),a=n.Command.extend({detail:o.Task}).defaultTo((0,r.generateDefault)({action:i.commandList.TASK_QUEUE_UPDATE}));exports.TaskQueueUpdateCommand=a},function(e,exports,t){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.IframeHasFocusCommand=exports.SyncLoadingProgressCommand=exports.RemoteUIReadyCommand=exports.ChangeThemeColorCommand=exports.ShowToastCommand=exports.ShowNotificationCommand=void 0;var n=t(5),r=t(27),i=t(4),o=t(2),a=n.Command.extend({detail:r.Notification}).defaultTo((0,i.generateDefault)({action:o.commandList.SHOW_NOTIFICATION})),s=n.Command.extend({detail:r.Toast}).defaultTo((0,i.generateDefault)({action:o.commandList.SHOW_TOAST})),u=n.Command.extend({detail:{content:String}}).defaultTo((0,i.generateDefault)({action:o.commandList.CHANGE_THEME_COLOR})),c=n.Command.extend({detail:{timestamp:[Number],isInlineActivity:Boolean}}).defaultTo((0,i.generateDefault)({action:o.commandList.REMOTE_UI_IS_READY})),l=n.Command.extend({detail:{percentage:[Number]}}).defaultTo((0,i.generateDefault)({action:o.commandList.SYNC_LOADING_PROGRESS})),f=n.Command.extend({detail:Boolean}).defaultTo((0,i.generateDefault)({action:o.commandList.IFRAME_HAS_FOCUS}));exports.ShowNotificationCommand=a,exports.ShowToastCommand=s,exports.ChangeThemeColorCommand=u,exports.RemoteUIReadyCommand=c,exports.SyncLoadingProgressCommand=l,exports.IframeHasFocusCommand=f},function(e,exports,t){(function(e,t){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){function r(e,t,n,r){var i=t&&t.prototype instanceof o?t:o,a=Object.create(i.prototype),s=new h(r||[]);return a._invoke=l(e,n,s),a}function i(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(r){return{type:"throw",arg:r}}}function o(){}function a(){}function s(){}function u(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function c(t){function r(e,o,a,s){var u=i(t[e],t,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"===("undefined"==typeof l?"undefined":n(l))&&b.call(l,"__await")?Promise.resolve(l.__await).then(function(e){r("next",e,a,s)},function(e){r("throw",e,a,s)}):Promise.resolve(l).then(function(e){c.value=e,a(c)},s)}s(u.arg)}function o(e,t){function n(){return new Promise(function(n,i){r(e,t,n,i)})}return a=a?a.then(n,n):n()}"object"===n(e.process)&&e.process.domain&&(r=e.process.domain.bind(r));var a;this._invoke=o}function l(e,t,n){var r=C;return function(o,a){if(r===O)throw new Error("Generator is already running");if(r===I){if("throw"===o)throw a;return m()}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=f(s,n);if(u){if(u===P)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===C)throw r=I,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=O;var c=i(e,t,n);if("normal"===c.type){if(r=n.done?I:T,c.arg===P)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r=I,n.method="throw",n.arg=c.arg)}}}function f(e,t){var n=e.iterator[t.method];if(n===g){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=g,f(e,t),"throw"===t.method))return P;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return P}var r=i(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,P;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=g),t.delegate=null,P):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,P)}function d(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function p(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function h(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(d,this),this.reset(!0)}function v(e){if(e){var t=e[_];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(b.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=g,t.done=!0,t};return r.next=r}}return{next:m}}function m(){return{value:g,done:!0}}var g,y=Object.prototype,b=y.hasOwnProperty,w="function"==typeof Symbol?Symbol:{},_=w.iterator||"@@iterator",S=w.asyncIterator||"@@asyncIterator",E=w.toStringTag||"@@toStringTag",k="object"===n(t),A=e.regeneratorRuntime;if(A)return void(k&&(t.exports=A));A=e.regeneratorRuntime=k?t.exports:{},A.wrap=r;var C="suspendedStart",T="suspendedYield",O="executing",I="completed",P={},R={};R[_]=function(){return this};var M=Object.getPrototypeOf,L=M&&M(M(v([])));L&&L!==y&&b.call(L,_)&&(R=L);var U=s.prototype=o.prototype=Object.create(R);a.prototype=U.constructor=s,s.constructor=a,s[E]=a.displayName="GeneratorFunction",A.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===a||"GeneratorFunction"===(t.displayName||t.name))},A.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,E in e||(e[E]="GeneratorFunction")),e.prototype=Object.create(U),e},A.awrap=function(e){return{__await:e}},u(c.prototype),c.prototype[S]=function(){return this},A.AsyncIterator=c,A.async=function(e,t,n,i){var o=new c(r(e,t,n,i));return A.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},u(U),U[E]="Generator",U[_]=function(){return this},U.toString=function(){return"[object Generator]"},A.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},A.values=v,h.prototype={constructor:h,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=g,this.done=!1,this.delegate=null,this.method="next",this.arg=g,this.tryEntries.forEach(p),!e)for(var t in this)"t"===t.charAt(0)&&b.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=g)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){function t(t,r){return o.type="throw",o.arg=e,n.next=t,r&&(n.method="next",n.arg=g),!!r}if(this.done)throw e;for(var n=this,r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],o=i.completion;if("root"===i.tryLoc)return t("end");if(i.tryLoc<=this.prev){var a=b.call(i,"catchLoc"),s=b.call(i,"finallyLoc");if(a&&s){if(this.prev<i.catchLoc)return t(i.catchLoc,!0);if(this.prev<i.finallyLoc)return t(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return t(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return t(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&b.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,P):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),P},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),p(n),P}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;p(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:v(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=g),P}}}("object"===("undefined"==typeof e?"undefined":n(e))?e:"object"===("undefined"==typeof window?"undefined":n(window))?window:"object"===("undefined"==typeof self?"undefined":n(self))?self:void 0)}).call(exports,function(){return this}(),t(60)(e))},function(e,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t={_providers:new Map,_services:new Map,_requestsByService:new Map,_requestsByProvider:new Map,request:function(e){var t=e.split(":"),n=Array.prototype.slice.call(arguments,1),r=this;if(this.debug(t),t.length>1){var i=t[0],o=t[1];return this._providers.get(i)?(this.debug("service: "+o+" is online, perform the request with "+n.concat()),Promise.resolve(this._providers.get(i)[o].apply(r._providers.get(i),n))):new Promise(function(t,a){r.debug("service: "+e+" is offline, queue the task."),r._requestsByProvider.has(i)||r._requestsByProvider.set(i,[]),r._requestsByProvider.get(i).push({service:o,resolve:t,args:n})})}if(this._services.has(e)){var a=this._services.get(e);return this.debug("service ["+e+"] provider ["+a.name+"] is online, perform the task."),Promise.resolve(a[e].apply(a,n))}return this.debug("service: "+e+" is offline, queue the task."),new Promise(function(t,i){r.debug("storing the requests..."),r._requestsByService.has(e)||r._requestsByService.set(e,[]),r._requestsByService.get(e).push({service:e,resolve:t,args:n})})},register:function(e,t){var n=this;return this._providers.has(t.name)||this._providers.set(t.name,t),this.debug((t.name||"(Anonymous)")+" is registering service: ["+e+"]"),this.debug("checking awaiting requests by server.."),this._requestsByProvider.has(t.name)&&(this._requestsByProvider.get(t.name).forEach(function(e){n.debug("resolving..",t,t.name,e.service,e.args);var r="function"==typeof t[e.service]?t[e.service].apply(t,e.args):t[e.service];e.resolve(r)}),this._requestsByProvider.delete(t.name)),this._services.has(e)?void this.debug("the service ["+e+"] has already been registered by other server:",this._services.get(e).name):(this._services.set(e,t),this.debug("checking awaiting requests by service.."),void(this._requestsByService.has(e)&&(this._requestsByService.get(e).forEach(function(e){n.debug("resolving..",t,e.service);var r=t[e.service].apply(t,e.args);e.resolve(r)}),this._requestsByService.delete(e))))},unregister:function(e,t){this._providers.delete(t.name);var n=this._services.get(e);n&&t===n&&this._services.delete(e);},_states:new Map,_statesByState:new Map,registerState:function(e,t){this._states.set(t.name,t),t.name||console.warn(t),this._statesByState.set(e,t)},unregisterState:function(e,t){this._states.delete(t.name),this._statesByState.get(e)===t&&this._statesByState.delete(e)},query:function(e){this.debug(e);var t,n,r=e.split(".");if(r.length>1?(n=this._states.get(r[0]),t=r[1]):(t=r[0],n=this._statesByState.get(t)),!n)return void this.debug("Provider not ready, return undefined state.");if("function"==typeof n[t]){var i=Array.prototype.slice.call(arguments,1);return n[t].apply(n,i)}return n[t]},_start:(new Date).getTime()/1e3,currentTime:function(){return((new Date).getTime()/1e3-this._start).toFixed(3)},debug:function(){}};exports.default=t},function(e,exports){"use strict";function t(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function n(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function r(e,t){return C(e)?new o(e,t):new i(e)}function i(e){return N(e,i)}function o(e){return N(e,o,Object,D,function(t){return ne(t,e)},!0)}function a(e){var t=ie(Array,a,e,function(e){return Array.isArray(e)?e.map(function(e){return ee(e,t.definition)}):e},function(e){return[].concat(n(e))},{copyWithin:[],fill:[0,0],pop:[],push:[0],reverse:[],shift:[],sort:[],splice:[2],unshift:[0]},{set:function(e,n,r){return oe(t,e,n,r,function(e,t){return e[n]=t},!0)},deleteProperty:function(e,n){return oe(t,e,n,void 0,function(e){return delete e[n]})}});return t}function s(e){var t=ie(Set,s,e,function(e){return T(e)?new Set([].concat(n(e)).map(function(e){return ee(e,t.definition)})):e},function(e){return new Set(e)},{add:[0,0],delete:[],clear:[]});return t}function u(e,t){var r=function(e){return 0===e?i.definition.key:i.definition.value},i=ie(Map,u,{key:e,value:t},function(e){return T(e)?new Map([].concat(n(e)).map(function(e){return e.map(function(e,t){return ee(e,r(t))})})):e},function(e){return new Map(e)},{set:[0,1,r],delete:[],clear:[]});return i}function c(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return N({arguments:t},c,Function,null,function(e){return{getPrototypeOf:function(){return e.prototype},get:function(e,t){return t===U?e:e[t]},apply:function(t,n,r){for(var i=e.definition,o=i.arguments.find(function(e){return S(re.remaining,e)}),a=o?Math.max(r.length,i.arguments.length-1):i.arguments.length,s=0;s<a;s++){var u=o&&s>=i.arguments.length-1?o.definition:i.arguments[s];r[s]=G(r[s],u,"arguments["+s+"]",e.errors,[],!0)}W(r,e,"arguments");var c=void 0;return e.errors.length||(c=Reflect.apply(t,n,r),"return"in i&&(c=G(c,i.return,"return value",e.errors,[],!0))),B(e),c}}})}Object.defineProperty(exports,"__esModule",{value:!0});var l,f,d,p,h=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(u){i=!0,o=u}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g=Object.prototype,y=function(e){return g.toString.call(e).match(/\s([a-zA-Z]+)/)[1]},b=Object.getPrototypeOf,w=Object.setPrototypeOf,_=function(e,t){return g.hasOwnProperty.call(e,t)},S=function(e,t){return t instanceof e},E=function(e){return"function"==typeof e},k=function(e){return e&&"object"===("undefined"==typeof e?"undefined":m(e))},A=function(e){return"string"==typeof e},C=function(e){return k(e)&&b(e)===g},T=function(e){return e&&E(e[Symbol.iterator])},O=function(e,t){return new Proxy(e,t)},I=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};for(var r in n)if(C(n[r])){var i={};e(i,t[r]),e(i,n[r]),t[r]=i}else t[r]=n[r];return t},P=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Object.defineProperty(e,t,{value:n,enumerable:r,writable:!0,configurable:!0})},R=function(e,t,n){e.prototype=Object.assign(Object.create(t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n),w(e,t)},M=Symbol(),L=Symbol(),U=Symbol(),N=function(e,t,r,i,o,a){var s=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.default,n=arguments[1];return a&&!S(e,this)?new e(t):(i&&(t=i(t,e,this)),n===L||V(e,t)?o?O(t,o(e)):t:void 0)};return r&&R(s,r),w(s,t.prototype),s.constructor=t,s.definition=e,s.assertions=[].concat(n(s.assertions)),P(s,"errors",[]),delete s.name,s},D=function(e,t,n){return S(t,e)?e:(k(e)||E(e)||void 0===e||j(t.errors,Object,e),I(n,t.default),t.parentClass&&I(e,new t.parentClass(e)),I(n,e),n)},x=function(e,t,r){var i;return R(e,t,r),(i=e.assertions).push.apply(i,n(t.assertions)),e},j=function(e,t,n,r,i){e.push({expected:t,received:n,path:r,message:i})},B=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.errorCollector,n=e.errors.length;if(n>0){var r=e.errors.map(function(e){return e.message||(e.message="expecting "+(e.path?e.path+" to be ":"")+H(e.expected)+", got "+(null!=e.received?y(e.received)+" ":"")+Q(e.received)),e});e.errors.length=0,t.call(e,r)}return n},F=function(e){return e&&b(e)&&S(r,b(e).constructor)},z=function e(t){if(C(t)){t={};for(var n in t)t[n]=e(t[n])}else{if(!Array.isArray(t))return[t];if(1===t.length)return[t[0],void 0,null]}return t},H=function(e,t){var n=z(e).map(function(e){return Q(e,t)});return n.length>1?n.join(" or "):n[0]},K=function(e){return e.length?"("+e.map(function(e){return e.name||e.description||e})+")":""},q=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(t.length>0){var r;e=(r=[]).concat.apply(r,[e].concat(n([].concat(t)))).filter(function(e,t,n){return n.indexOf(e)===t})}return e},V=function(e,t){return e[M](t,null,e.errors,[],!0),!B(e)},G=function e(t,n,i,o,a,s){var u=a.indexOf(n);if(u!==-1&&a.indexOf(n,u+1)!==-1)return t;if(Array.isArray(n)&&1===n.length&&null!=t&&(n=n[0]),S(r,n))s&&(t=ee(t,n)),n[M](t,i,o,a.concat(n));else if(C(n))for(var c in n){var l=t?t[c]:void 0;e(l,n[c],J(i,c),o,a,s)}else{var f=z(n);if(f.some(function(e){return Y(t,e,i,a)}))return s?ee(t,n):t;j(o,n,t,i)}return t},Y=function(e,t,n,i,o){if(t===re)return!0;if(null==e)return e===t;if(C(t)||S(r,t)){var a=[];return G(e,t,n,a,i,o),!a.length}return S(RegExp,t)?t.test(e):t===Number||t===Date?e.constructor===t&&!isNaN(e):e===t||E(t)&&S(t,e)||e.constructor===t},W=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.errors,i=!0,o=!1,a=void 0;try{for(var s,u=function(){var i=s.value,o=void 0;try{o=i.call(t,e)}catch(a){o=a}if(o!==!0){j(r,i,e,n,(E(i.description)?i.description:function(e,t){return'assertion "'+i.description+'" returned '+Q(e)+" "+("for "+(n?n+" =":"value")+" "+Q(t))}).call(t,o,e,n))}},c=t.assertions[Symbol.iterator]();!(i=(s=c.next()).done);i=!0)u()}catch(l){o=!0,a=l}finally{try{!i&&c.return&&c.return()}finally{if(o)throw a}}},Q=function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(i.length>15||i.includes(t))return"...";if(null===t||void 0===t)return String(t);if(A(t))return'"'+t+'"';if(S(r,t))return t.toString(i);if(i.unshift(t),E(t))return t.name||t.toString();if(S(Map,t)||S(Set,t))return e([].concat(n(t)));if(Array.isArray(t))return"["+t.map(function(t){return e(t,i)}).join(", ")+"]";if(t.toString&&t.toString!==g.toString)return t.toString();if(k(t)){var o=Object.keys(t),a="\t".repeat(i.length);return"{"+o.map(function(r){return"\n"+(a+r)+": "+e(t[r],[].concat(n(i)))}).join(", ")+" "+(o.length?"\n"+a.slice(1):"")+"}"}return String(t)},J=function(e,t){return e?e+"."+t:t},X=function(e,t,n,r,i,o,a){var s=J(n,i),u=e.conventionForPrivate(i),c=e.conventionForConstant(i),l=_(r,i),f=l&&Object.getOwnPropertyDescriptor(r,i);i in t&&(u&&!o||c&&void 0!==r[i])&&Z("modify "+(u?"private":"constant")+" property "+i,e),a(),_(t,i)&&G(r[i],t[i],s,e.errors,[]),W(r,e,s);var d=e.errors.length;return d&&(l?Object.defineProperty(r,i,f):delete r[i],B(e)),!d},Z=function(e,t){t.errors.push({message:"cannot "+e})},ee=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!e||C(t)||S(i,t)||F(e))return e;var n=z(t),o=[],a=!0,s=!1,u=void 0;try{for(var c,l=n[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var f=c.value;S(r,f)&&!S(i,f)&&f.test(e)&&o.push(f)}}catch(d){s=!0,u=d}finally{try{!a&&l.return&&l.return()}finally{if(s)throw u}}return 1===o.length?new o[0](e,L):(o.length>1&&console.warn("Ambiguous model for value "+Q(e)+", could be "+o.join(" or ")),e)},te=function(e,t,n,r,i){return C(n)?O(e,ne(t,n,r,i)):ee(e,n)},ne=function(e,t,n,r){var i=function(e){return O(e,{apply:function(e,t,n){r=!0;var i=Reflect.apply(e,t,n);return r=!1,i}})};return{get:function(o,a){if(a===U)return o;if(!A(a))return Reflect.get(o,a);var s=J(n,a),u=_(t,a),c=t[a];if(!r&&u&&e.conventionForPrivate(a))return Z("access to private property "+s,e),void B(e);var l=o[a];return u&&l&&_(o,a)&&!C(c)&&!F(l)&&Reflect.set(o,a,l=ee(l,c)),E(l)&&"constructor"!==a&&!r?i(l):(C(c)&&!l&&(o[a]=l={}),te(l,e,c,s,r))},set:function(i,o,a){return X(e,t,n,i,o,r,function(){return Reflect.set(i,o,ee(a,t[o]))})},deleteProperty:function(i,o){return X(e,t,n,i,o,r,function(){return Reflect.deleteProperty(i,o)})},defineProperty:function(i,o,a){return X(e,t,n,i,o,r,function(){return Reflect.defineProperty(i,o,a)})},has:function(n,r){return Reflect.has(n,r)&&Reflect.has(t,r)&&!e.conventionForPrivate(r)},ownKeys:function(n){return Reflect.ownKeys(n).filter(function(n){return Reflect.has(t,n)&&!e.conventionForPrivate(n)})},getOwnPropertyDescriptor:function(n,r){var i=void 0;return e.conventionForPrivate(r)||(i=Object.getOwnPropertyDescriptor(t,r),void 0!==i&&(i.value=n[r])),i}}};Object.assign(r.prototype,(l={name:"Model",assertions:[],conventionForConstant:function(e){return e.toUpperCase()===e},conventionForPrivate:function(e){return"_"===e[0]},toString:function(e){return _(this,"name")?this.name:H(this.definition,e)+K(this.assertions)},as:function(e){return P(this,"name",e),this},defaultTo:function(e){return this.default=e,this}},t(l,M,function(e,t,n,r){G(e,this.definition,t,n,r),W(e,this,t,n)}),t(l,"test",function(e,t){for(var n=this,r=this;!_(r,"errorCollector");)r=b(r);var i=r.errorCollector,o=void 0;return r.errorCollector=function(e){o=!0,t&&t.call(n,e)},new this(e),r.errorCollector=i,!o}),t(l,"errorCollector",function(e){var t=new TypeError(e.map(function(e){return e.message}).join("\n"));throw t.stack=t.stack.replace(/\n.*object-model(.|\n)*object-model.*/,""),t}),t(l,"assert",function(e){return P(e,"description",arguments.length>1&&void 0!==arguments[1]?arguments[1]:Q(e)),this.assertions=this.assertions.concat(e),this}),l)),R(i,r,{extend:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var o=x(new i(q(this.definition,t)),this),a=!0,s=!1,u=void 0;try{for(var c,l=t[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var f,d=c.value;S(i,d)&&(f=o.assertions).push.apply(f,n(d.assertions))}}catch(p){s=!0,u=p}finally{try{!a&&l.return&&l.return()}finally{if(s)throw u}}return o}}),R(o,r,t({defaultTo:function(e){var t=this.definition;for(var n in e)_(t,n)&&(e[n]=G(e[n],t[n],n,this.errors,[],!0));return B(this),this.default=e,this},toString:function(e){return Q(this.definition,e)},extend:function(){for(var e=v({},this.definition),t=v({},this.prototype),i=v({},this.default),a=[],s=arguments.length,u=Array(s),c=0;c<s;c++)u[c]=arguments[c];var l=!0,f=!1,d=void 0;try{for(var p,h=u[Symbol.iterator]();!(l=(p=h.next()).done);l=!0){var m=p.value;S(r,m)&&(I(e,m.definition),I(i,m.default),a.push.apply(a,n(m.assertions))),E(m)&&I(t,m.prototype),k(m)&&I(e,m)}}catch(g){f=!0,d=g}finally{try{!l&&h.return&&h.return()}finally{if(f)throw d}}var y=x(new o(e),this,t).defaultTo(i);return y.assertions=[].concat(n(this.assertions),a),b(this)!==o.prototype&&(y.parentClass=this),y}},M,function(e,t,n,r,i){k(e)?G(e[U]||e,this.definition,t,n,r,i):j(n,this,e,t),W(e,this,t,n)}));var re=O(i(),{apply:function(e,t,n){var r=h(n,1),i=r[0],o=Object.create(re);return o.definition=i,o}});re.definition=re,re.toString=function(){return"Any"},re.remaining=function(e){this.definition=e},R(re.remaining,re,{toString:function(){return"..."+H(this.definition)}}),re[Symbol.iterator]=regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new re.remaining(this.definition);case 2:case"end":return e.stop()}},e,this)});var ie=function(e,t,n,r,i,o,a){return N(n,t,e,r,function(t){return Object.assign({getPrototypeOf:function(){return t.prototype},get:function(n,r){if(r===U)return n;var a=n[r];return E(a)?O(a,{apply:function(a,s,u){if(_(o,r)){for(var c=h(o[r],3),l=c[0],f=c[1],d=void 0===f?u.length-1:f,p=c[2],v=l;v<=d;v++){var m=p?p(v):t.definition;u[v]=G(u[v],m,e.name+"."+r+" arguments["+v+"]",t.errors,[],!0)}if(t.assertions.length>0){var g=i(n);a.apply(g,u),W(g,t,"after "+r+" mutation")}B(t)}return a.apply(n,u)}}):a}},a)})};R(a,r,(f={toString:function(e){return"Array of "+H(this.definition,e)}},t(f,M,function(e,t,n,r){var i=this;Array.isArray(e)?(e[U]||e).forEach(function(e,o){return G(e,i.definition,(t||"Array")+"["+o+"]",n,r)}):j(n,this,e,t),W(e,this,t,n)}),t(f,"extend",function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return x(new a(q(this.definition,t)),this)}),f));var oe=function(e,t,r,i,o,a){var s="Array["+r+"]";+r>=0&&(a||r in t)&&(i=G(i,e.definition,s,e.errors,[],!0));var u=[].concat(n(t));o(u),W(u,e,s);var c=!B(e);return c&&o(t,i),c};R(s,r,(d={toString:function(e){return"Set of "+H(this.definition,e)}},t(d,M,function(e,t,n,r){if(S(Set,e)){var i=!0,o=!1,a=void 0;try{for(var s,u=e.values()[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){G(s.value,this.definition,(t||"Set")+" value",n,r)}}catch(c){o=!0,a=c}finally{try{!i&&u.return&&u.return()}finally{if(o)throw a}}}else j(n,this,e,t);W(e,this,t,n)}),t(d,"extend",function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return x(new s(q(this.definition,t)),this)}),d)),R(u,r,(p={toString:function(e){return"Map of "+H(this.definition.key,e)+" : "+H(this.definition.value,e)}},t(p,M,function(e,t,n,r){if(S(Map,e)){t=t||"Map";var i=!0,o=!1,a=void 0;try{for(var s,u=e[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=h(s.value,2),l=c[0],f=c[1];G(l,this.definition.key,t+" key",n,r),G(f,this.definition.value,t+"["+Q(l)+"]",n,r)}}catch(d){o=!0,a=d}finally{try{!i&&u.return&&u.return()}finally{if(o)throw a}}}else j(n,this,e,t);W(e,this,t,n)}),t(p,"extend",function(e,t){return x(new u(q(this.definition.key,e),q(this.definition.value,t)),this)}),p)),R(c,r,t({toString:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t="Function("+this.definition.arguments.map(function(t){return H(t,[].concat(n(e)))}).join(", ")+")";return"return"in this.definition&&(t+=" => "+H(this.definition.return,e)),t},return:function(e){return this.definition.return=e,this},extend:function(e,t){var r=this.definition.arguments,i=e.map(function(t,n){return q(n in r?r[n]:[],e[n])}),o=q(this.definition.return,t);return x((new(Function.prototype.bind.apply(c,[null].concat(n(i))))).return(o),this)}},M,function(e,t,n){E(e)||j(n,"Function",e,t)}));var ae={list:"list-style-type: none; padding: 0; margin: 0;",listItem:"padding: 0 0 0 1em;",model:"color: #3e999f;",instance:"color: #718c00; font-style: italic",function:"color: #4271AE",string:"color: #C41A16",number:"color: #1C00CF",boolean:"color: #AA0D91",property:"color: #8959a8",private:"color: #C19ED8",constant:"color: #8959a8; font-weight: bold",privateConstant:"color: #C19ED8; font-weight: bold",null:"color: #8e908c",undeclared:"color: #C0C0C0;",proto:"color: #B871BD; font-style: italic"},se=function(e){if(void 0===e||null===e)return null;var t=b(e);return t&&t.constructor&&S(r,t.constructor)?t.constructor:null},ue=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return["span",{style:e}].concat(n)},ce=function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null===t||void 0===t?ue(ae.null,""+t):"boolean"==typeof t?ue(ae.boolean,t):"number"==typeof t?ue(ae.number,t):"string"==typeof t?ue(ae.string,'"'+t+'"'):Array.isArray(t)&&i.isModelDefinition?ue.apply(void 0,[""].concat(n(t.flatMap(function(t){return[e(t,i)," or "]}).slice(0,-1)))):C(t)?le(t,se(t),i):E(t)&&!S(r,t)&&i.isModelDefinition?ue(ae.function,t.name||t.toString()):["object",{object:t,config:i}]},le=function(e,t,r){return ue("","{",["ol",{style:ae.list}].concat(n(Object.keys(e).map(function(t){return["li",{style:ae.listItem},ue(ae.property,t),": ",ce(e[t],r)]}))),"}")},fe=function(e){var t={isModelDefinition:!0},r=e.definition,o=function(e,t){return e.flatMap(function(e){return[t(e),", "]}).slice(0,-1)},l=[];if(S(i,e)&&(l=[ce(r,t)]),S(a,e)&&(l=["Array of ",ce(r,t)]),S(s,e)&&(l=["Set of ",ce(r,t)]),S(u,e)&&(l=["Map of ",ce(r.key,t)," : ",ce(r.value,t)]),S(c,e)&&(l=["Function("].concat(n(o(r.arguments,function(e){return ce(e,t)})),[")"]),"return"in r&&l.push(" => ",ce(r.return,t))),e.assertions.length>0){var f;(f=l).push.apply(f,["\n(assertions: "].concat(n(o(e.assertions,function(e){return["object",{object:e}]})),[")"]))}return ue.apply(void 0,[ae.model].concat(n(l)))},de={header:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e===re?ue(ae.model,"Any"):S(re.remaining,e)?ue(ae.model,"...",ce(e.definition,{isModelDefinition:!0})):S(o,e)?ue(ae.model,e.name):S(r,e)?fe(e):t.isModelDefinition&&C(e)?ce(e,t):null},hasBody:function(e){return S(o,e)},body:function(e){return ue("","{",["ol",{style:ae.list}].concat(n(Object.keys(e.definition).map(function(t){var n=e.conventionForPrivate(t),r=e.conventionForConstant(t),i=e.default&&_(e.default,t),o=ae.property;return n?o=r?ae.privateConstant:ae.private:r&&(o=ae.constant),["li",{style:ae.listItem},ue(o,t),": ",ce(e.definition[t],{isModelDefinition:!0}),i?ue(ae.proto," = ",ce(e.default[t])):""]}))),"}")}},pe={header:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t.isInstanceProperty&&C(e))return ce(e,t);var n=se(e);if(S(r,n)){var i=S(o,n)?[n.name]:[["object",{object:e[U]}]," ("+n.name+")"];return ue.apply(void 0,[ae.instance].concat(i))}return null},hasBody:function(e){return e&&S(o,se(e))},body:function(e){var t=se(e),r=e[U]||e;return ue("","{",["ol",{style:ae.list}].concat(n(Object.keys(r).map(function(e){var n=t.conventionForPrivate(e),i=t.conventionForConstant(e),o=e in t.definition,a=ae.property;return o?n?a=i?ae.privateConstant:ae.private:i&&(a=ae.constant):a=ae.undeclared,["li",{style:ae.listItem},ue(a,e),": ",ce(r[e],{isInstanceProperty:!0})]})),[["li",{style:ae.listItem},ue(ae.proto,"__proto__",": ",["object",{object:b(e)}])]]),"}")}};"undefined"!=typeof window&&(window.devtoolsFormatters=(window.devtoolsFormatters||[]).concat(de,pe)),exports.Any=re,exports.ArrayModel=a,exports.BasicModel=i,exports.FunctionModel=c,exports.MapModel=u,exports.Model=r,exports.ObjectModel=o,exports.SetModel=s},function(e,exports,t){"use strict";function n(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=new r.SimpleResult(e);n&&(o=(0,i.simpleObject)(o)),t.postMessage(o,"*")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.response=n;var r=t(29),i=t(15)},function(e,exports){"use strict";function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var n=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),r=function(){function e(){t(this,e),this.onReceiveMessage=null}return n(e,[{key:"start",value:function(e){this.onReceiveMessage=e,window.addEventListener("message:action",this.onReceiveMessage,!1)}},{key:"stop",value:function(){this.onReceiveMessage&&window.removeEventListener("message:action",this.onReceiveMessage)}}]),e}();exports.default=r=new r},function(e,exports,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=t(15),o=function(){function e(){var t=this;n(this,e),this.receiveMessage=function(e){var n=e.data,r=e.source,i=e.origin;if(t.checkOriginPermission(i)===!1)return void console.error("[receiveMessage] message received from unpermitted origin"+(" "+i+". Abort."));var o=n.id,a=n.action,s=n.detail,u=n.success;if(a){n.source=r;var c=new CustomEvent("message:action",{detail:n});window.dispatchEvent(c)}else t.twoWayMessageCallbacks[o]&&(t.twoWayMessageCallbacks[o](u,s),delete t.twoWayMessageCallbacks[o])},this.target=window.parent,this.twoWayMessageCallbacks={},this.messageQueue=[],this.remoteReady=!1,this.targetOrigin="*",this.validMessageOrigins="*"}return r(e,[{key:"start",value:function(){window.addEventListener("message",this.receiveMessage,!1)}},{key:"stop",value:function(){window.removeEventListener("message",this.receiveMessage)}},{key:"send",value:function(e,t){if("undefined"==typeof this.target)return!1;e.id=e.id+(0,i.hashCode)(JSON.stringify(e)),t&&(this.twoWayMessageCallbacks[e.id]=t);var n=(0,i.simpleObject)(e);this.remoteReady?this.target.postMessage(n,this.targetOrigin):this.messageQueue.push(n)}},{key:"postFullQueue",value:function(){for(;this.messageQueue.length>0;)this.postNext()}},{key:"postNext",value:function(){var e=this.messageQueue.shift();return!!e&&(this.target.postMessage(e,this.targetOrigin),!0)}},{key:"checkOriginPermission",value:function(e){var t=this.validMessageOrigins;return"*"===t||(!(!Array.isArray(t)||!t.includes(e))||"string"==typeof t&&t===e)}}]),e}();exports.default=o=new o},function(e,exports){"use strict";e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=t(13),s=n(a);t(77);var u=function(){function e(){var t=this;r(this,e),this.handleKeydown=function(e){switch(e.key){case"ArrowDown":e.stopPropagation(),e.preventDefault(),t.scrollContent(1);break;case"ArrowUp":e.stopPropagation(),e.preventDefault(),t.scrollContent(-1);break;case"Enter":if(e.stopPropagation(),e.preventDefault(),"custom"===t.props.type){if(3===t.props.buttons.length){var n={selectedButton:1};if(t.props.showCheckbox){var r=t.checkbox.dataset.icon;n.checked="check-on"===r}t.props.onOk&&t.props.onOk(n),t.props.noClose||t.hide()}else if(t.props.showCheckbox&&document.activeElement===t.checkboxContainer){var i=t.checkbox.dataset.icon;t.checkbox.dataset.icon="check-on"===i?"check-off":"check-on",t.updateSoftKeys()}}else"alert"===t.props.type&&(t.props.onOk&&t.props.onOk(),t.props.noClose||t.hide());break;case"F1":case"SoftLeft":if(e.stopPropagation(),e.preventDefault(),"custom"===t.props.type){var o={selectedButton:0};t.props.showCheckbox&&(o.checked="check-on"===t.checkbox.dataset.icon),t.props.onOk&&t.props.onOk(o)}else if("alert"!==t.props.type){if(t.props.hideCancel)return;t.props.onCancel&&t.props.onCancel()}"alert"===t.props.type||t.props.noClose||t.hide();break;case"F2":case"SoftRight":if(e.stopPropagation(),e.preventDefault(),t.props.hideCancel)return;if("INPUT"===document.activeElement.tagName&&!document.activeElement.value&&t.props.hideOkWhenNoInputValue)return;if("custom"===t.props.type){var a={selectedButton:3===t.props.buttons.length?2:1};t.props.showCheckbox&&(a.checked=t.checkbox.checked),t.props.onOk&&t.props.onOk(a)}else"prompt"===t.props.type?t.props.onOk&&t.props.onOk(t.input.value):"confirm"===t.props.type&&t.props.onOk&&t.props.onOk();t.props.noClose||"alert"===t.props.type||t.hide();break;case"BrowserBack":case"Backspace":case"EndCall":if("INPUT"===document.activeElement.tagName&&document.activeElement.value)return;if(e.stopPropagation(),e.preventDefault(),t.props.hideCancel)return;t.props.onBack&&t.props.onBack(),t.props.noClose||t.hide()}},this.name="Dialog",this.props={header:"",content:"",type:"confirm",inputType:"text",inputMode:"",ok:"",cancel:"",onOk:null,onBack:null,onCancel:null,onHide:null,onBlur:null,translated:!1,buttons:[],showCheckbox:!1,checkboxCheckedByDefault:!1,checkboxMessage:"",placeholder:"",initialValue:"",additionalContent:null,maxLength:100,progressValue:"",progressMax:"",noClose:!1,noFocus:!1,hideCancel:!1,hideOkWhenNoInputValue:!1},this.init()}return o(e,[{key:"init",value:function(){this.render(),this.element.addEventListener("keydown",this.handleKeydown),this.updateSoftKeys()}},{key:"render",value:function(){var e=document.querySelector("#root"),t=document.createDocumentFragment(),n=document.createElement("div"),r=document.createElement("div"),i=document.createElement("div"),o=document.createElement("div");n.id="dialog",n.className="dialog-container hidden",n.setAttribute("tabindex","-1"),r.setAttribute("role","heading"),r.className="dialog",i.id="dialog-header",i.className="header h1",o.id="dialog-content",o.className="content p-ul",o.setAttribute("tabindex","-1"),r.appendChild(i),r.appendChild(o),n.appendChild(r),t.appendChild(n),e.appendChild(t),this.element=document.querySelector("#dialog"),this.content=document.querySelector("#dialog-content")}},{key:"scrollContent",value:function(e){if(this.content){var t=this.content.scrollHeight-this.content.clientHeight;if(0==this.content.scrollTop&&e<0||this.content.scrollTop==t&&e>0)return!1;var n,r=this.content.clientHeight-41;return e>0?n=this.content.scrollTop+r:e<0&&(n=this.content.scrollTop-r),n<0?n=0:n>t&&(n=t),this.content.scrollTo(0,n),!0}}},{key:"updateSoftKeys",value:function(){var e={},t=this.element;if("alert"===this.props.type)e={center:this.props.ok||"ok"};else if("progress"===this.props.type)e={left:this.props.hideCancel?"":this.props.cancel||"cancel"};else if("custom"!==this.props.type){var n=this.props.hideOkWhenNoInputValue&&!this.input.value;e={left:this.props.cancel||"cancel",right:n?"":this.props.ok||"ok"}}else{var r=this.props.buttons;if(2===r.length&&this.checkbox)e={center:"check-on"===this.checkbox.dataset.icon?"off":"on"},t=this.checkboxContainer;else{var o={1:["center"],2:["left","right"],3:["left","center","right"]};e=o[r.length].reduce(function(e,t,n){return e[t]=r[n].message,e},{})}}["left","center","right"].forEach(function(t){e[t]||(e[t]="")}),s.default.register(i({},e,{theme:"flat-button-theme"}),t)}},{key:"focus",value:function(){this.focusIfPossible(),this.updateSoftKeys()}},{key:"focusIfPossible",value:function(){this.isHidden()||(this.content?this.content.focus():this.element.focus())}},{key:"prepareDialog",value:function(e){var t=document.querySelector("#dialog-header"),n=document.querySelector("#dialog-content");this.props=i({},this.props,e),t.dataset.l10nId=this.props.header,e.translated?n.textContent=this.props.content:n.dataset.l10nId=this.props.content}},{key:"show",value:function(){this.element&&(this.element.classList.remove("hidden"),this.focus(),this.emit("opened"))}},{key:"hide",value:function(){this.element&&(this.element.classList.add("hidden"),this.emit("closed"))}},{key:"isHidden",value:function(){return!this.element||this.element.classList.contains("hidden")}},{key:"emit",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this._ensureValidEventName(e),this.listeners||(this.listeners=new Map);var i=this.listeners.get(e);i&&i.forEach(function(e){try{e.apply(null,n)}catch(t){console.error(t)}})}},{key:"on",value:function(e,t){this._ensureValidEventName(e),this._ensureValidHandler(t),this.listeners||(this.listeners=new Map);var n=this.listeners.get(e);n||(n=new Set,this.listeners.set(e,n)),n.add(t)}},{key:"_ensureValidEventName",value:function(e){if(!e||"string"!=typeof e)throw new Error("Event name should be a valid non-empty string!")}},{key:"_ensureValidHandler",value:function(e){if("function"!=typeof e)throw new Error("Handler should be a function!")}}]),e}();exports.default=u},function(e,exports,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t(78);var i=function(){function e(){n(this,e),this.createPanel(),this.element=document.querySelector("#leaving"),this.text=document.querySelector(".loader-text")}return r(e,[{key:"createPanel",value:function(){var e=document.querySelector("#root"),t=document.createDocumentFragment(),n=document.createElement("div"),r=document.createElement("div"),i=document.createElement("div"),o=document.createElement("p");n.id="leaving",n.className="leaving hidden",n.setAttribute("tabindex","-1"),r.className="container",i.className="loader-icon";for(var a=0;a<3;a++)this.createSpinElement(i,1===a);o.className="loader-text",r.appendChild(i),r.appendChild(o),n.appendChild(r),t.appendChild(n),e.appendChild(n)}},{key:"createSpinElement",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e){var n=document.createDocumentFragment(),r=document.createElement("div"),i=document.createElement("div");["upper-circle","trunk-rect","lower-circle"].forEach(function(e){var t=document.createElement("div");t.className=e,i.appendChild(t)}),i.className="spinning",r.className="stick jumping"+(t?" middle":""),r.appendChild(i),n.appendChild(r),e.insertBefore(n,e.firstChild)}}},{key:"setVisibility",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e?"remove":"add",r="";t&&(r=navigator.mozL10n.get("store-updating")),this.text.textContent=r,this.element.classList[n]("hidden")}},{key:"focus",value:function(){var e=this;requestAnimationFrame(function(){e.element&&e.element.focus()})}}]),e}();exports.default=i},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(i,o){try{var a=t[i](o),s=a.value}catch(u){return void n(u)}return a.done?void e(s):Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)})}return r("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=t(13),s=n(a),u=t(1),c=t(33),l=n(c);t(80);var f=function(){function e(){var t=this;i(this,e),this.handleToggleRebootPanel=function(e){var n=e.detail,r=n.visible,i=n.isInPaymentProcess,o=n.isUpgradeCAProcess,a=t.element.querySelector(".container");if(!t.isUpgradeCAProcess||r){if(t.isUpgradeCAProcess=o,t.isInPaymentProcess=i,a||t.createPanel(),!t.isUpgradeCAProcess){var s=t.isRebootAPISupported===!1;t.setRebootAPINotSupportMsgVisibility(s)}t.updateSoftKey(),t.setVisible(r)}},this.setRebootAPINotSupportMsgVisibility=function(e){var n=null;if(t.overlayRendered){var r=e?"remove":"add";return n=t.element.querySelector(".overlay"),void n.classList[r]("hidden")}if(e){var i=document.createElement("div");i.className="instruction",i.setAttribute("data-l10n-id","restart-device-tips"),n=document.createElement("div"),n.className="overlay",n.appendChild(i),t.element.appendChild(n),t.overlayRendered=!0}},this.keydownHandler=function(e){switch(e.key){case"BrowserBack":case"Backspace":case"Escape":t.isUpgradeCAProcess||t.setVisible(!1);break;case"SoftRight":t.isUpgradeCAProcess||t.isRebootAPISupported!==!0||(0,u.showRebootDialog)();break;case"SoftLeft":t.isUpgradeCAProcess||t.isRebootAPISupported!==!0||t.setVisible(!1);break;case"Enter":t.isUpgradeCAProcess&&l.default.upgradeCA();default:return}e.preventDefault(),e.stopPropagation()},this.elementId="rebootPanel",this.toggleEvent=this.elementId+":toggle",this.element=document.querySelector("#"+this.elementId),this.visible=!1,this.isRebootAPISupported=null,this.isInPaymentProcess=null,this.isUpgradeCAProcess=null,this.overlayRendered=!1,this.start()}return o(e,[{key:"start",value:function(){function e(){return t.apply(this,arguments)}var t=r(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,u.getIsRebootAPISupported)();case 2:this.isRebootAPISupported=e.sent,this.createListeners();case 4:case"end":return e.stop()}},e,this)}));return e}()},{key:"createListeners",value:function(){window.addEventListener(this.toggleEvent,this.handleToggleRebootPanel),this.element.addEventListener("keydown",this.keydownHandler)}},{key:"createPanel",value:function(){var e=document.createElement("div"),t=document.createElement("div"),n=document.createElement("div"),r=document.createElement("div");t.className="tips-img",n.className="title",n.setAttribute("data-l10n-id","restart-device-title"),r.className="tips h4",r.setAttribute("data-l10n-id","restart-device-content"),e.className="container",e.appendChild(t),e.appendChild(n),e.appendChild(r),this.element.appendChild(e)}},{key:"setVisible",value:function(e){var t=e?"remove":"add";this.visible!==e&&(!e&&this.isInPaymentProcess&&u.utils.showToastMsg("payment-canceled"),this.visible=e,this.element.classList[t]("hidden"),this.onVisibilityChange&&this.onVisibilityChange(e,this.elementId))}},{key:"updateSoftKey",value:function(){this.isUpgradeCAProcess?s.default.register({left:"",center:"restart",right:"",theme:"floating-button-theme"},this.element):s.default.register({left:this.isInPaymentProcess?"":{icon:"cancel"},center:"",right:{icon:"browser-refresh"},theme:"floating-button-theme"},this.element)}}]),e}();exports.default=f=new f},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=t(13),a=n(o);t(81);var s=function(){function e(){var t=this;r(this,e),this.handleChange=function(){var e=a.default.currentKeys;t.softkeys.forEach(function(n){e[n]=t.uniformContent(e[n]||"")}),t.setPanelStyle(e.theme),t.setButtons(e)},this.defaultStyle="skbar none-paddings visible focused",this.softkeys=["left","center","right"]}return i(e,[{key:"render",value:function(){var e=document.querySelector("#root"),t=document.createDocumentFragment(),n=document.createElement("form");n.id="softkeyPanel",n.className="hidden",n.dataset.type="action",this.softkeys.forEach(function(e){var t=document.createElement("div"),r=document.createElement("button");t.className="button-wrapper",r.id="software-keys-"+e,r.className="sk-button",r.dataset.position=e,t.appendChild(r),n.appendChild(t)}),t.appendChild(n),e.appendChild(t),this.element=document.querySelector("#softkeyPanel")}},{key:"start",value:function(){this.render(),a.default.on("change",this.handleChange)}},{key:"setPanelStyle",value:function(e){var t=this.defaultStyle;e&&(t+=" "+e),this.element.classList.contains("hidden")&&(t+=" hidden"),this.element.className=t}},{key:"setButtons",value:function(e){var t=this,n=Array.from(this.element.getElementsByTagName("button"));this.primaryKey=this.getPrimaryKey(e),n.forEach(function(n){var r=n.dataset.position,i=t.primaryKey===r?"add":"remove",o=e[r],a=o||{},s=a.icon,u=a.text;if(n.classList[i]("primary"),o){if(!t.hasContent(o))return void n.classList.add("hidden");u?n.dataset.l10nId=u:n.textContent="",s?n.dataset.icon=s:delete n.dataset.icon,n.classList.remove("hidden")}})}},{key:"hasContent",value:function(e){return e.icon||""!==e.text&&null!==e.text}},{key:"uniformContent",value:function(e){return"string"==typeof e&&(e=e.startsWith("icon=")?{icon:e.replace("icon=","")}:e.startsWith("style=")?{style:JSON.parse(e.replace("style=",""))}:{text:e}),e}},{key:"getPrimaryKey",value:function(e){return["center","right","left"].find(function(t){var n=e[t];return n&&(n.text||n.icon)})||null}}]),e}();exports.default=s=new s},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=t(13),a=n(o);t(82);var s=function(){function e(){var t=this;r(this,e),this.handleTogglePanel=function(e){var n=e.detail.visible;t.element.querySelector(".container")||t.createPanel(),t.setVisible(n),n&&a.default.register({left:"",center:"ok",right:"",theme:"floating-button-theme"},t.element)},this.keydownHandler=function(e){switch(e.key){case"Enter":t.selfUpdate(!1),t.setVisible(!1);break;default:return}},this.elementId="updatePanel",this.toggleEvent=this.elementId+":toggle",this.element=document.querySelector("#"+this.elementId),this.visible=!1,this.start()}return i(e,[{key:"start",value:function(){window.addEventListener(this.toggleEvent,this.handleTogglePanel),this.element.addEventListener("keydown",this.keydownHandler)}},{key:"createPanel",value:function(){var e=document.createElement("div"),t=document.createElement("div"),n=document.createElement("div"),r=document.createElement("div");t.className="tips-img",n.className="title",n.setAttribute("data-l10n-id","store-update-title"),r.className="tips h4",r.setAttribute("data-l10n-id","store-update-content"),e.className="container",e.appendChild(t),e.appendChild(n),e.appendChild(r),this.element.appendChild(e)}},{key:"setVisible",value:function(e){var t=e?"remove":"add";this.visible!==e&&(this.visible=e,this.element.classList[t]("hidden"),this.onVisibilityChange&&this.onVisibilityChange(e,this.elementId))}}]),e}();exports.default=s=new s},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(u){i=!0,o=u}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=t(8),l=n(c),f=function(){function e(t){var n=t.deviceInfos,r=t.simInfo,i=t.IMEI,a=void 0===i?"0123456789":i,s=t.serverTimeOffset;o(this,e),this._deviceIMEI=a,this._deviceInfos=n,this._simInfo=r,this._requester=l.default.getRequester({serverTimeOffset:s,deviceInfos:n}),this._apiName={general:"apps"},this._apiURI=n.get("apps.serviceCenterUrl")}return u(e,[{key:"_isBookmarkSupported",value:function(){var e=this._apiURI.split("/"),t=e[3];return t&&t.indexOf("v3.0")>=0}},{key:"_getAppListParams",value:function(){var e=this._isBookmarkSupported(),t=this._deviceInfos.get("ril.data.defaultServiceId"),n={bookmark:e,defaultServiceId:t,imei:this._deviceIMEI},o=[].concat(i(this._deviceInfos)).filter(function(e){return s(e,1)[0].includes("deviceinfo")}).reduce(function(e,t){var n=s(t,2),i=n[0],o=n[1];return a({},e,r({},i.split(".").pop(),o.replace(/ /g,"_")))},{});return a({},n,this._simInfo,o)}},{key:"fetch",value:function(){var e=this;return new Promise(function(t,n){var r=e._getAppListParams();e._requester.send({url:l.default.generateURL({apiName:e._apiName.general,deviceInfos:e._deviceInfos,params:r}),method:"GET"}).then(function(e){t(JSON.parse(e))},function(e){n(e)})})}}]),e}();exports.default=f},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(u){i=!0,o=u}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=t(8),u=n(s),c=function(){function e(){r(this,e),this.apiName="categories"}return a(e,[{key:"init",value:function(e){var t=e.deviceInfo,n=e.imei,r=e.commsInfo,i=e.serverTimeOffset;this.deviceInfo=t,this.imei=n,this.commsInfo=r,this.serverTimeOffset=i}},{key:"_getDeviceInfo",value:function(e){var t=this;return e.map(function(e){var n=t.deviceInfo.get(e);return t.deviceInfo.has(e)||console.error("ArgumentError: Expected deviceInfo Map to have keys ["+e+"]"),n})}},{key:"getCategories",value:function(){var e=this,t=this._getDeviceInfo(["deviceinfo.cu","ril.data.defaultServiceId"]),n=o(t,2),r=n[0],a=n[1],s=i({cu:r,defaultServiceId:a,imei:this.imei},this.commsInfo);return new Promise(function(t){u.default.getRequester({serverTimeOffset:e.serverTimeOffset,deviceInfos:e.deviceInfo}).send({url:u.default.generateURL({apiName:e.apiName,params:s,deviceInfos:e.deviceInfo}),method:"GET"}).then(function(e){t(JSON.parse(e))},function(e){console.error("categories: "+e.statusText),t([])})})}}]),e}();exports.default=new c},function(e,exports){"use strict";function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var n=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),r=function(){function e(n,r){var i=this;t(this,e),this._getCurrentSetting=function(e){return new Promise(function(t){var n=navigator.mozSettings.createLock().get(e);n.onsuccess=function(){"undefined"==typeof n.result[e]?t():"string"==typeof n.result[e]?t(JSON.parse(n.result[e])):Array.isArray(n.result[e])&&t(n.result[e])}})},this._getShowFolderMapping=function(e){for(var t={},n=0;n<e.length;n++){var r=e[n];"show-folder"===r.type&&(t[r.params.folder.name]=n)}return t},this._getAppsByCategory=function(e){for(var t=[],n=0;n<i.apps.length;n++){var r=i.apps[n];r.category===e&&t.push({name:r.name,manifestURL:r.manifest_url})}return t},this._same=function(e,t){return JSON.stringify(e)===JSON.stringify(t)},this._setMozSettings=function(e,t){var n=navigator.mozSettings.createLock(),r={};r[e]=t,n.set(r)},this.categories=n,this.apps=r,this.carrierCategoryNames=[]}return n(e,[{key:"init",value:function(){var e=this;return fetch("assets/carrier_name").then(function(e){return e.text()}).then(function(t){e.carrierCategoryNames=JSON.parse(t)}).catch(function(){e.carrierCategoryNames=[]})}},{key:"replaceShowFolderSetting",value:function(){var e=this;this._getCurrentSetting("home.customization.rules").then(function(t){if(t){var n=JSON.parse(JSON.stringify(t)),r=e._getShowFolderMapping(t);if(0!==Object.keys(r).length){var i=e._carrierCategories;if(!(i.length<1)){for(var o=0;o<i.length;o++){var a=i[o];if(a.name in r){var s=e._getAppsByCategory(a.code);e._same(t[r[a.name]].params.folder.items,s)||(t[r[a.name]].params.folder.items=s)}}e._same(n,t)||e._setMozSettings("home.customization.rules",JSON.stringify(t))}}}})}},{key:"_carrierCategories",get:function(){for(var e=[],t=0;t<this.categories.length;t++){var n=this.categories[t];this.carrierCategoryNames.indexOf(n.name)!==-1&&e.push({code:n.code,name:n.name})}return e}}]),e}();exports.default=r},function(e,exports,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=t(1),o=-5,a=1,s=1,u=-9,c=function(){function e(){var t=this;n(this,e),this.fotaCheckDone=function(){t.emit("fota-done")},this.checkFota=function(){t._fota.check()},this._fota=navigator.fota,this.ready=!1,this.handlerDidMount=!1}return r(e,[{key:"start",value:function(){var e=this;this._fota.addEventListener("check_complete",this),this._fota.addEventListener("start_complete",this),this.handlerDidMount||(this.on("fota-ready",this.checkFota),this.on("fota-failed",this.fotaCheckDone),this.on("fota-notfound",this.fotaCheckDone),this.on("fota-found",function(){e.stop(),e.emit("fota-dialog")}),this.on("fota-done",function(){performance.mark("CHECK_FOTA_END"),i.utils.performanceLogs()}),this.handlerDidMount=!0),o===this._fota.start()&&(this.ready=!0,this.emit("fota-ready"))}},{key:"handleEvent",value:function(e){switch(e.type){case"start_complete":this.handleStarted(e);break;case"check_complete":this.handleCheckComplete(e)}}},{key:"handleStarted",value:function(e){a===e.result?(this.ready=!0,this.emit("fota-ready")):(this.ready=!1,this.emit("fota-failed"),console.error("fota is not ready!"))}},{key:"handleCheckComplete",value:function(e){var t=e.result;u===t?this.emit("fota-notfound"):s===t?this.emit("fota-found"):console.error("fota engine check failed")}},{key:"stop",value:function(){this._fota.stop(),this._fota.removeEventListener("check_complete",this),this._fota.removeEventListener("start_complete",this)}},{key:"emit",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this._ensureValidEventName(e),this.listeners||(this.listeners=new Map);var i=this.listeners.get(e);i&&i.forEach(function(e){try{e.apply(null,n)}catch(t){console.error(t)}})}},{key:"on",value:function(e,t){this._ensureValidEventName(e),this._ensureValidHandler(t),this.listeners||(this.listeners=new Map);var n=this.listeners.get(e);n||(n=new Set,this.listeners.set(e,n)),n.add(t)}},{key:"_ensureValidEventName",value:function(e){if(!e||"string"!=typeof e)throw new Error("Event name should be a valid non-empty string!")}},{key:"_ensureValidHandler",value:function(e){if("function"!=typeof e)throw new Error("Handler should be a function!")}}]),e}(),l=new c;exports.default=l},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}Object.defineProperty(exports,"__esModule",{value:!0});var a=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(u){i=!0,o=u}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=t(29),c=t(23),l=t(9),f=t(15),d=t(3),p=t(42),h=t(12),v=n(h),m=t(8),g=n(m),y=t(1),b=t(16),w=n(b),_=t(18),S=n(_),E=t(20),k=n(E),A=t(7),C=n(A),T=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=new u.SimpleResult({id:e,success:n,detail:r});(0,l.postMessageResponse)(i,t)},O=function(){l.MessageSender.remoteReady=!0,l.MessageSender.postFullQueue()},I=function(){for(var e,t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];(e=console).warn.apply(e,["[KaiOS-Store]"].concat(n))},P=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=new CustomEvent(e,{detail:t});window.dispatchEvent(n)},R=function(e){return s({filename:e.filename,lineNumber:e.lineNumber,message:e.message,name:e.name,stack:e.stack,result:e.result,columnNumber:e.columnNumber,data:e.data},o(e,["filename","lineNumber","message","name","stack","result","columnNumber","data"]))},M=function(e){var t=e.detail,n=t.id,u=t.action,h=t.detail,m=t.source;switch(l.MessageSender.target=m.window,u){case p.commandList.INSTALL_APP:var b=h.manifestURL,_=o(h,["manifestURL"]);w.default.installAppByManifestURL(b,_).then(function(){T(n,m)}).catch(function(e){T(n,m,!1,{error:e})});break;case p.commandList.SHOW_NOTIFICATION:var E=h.title,A=h.options;A.mozbehavior||(A.mozbehavior={showOnlyOnce:!0}),new Notification(E,A);break;case p.commandList.REQUEST_DEVICE_INFO:O(),y.utils.getAllDeviceInfo().then(function(e){T(n,m,!0,new c.DeviceInfo(e))});break;case p.commandList.REQUEST_TOKEN:var M=h.refresh;S.default.ready(function(){S.default.getToken(M).then(function(e){T(n,m,!0,{type:e.type})}).catch(function(e){T(n,m,!1,{error:e})})});break;case p.commandList.REQUEST_PAYMENT_PROFILE:v.default.request("profile").then(function(e){T(n,m,!0,new c.PaymentProfile({price:e.price,currency:e.currency}))},function(e){T(n,m,!1,{error:R(e)})});break;case p.commandList.REQUEST_INSTALLED_APPS:w.default.getInstalledApps().then(function(e){T(n,m,!0,[].concat(i(e.entries())).reduce(function(e,t){var n=a(t,2),r=n[0],i=n[1];return e[r]=y.utils.mozAppToObject(i),e},{}))});break;case p.commandList.PIN_BOOKMARK:var L=h.name,U=h.icon,N=h.url;window.BookmarksDatabase.add({url:N,icon:U,name:L}).then(function(){T(n,m)},function(){T(n,m,!1)});break;case p.commandList.REQUEST_BOOKMARKS:window.BookmarksDatabase.getAll().then(function(e){T(n,m,!0,(0,f.simpleObject)(e))},function(){T(n,m,!1)});break;case p.commandList.UNPIN_BOOKMARK:var D=h.url;window.BookmarksDatabase.remove(D);break;case p.commandList.UNINSTALL_APP:var x=h.manifestURL;w.default.uninstallAppByManifestURL(x);break;case p.commandList.SHOW_TOAST:if(v.default.isKaiPayRunning)break;var j=h.messageL10nId,B=h.messageL10nArgs;y.utils.showToastMsg(j,B);break;case p.commandList.CANCEL_DOWNLOAD:var F=h.manifestURL;w.default.cancelDownload(F);break;case p.commandList.LAUNCH_APP:var z=h.manifestURL;w.default.launchAppByManifestURL(z);break;case p.commandList.UPDATE_APP:var H=h.manifestURL,K=k.default.hideLoading,q=k.default.toggleUpdatePanel,V=!0;H===C.default.storeManifestURL?(K(),q()):V=w.default.handleUpdate(H),T(n,m,V);break;case p.commandList.CHECK_APP_UPDATE:var G=h.manifestURL,Y=h.autoDownload;w.default.checkUpdate(G,Y),T(n,m);break;case p.commandList.REQUEST_EXIT:P("remote:requestExit");break;case p.commandList.REQUEST_PAYMENT:var W=h.name,Q=h.id;v.default.request("payment",{detail:{id:Q,name:W}}).then(function(e){T(n,m,!0,{receipt:e})},function(e){T(n,m,!1,{error:R(e)})});break;case p.commandList.GET_ACCOUNT_VERSION:S.default.getAccountVersion().then(function(e){T(n,m,!0,{version:e})});break;case p.commandList.OPEN_ACCOUNT:var J=h.section;S.default.openAccount(J,function(){T(n,m)},function(){T(n,m,!1)});break;case p.commandList.LAUNCH_ACTIVITY:var X=h.name,Z=h.data,ee=h.fieldsTransformToBlobs,te=s({},Z);ee&&ee.forEach(function(e){te[e]=[y.utils.stringToBlob(te[e])]});var ne=new MozActivity({name:X,data:te});ne.onsuccess=function(e){return T(n,m,!0,e.target.result)},ne.onerror=function(e){return T(n,m,!1,e.target.error)};break;case p.commandList.REQUEST_HAS_FEATURE:var re=h.key;Object.values(d.validFeature).includes(re)?navigator.hasFeature(re).then(function(e){T(n,m,!0,{value:e})}).catch(function(e){T(n,m,!1,{error:e})}):T(n,m,!1,{error:"Unsupported feature key: "+re});break;case p.commandList.REQUEST_SETTING:var ie=h.key;Object.values(d.validSettingKey).includes(ie)?navigator.mozSettings.createLock().get(ie).then(function(e){var t=e[ie];void 0!==t?T(n,m,!0,{value:t}):T(n,m,!1)}).catch(function(e){T(n,m,!1,{error:e})}):T(n,m,!1,{error:"unpermitted setting key"});break;case p.commandList.UPDATE_SETTING:var oe=h.key,ae=h.value,se=Object.values(d.validSettingKey).includes(oe),ue=d.validSettingData[oe].values.includes(ae);se&&ue?navigator.mozSettings.createLock().set(r({},oe,ae)):T(n,m,!1,{error:"unpermitted setting value"});break;case p.commandList.CHANGE_THEME_COLOR:var ce=h.content;document.getElementById("theme-color").setAttribute("content",ce);break;case p.commandList.CHECK_REBOOT:w.default.rebootNeeded&&(0,y.sendIACMessageToSystem)({reboot:!0});break;case p.commandList.REMOTE_UI_IS_READY:I('Received postMessage "REMOTE_IS_READY".'),k.default.hideLoading().then(function(){if(I("Loading page has been hidden."),T(n,m),h){var e=h.timestamp,t=h.isInlineActivity;y.utils.remoteCompleteTime=e,P("remote:firstViewCompleted",{isInlineActivity:t}),t&&y.utils.performanceLogs()}});break;case p.commandList.CHECK_IF_STORAGE_ENOUGH:var le=h.section;le!==d.validStorageSections.UPDATE&&le!==d.validStorageSections.INSTALL||w.default.checkSpace(le).then(function(e){T(n,m,e)}).catch(function(e){T(n,m,!1,{error:e})});break;case p.commandList.SYNC_LOADING_PROGRESS:var fe=h.percentage;w.default.resetProgressTimer(),y.utils.updateLoadingProgress(fe);break;case p.commandList.SET_ITEM_TO_CACHE:var de=h.key,pe=h.item;asyncStorage.setItem(de,pe);break;case p.commandList.GET_ITEM_FROM_CACHE:var he=h.key;"true"===localStorage.forceRefetch?T(n,m,!0,{}):asyncStorage.getItem(he,function(e){T(n,m,!0,e)});break;case p.commandList.SEND_HTTP_REQUEST:var ve=h.url,me=h.method,ge=h.useDeviceInfo,ye=h.params,be=h.appendAccountInfo,we=g.default.getRequester({serverTimeOffset:window.serverTimeOffset,setDeviceInfo:ge,deviceInfos:window.deviceInfos});be&&S.default.accountId&&(ye.account_id=S.default.accountId),we.send({url:ve,method:me,params:ye}).then(function(e){T(n,m,!0,{response:e})},function(e){T(n,m,!1,{error:R(e)})});break;case p.commandList.REQUEST_DEFAULT_PAYMENT_METHOD:v.default.request("default-payment-method").then(function(e){T(n,m,!0,e)}).catch(function(e){T(n,m,!1,{error:R(e)})});break;default:T(n,m,!1,{error:u+" not found"}),console.error("[Message Receiver] "+u+" not found")}};exports.default=M},function(e,exports){"use strict";function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var n=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),r=function(){function e(){t(this,e)}return n(e,[{key:"releaseUnusedInfo",value:function(e){var t=e.manifest||e.updateManifest,n=t.locales;if(delete t.description,n)for(var r in n)({}).hasOwnProperty.call(n,r)&&delete n[r].description}}]),e}(),i=new r;exports.default=i},function(e,exports){"use strict";function t(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var r=function e(){n(this,e),this.getSetting=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new Promise(function(i,o){var a=window.navigator.mozSettings.createLock(),s=a.get(e);s.onsuccess=function(){var o=s.result[e];void 0!==o&&null!==o||null===n||(o=n),i(r?t({},e,o):o)},s.onerror=function(){o()},a.forceClose&&a.forceClose()})}};exports.default=r=new r},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=t(67),s=n(a),u=t(66),c=n(u),l=t(8),f=n(l),d=t(68),p=n(d),h=t(7),v=n(h),m=t(1),g=function(){function e(){var t=this;i(this,e),this._completedEventHandler=function(e){var n=e.detail;console.warn("[store-silent-install] Event: "+t.eventName+", data: "+JSON.stringify(n)),n.success?t._changeSettingsAndExit(n):(t.activityRequest.postError(n.reason),console.error("[store-silent-install] postError and close window."),window.close())},this.settingsKey="store.silentInstall.success",this.eventName="silent-install-completed",this.dataStoreName="silent-apps",this.dataStore=null,this.appListHelper=null,this.activityRequest=null,this.allApps=null,this.silentApps=null,this.categories=null,this.installedApps=null}return o(e,[{key:"start",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return performance.mark(this.eventName),"undefined"!=typeof n&&null!==n&&(this.installedApps=n),navigator.getDataStores(this.dataStoreName).then(function(t){e.dataStore=t[0],e.dataStore.clear()}),t&&this._setMessageHandler(),this._setupParams().then(function(){return Promise.all([s.default.getCategories(),e._getAppList()]).then(function(n){var r=[];return e.categories=n[0],e.silentApps=n[1],e._updateCustomizationRule(e.categories,e.allApps),e.silentApps.forEach(function(t){var n=!1;e.installedApps&&(n=e.installedApps.includes(t.manifest_url)),n||r.push(e._install(t))}),Promise.all(r).then(function(){return performance.measure("activeTime",e.eventName),e._broadcast({success:!0,target:"allCompleted in "+performance.getEntriesByType("measure")[0].duration+" ms"}),t||e._setSilentInstallSuccessSettings(!0),!0})}).catch(function(t){return console.warn("[store-silent-install] Failed at KaistoreCategoriesHelper.getCategories() or _getAppList()"),e._broadcast({success:!1,target:t,reason:"Failed at KaistoreCategoriesHelper.getCategories() or _getAppList()"}),!1})},function(t){return console.warn("[store-silent-install] Failed at _setupParams()"),e._broadcast({success:!1,target:t,reason:"Failed at _setupParams()"}),!1})}},{key:"_setMessageHandler",value:function(){var e=this;navigator.mozSetMessageHandler("activity",function(t){var n=t.source;e.activityRequest=t,n.data&&n.data.installed&&(e.installedApps=n.data.installed),window.addEventListener(e.eventName,e._completedEventHandler,!0)})}},{key:"_changeSettingsAndExit",value:function(e){var t=this,n=e.success;this._setSilentInstallSuccessSettings(n).then(function(){t.activityRequest.postResult(e),console.warn("[store-silent-install] _changeSettingsAndExit: postResult and close window."),window.close()})}},{key:"_setSilentInstallSuccessSettings",value:function(e){return navigator.mozSettings.createLock().set(r({},""+this.settingsKey,e))}},{key:"_getAppList",value:function(){var e=this;return new Promise(function(t,n){e.appListHelper=new c.default({deviceInfos:window.deviceInfos,simInfo:m.utils.getCommsInfo(),IMEI:window.IMEI,serverTimeOffset:window.serverTimeOffset}),e.appListHelper.fetch().then(function(n){var r=n.apps;e.allApps=n.apps,r=r.filter(function(e){return e.silent===!0&&e.paid===!1}),t(r)},function(e){return n(e)})})}},{key:"_install",value:function(e){var t=this;return new Promise(function(n){var r=null;t.dataStore.add(e).then(function(){r="hosted"===e.type?navigator.mozApps.install(e.manifest_url):navigator.mozApps.installPackage(e.manifest_url),r.onsuccess=function(){return n()},r.onerror=function(){return n()}})})}},{key:"_updateCustomizationRule",value:function(e,t){var n=new p.default(e,t);n.init().then(function(){n.replaceShowFolderSetting()})}},{key:"_setupParams",value:function(){var e=this;return new Promise(function(t,n){Promise.all([e._getRestrictedToken(),e._getDeviceInfos(),e._getIMEI()]).then(function(e){s.default.init({deviceInfo:window.deviceInfos,imei:window.IMEI,commsInfo:m.utils.getCommsInfo(),serverTimeOffset:window.serverTimeOffset}),t(e)}).catch(function(e){n(e)})})}},{key:"_getRestrictedToken",value:function(){return new Promise(function(e,t){navigator.kaiAuth.getRestrictedToken("apps").then(function(t){f.default.setToken(t.kid,t.macKey),e(t)}).catch(function(e){console.error("[store-silent-install] get restricted token failed. "+e),t("Get restricted token failed")})})}},{key:"_getDeviceInfos",value:function(){return new Promise(function(e,t){v.default.getDeviceInfos().then(function(t){window.deviceInfos=t,e(t)}).catch(function(e){console.error("[store-silent-install] get deviceInfos failed. "+e),t("Get deviceInfos failed")})})}},{key:"_getIMEI",value:function(){return navigator.mozMobileConnections[0].getDeviceIdentities().then(function(e){return window.IMEI=e.imei}).catch(function(e){console.error("[store-silent-install] get IMEI failed. "+e)})}},{key:"_broadcast",value:function(e){var t=new CustomEvent(this.eventName,{detail:e});window.dispatchEvent(t)}}]),e}();exports.default=g},function(e,exports){"use strict";var t=console.error;console.error=function(){Array.prototype.unshift.call(arguments,"[KaiOS-Store]"),t.apply(console,arguments)}},function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var o=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(u){i=!0,o=u}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=t(28),u=n(s),c=t(19),l=n(c),f=t(73),d=n(f),p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=[];n[0]=0,n[1]=1;for(var r=2;r<e;r++)n[r]=n[r-1]+n[r-2];return n.slice(t)},h=function(){function e(){var t=this;i(this,e),this.start=function(){u.default.get(t.silentInstallSuccessKey).then(function(e){return e?void t.disabled():void u.default.get(t.SBCCompletedKey).then(function(e){e?t.activate():u.default.addObserver(t.SBCCompletedKey,t.onSBCCompletedChanged)})})},this.onSBCCompletedChanged=function(e){"undefined"!=typeof e&&e&&(u.default.removeObserver(t.SBCCompletedKey,t.onSBCCompletedChanged),t.activate())},this.activate=function(){if(t.installed)t.disabled();else{if(!navigator.mozPower.screenEnabled)return void t.retry();if(!l.default.online)return void t.retry();t.installing?console.warn("[store-silent-install] installing, skip this one."):(t.installStatus="installing",t.getInstalledApps().then(function(){(new d.default).start(!1,t.installedSilentApps).then(function(e){e?t.disabled():(t.silentInstallRetryCount<t.MAX_SILENT_RETRY-3&&t.silentInstallRetryCount++,t.installStatus="error",t.retry())})}))}},this.retry=function(){var e=t.silentInstallRetryCount,n=60*t.retryInterval[e]*1e3;clearTimeout(t.silentInstallTimer),t.silentInstallTimer=setTimeout(function(){t.activate()},n)},this.disabled=function(){t.silentInstallRetryCount=0,t.installStatus="installed",navigator.mozSettings.createLock().set(r({},""+t.SBCCompletedKey,!1))},this.getAllFromDS=function(e){return new Promise(function(t,n){var r={},i=e.sync(),o=function e(o){var a=o.id;switch(o.operation){case"update":case"add":r[a]=o.data;break;case"remove":delete r[a];break;case"clear":r={};break;case"done":return void t(r)}i.next().then(e,n)};i.next().then(o,n)})},this.getInstalledAppsDS=function(){return t.installedAppsDS?Promise.resolve(t.installedAppsDS):navigator.getDataStores(t.installedStorageKey).then(function(e){var n=o(e,1);return t.installedAppsDS=n[0],e[0]})},this.getInstalledApps=function(){return t.getInstalledAppsDS().then(function(e){return t.getAllFromDS(e)}).then(function(e){e?t.installedSilentApps=Object.values(e):t.installedSilentApps=[]})},this.MAX_SILENT_RETRY=10,this.silentInstallSuccessKey="store.silentInstall.success",this.SBCCompletedKey="sim.base.customization.completed",this.installedStorageKey="installed-silent-apps",this.installStatus="unknown",this.installedAppsDS=null,this.installedSilentApps=[],this.retryInterval=p(this.MAX_SILENT_RETRY,2),this.silentInstallRetryCount=0,this.silentInstallTimer=null}return a(e,[{key:"installed",get:function(){return"installed"===this.installStatus}},{key:"installing",get:function(){return"installing"===this.installStatus}}]),e}(),v=new h;exports.default=v},function(e,exports){"use strict";function t(e){for(var t="=".repeat((4-e.length%4)%4),n=(e+t).replace(/\-/g,"+").replace(/_/g,"/"),r=self.atob(n),i=new Uint8Array(r.length),o=0;o<r.length;++o)i[o]=r.charCodeAt(o);return i}function n(e,t,n){return t=t||0,n=n||e.byteLength,self.btoa(String.fromCharCode.apply(null,e.subarray(t,n))).replace(/\=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.base64UrlToUint8Array=t,exports.uint8ArrayToBase64Url=n},function(e,exports){},77,77,77,77,77,77,77,77,77]));